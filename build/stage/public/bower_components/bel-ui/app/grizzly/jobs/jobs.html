<script type="text/ng-template" id="jobrow.html">
    <div class="cell tenth alert-cell">
        <div class="resource-icon icon job-status-{{ resource.status.toLowerCase() }}"></div>
    </div>
    <div class="cell quarter control-cell" title="{{ resource.title.text }}">
        <h2>
            <a class="include-icon jobs" ng-href="#/jobs/{{ resource.jobId }}">{{ resource.title.text }}</a>
        </h2>
    </div>
    <div class="cell quarter" title="{{ resource.user }}">
        <p>{{ resource.user }}</p>
    </div>
    <div class="cell fifth" title="{{ resource.startDate | date : 'MMM d, y h:mm:ss a' }}">
        <p>{{ resource.startDate | date : "MMM d, y h:mm:ss a" }}</p>
    </div>
    <div class="cell fifth" title="{{ resource.endDate | date : 'MMM d, y h:mm:ss a' }}">
        <p>{{ resource.endDate | date : "MMM d, y h:mm:ss a" }}</p>
    </div>
</script>

<script type="text/ng-template" id="jobsummarytemplate.html">
  <div class="row summary-container-landing">
    <job-data-vis minified="true" />
  </div>
</script>

<script type="text/ng-template" id="jobsearchtemplate.html">
  <div class="control-group">
    <h3 title="Status">Status</h3>
    <div id="statusButtonGroup" class="btn-group checkbox-btn-array" data-toggle="buttons">
      <label class="flex-btn btn icon icon-checkmark-fill" title="Success" ng-click="inventory.query('status', 'SUCCESS')" onclick="$('#statusButtonGroup').find('label').not('.icon-checkmark-fill').removeClass('active')">
        <input type="checkbox">
      </label>
      <label class="flex-btn btn icon icon-warning" title="Success with Errors" ng-click="inventory.query('status', 'SUCCESS_WITH_ERRORS')" onclick="$('#statusButtonGroup').find('label').not('.icon-warning').removeClass('active')">
        <input type="checkbox">
      </label>
      <label class="flex-btn btn icon icon-in-progress" title="In Progress" ng-click="inventory.query('status', 'IN_PROGRESS')" onclick="$('#statusButtonGroup').find('label').not('.icon-in-progress').removeClass('active')">
        <input type="checkbox">
      </label>
      <label class="flex-btn btn icon icon-danger" title="Failed" ng-click="inventory.query('status', 'FAILED')" onclick="$('#statusButtonGroup').find('label').not('.icon-danger').removeClass('active')">
        <input type="checkbox">
      </label>
    </div>
  </div>

  <div class="control-group">
    <div class="checkbox btn-group-justified btn-group-toggle" data-toggle="buttons" ng-click="inventory.query('isSystem', 'false')">
      <label class="btn btn-primary">
        <input type="checkbox" checked="checked">
        System Jobs
      </label>
    </div>
  </div>

  <div class="control-group">
    <div class="checkbox btn-group-justified btn-group-toggle" data-toggle="buttons"
         ng-click="startTimeFilter = startTimeFilter === undefined ? true : !startTimeFilter">
      <label title="Start Time" class="btn btn-default">
        <input type="checkbox" checked="checked">
        Start Time
      </label>
    </div>

    <div class="dropdown" ng-if="startTimeFilter">
      <div class="dropdown-toggle" id="startDateFromCalendar" role="button" data-toggle="dropdown" data-target="#" href="#">
        <div class="input-group">
          <input type="text" class="form-control" data-ng-model="queryService.queryMap['startDate']['from']">
          <span class="input-group-addon">
            <i class="glyphicon glyphicon-calendar"></i>
          </span>
        </div>
      </div>
      <ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">
        <datetimepicker data-ng-model="queryService.queryMap['startDate']['from']" data-datetimepicker-config="{ dropdownSelector: '#startDateFromCalendar' }"/>
      </ul>
    </div>

    <div class="dropdown" ng-if="startTimeFilter">
      <div class="dropdown-toggle" id="startDateToCalendar" role="button" data-toggle="dropdown" data-target="#" href="#">
        <div class="input-group">
          <input type="text" class="form-control" data-ng-model="queryService.queryMap['startDate']['to']">
          <span class="input-group-addon">
            <i class="glyphicon glyphicon-calendar"></i>
          </span>
        </div>
      </div>
      <ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">
        <datetimepicker data-ng-model="queryService.queryMap['startDate']['to']" data-datetimepicker-config="{ dropdownSelector: '#startDateToCalendar' }"/>
      </ul>
    </div>
  </div>

  <div class="control-group">
    <div class="checkbox btn-group-justified btn-group-toggle" data-toggle="buttons"
         ng-click="endTimeFilter = endTimeFilter === undefined ? true : !endTimeFilter">
      <label title="End Time" class="btn btn-default">
        <input type="checkbox" checked="checked">
        End Time
      </label>
    </div>

    <div class="dropdown" ng-if="endTimeFilter">
      <div class="dropdown-toggle" id="endDateFromCalendar" role="button" data-toggle="dropdown" data-target="#" href="#">
        <div class="input-group">
          <input type="text" class="form-control" data-ng-model="queryService.queryMap['endDate']['from']">
          <span class="input-group-addon">
            <i class="glyphicon glyphicon-calendar"></i>
          </span>
        </div>
      </div>
      <ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">
        <datetimepicker data-ng-model="queryService.queryMap['endDate']['from']" data-datetimepicker-config="{ dropdownSelector: '#endDateFromCalendar' }"/>
      </ul>
    </div>

    <div class="dropdown" ng-if="endTimeFilter">
      <div class="dropdown-toggle" id="endDateToCalendar" role="button" data-toggle="dropdown" data-target="#" href="#">
        <div class="input-group">
          <input type="text" class="form-control" data-ng-model="queryService.queryMap['endDate']['to']">
          <span class="input-group-addon">
            <i class="glyphicon glyphicon-calendar"></i>
          </span>
        </div>
      </div>
      <ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">
        <datetimepicker data-ng-model="queryService.queryMap['endDate']['to']" data-datetimepicker-config="{ dropdownSelector: '#endDateToCalendar' }"/>
      </ul>
    </div>
  </div>

</script>

<common-page-header></common-page-header>

<server-side-inventory-view page-title="{{ 'jobs-page-title' | translate }}"
                            initial-result="model.initialResult"
                            resource-id-property="jobId"
                            only-list="true"
                            multi-select="false"
                            summary-template-id="jobsummarytemplate.html"
                            list-header-columns="model.listHeaderColumns"
                            list-row-template-id="jobrow.html"
                            get-resources-function="model.getResourcesFunction(result)"
                            sort-filter-resources-function="model.sortAndFilterResourcesFunction()"
                            text-search-query-function="model.textSearchQueryFunction(queryObject)"
                            load-more-function="model.loadMoreFunction(token)"
                            search-template-id="jobsearchtemplate.html"
                            notification-function="model.notificationFunction()"
                            autocomplete-function="model.autocompleteFunction($query)">
</server-side-inventory-view>
