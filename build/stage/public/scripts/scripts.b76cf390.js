"use strict";angular.module("rainierApp",["ngResource","ngRoute","bel-services","restangular","ui.bootstrap","pascalprecht.translate","infinite-scroll","angularFileUpload","helpuiModule","helpuiContentModule","mgcrea.ngStrap.tooltip","mgcrea.ngStrap.popover","mgcrea.ngStrap.timepicker","grizzly","config"]).config(["$routeProvider","$httpProvider","$locationProvider","$translateProvider","$logProvider","RestangularProvider","authServiceProvider","$compileProvider","ENV",function(a,b,c,d,e,f,g,h,i){e.debugEnabled(i.debug),h.aHrefSanitizationWhitelist(/^\s*(https?|blob):/),d.useStaticFilesLoader({prefix:"/i18n/",suffix:".json"}),d.preferredLanguage("en-US"),f.setBaseUrl("/v1"),f.setDefaultHttpFields({timeout:3e4}),g.tokenBaseUrl("/v1"),g.tokenResource("security/tokens"),g.loginRedirect("/login"),g.usernameExtractor(function(a){return a.token.user.name.split("@")[0]}),a.when("/",{templateUrl:"views/dashboard.html",controller:"DashboardCtrl",breadcrumbOptions:{labelKey:"common-dashboard"},helpContext:"R_DASHBOARD"}).when("/hosts",{templateUrl:"views/hosts.html",controller:"HostsCtrl",breadcrumbOptions:{labelKey:"common-hosts"},helpContext:"R_HOSTS_INVENTORY"}).when("/hosts/add",{templateUrl:"views/host-add.html",controller:"HostAddCtrl",breadcrumbOptions:{labelKey:"common-host-add"},helpContext:"T_ADD_HOSTS"}).when("/hosts/create-and-attach-volumes",{templateUrl:"views/create-and-attach-volumes.html",controller:"CreateAndAttachVolumesCtrl",breadcrumbOptions:{labelKey:"host-create-attach-volumes"},helpContext:"C_CREATE_ATTACH"}).when("/hosts/attach-volumes",{templateUrl:"views/attach-volume.html",controller:"AttachVolumesCtrl",breadcrumbOptions:{labelKey:"storage-volume-attach"},helpContext:"T_ATTACH_VOLUME"}).when("/hosts/:hostId",{templateUrl:"views/host.html",controller:"HostCtrl",helpContext:"R_SERVER_DETAILS"}).when("/hosts/:hostId/update",{templateUrl:"views/host-update.html",controller:"HostUpdateCtrl",breadcrumbOptions:{labelKey:"common-host-update"},helpContext:"T_UPDATE_HOST"}).when("/data-protection-monitoring",{templateUrl:"views/data-protection-monitoring.html",controller:"DataProtectionMonitoringCtrl",breadcrumbOptions:{labelKey:"common-data-protection-monitoring"},helpContext:"T_MONITORING_DATA_PROTECTION"}).when("/storage-systems/:storageSystemId/data-protection-monitoring",{templateUrl:"views/data-protection-monitoring.html",controller:"DataProtectionMonitoringCtrl",breadcrumbOptions:{labelKey:"common-data-protection-monitoring"},helpContext:"T_MONITORING_DATA_PROTECTION"}).when("/storage-systems/:storageSystemId/data-protection-monitoring/unprotect",{templateUrl:"views/unprotect-volumes.html",controller:"UnprotectVolumesCtrl",breadcrumbOptions:{labelKey:"unprotect-volume"},helpContext:"T_UNPROTECT_VOLUMES"}).when("/data-protection-monitoring/unprotect",{templateUrl:"views/unprotect-volumes.html",controller:"UnprotectVolumesCtrl",breadcrumbOptions:{labelKey:"unprotect-volume"},helpContext:"T_UNPROTECT_VOLUMES"}).when("/hosts/:hostId/unprotect",{templateUrl:"views/unprotect-volumes.html",controller:"UnprotectVolumesCtrl",breadcrumbOptions:{labelKey:"unprotect-volume"},helpContext:"T_UNPROTECT_VOLUMES"}).when("/storage-systems/:storageSystemId/volumes/volume-actions-restore-selection",{templateUrl:"views/volume-actions-restore-selection.html",controller:"volumeActionsRestoreSelectionCtrl",breadcrumbOptions:{labelKey:"restore-volume"}}).when("/data-protection-monitoring/volume-actions-restore-selection",{templateUrl:"views/volume-actions-restore-selection.html",controller:"volumeActionsRestoreSelectionCtrl",breadcrumbOptions:{labelKey:"restore-volume"}}).when("/hosts/:hostId/volume-actions-restore-selection",{templateUrl:"views/volume-actions-restore-selection.html",controller:"volumeActionsRestoreSelectionCtrl",breadcrumbOptions:{labelKey:"restore-volume"}}).when("/storage-systems/:storageSystemId/data-protection-monitoring/volume-actions-restore-selection",{templateUrl:"views/volume-actions-restore-selection.html",controller:"volumeActionsRestoreSelectionCtrl",breadcrumbOptions:{labelKey:"restore-volume"}}).when("/storage-systems/:storageSystemId/replication-groups",{templateUrl:"views/replication-groups.html",controller:"ReplicationGroupsCtrl",resolve:{ReplicationGroupSInitialResult:["$route","replicationGroupsService",function(a,b){var c=a.current.params.storageSystemId,d={};return b.cloneExternalVolumePairExists(c).then(function(a){return d.cloneExternalVolumePairExist=0!==a,b.snapshotExternalVolumePairExists(c)}).then(function(a){return d.snapshotExternalVolumePairExist=0!==a,d})}]},breadcrumbOptions:{labelKey:"common-replication-groups",peers:["storage-ports","storage-pools","volumes","parity-groups","external-parity-groups","file-pools","file-systems","shares-exports","vfs"]},helpContext:"R_REPLICATION_GROUP_INV"}).when("/storage-systems/:storageSystemId/replication-groups/replication-group-actions-confirmation",{templateUrl:"views/replication-group-actions-confirmation.html",controller:"replicationGroupActionsConfirmationCtrl",breadcrumbOptions:{labelKey:"common-affected-volume-pairs"}}).when("/storage-systems/:storageSystemId/replication-groups/edit",{templateUrl:"views/replication-group-edit.html",controller:"replicationGroupEditCtrl",breadcrumbOptions:{labelKey:"action-tooltip-edit-replication-groups"},helpContext:"R_REPLICATION_GROUP_EDIT"}).when("/storage-systems",{templateUrl:"views/storage-systems.html",controller:"StorageSystemsCtrl",breadcrumbOptions:{labelKey:"common-storage-systems"},helpContext:"C_STORAGE_SYS_INV"}).when("/storage-systems/add",{templateUrl:"views/storage-systems-add.html",controller:"StorageSystemsAddCtrl",breadcrumbOptions:{labelKey:"storage-systems-add"},helpContext:"T_HID_ADD_STORAGE_SYSTEM"}).when("/storage-systems/:storageSystemId/update",{templateUrl:"views/storage-systems-update.html",controller:"StorageSystemsUpdateCtrl",breadcrumbOptions:{labelKey:"storage-systems-update"},helpContext:"T_UPDATE_STORAGE_SYS"}).when("/storage-systems/:storageSystemId/settings",{templateUrl:"views/storage-system-settings.html",controller:"StorageSystemSettingsCtrl",controllerAs:"vm",breadcrumbOptions:{labelKey:"storage-system-settings"},helpContext:"T_HID_VERIFY_STORAGE_SYSTEM"}).when("/login",{templateUrl:"views/login.html",controller:"LoginCtrl"}).when("/security",{templateUrl:"views/security.html",controller:"SecurityCtrl",breadcrumbOptions:{labelKey:"nav-bar-header-security"},helpContext:"T_ADMIN_SECURITY"}).when("/storage-systems/:storageSystemId",{templateUrl:"views/storage-system.html",controller:"StorageSystemCtrl",helpContext:"R_STORAGE_SYSTEM_DETAILS"}).when("/storage-systems/:storageSystemId/volumes",{templateUrl:"views/storage-system-volumes.html",controller:"StorageSystemVolumesCtrl",breadcrumbOptions:{labelKey:"common-storage-system-volumes",peers:["storage-ports","storage-pools","parity-groups","external-parity-groups","replication-groups","file-pools","file-systems","shares-exports","vfs"]},helpContext:"C_VOLUMES_INV"}).when("/storage-systems/:storageSystemId/volumes/protect",{templateUrl:"views/protect-volumes.html",controller:"ProtectVolumesCtrl",breadcrumbOptions:{labelKey:"protect-volumes"},helpContext:"C_DATAPROTECTION"}).when("/storage-systems/:storageSystemId/volumes/:volumeId/protect",{templateUrl:"views/protect-volumes.html",controller:"ProtectVolumesCtrl",breadcrumbOptions:{labelKey:"protect-volumes"},helpContext:"C_DATAPROTECTION"}).when("/storage-systems/:storageSystemId/volumes/unprotect",{templateUrl:"views/unprotect-volumes.html",controller:"UnprotectVolumesCtrl",breadcrumbOptions:{labelKey:"unprotect-volume"},helpContext:"T_UNPROTECT_VOLUMES"}).when("/storage-systems/:storageSystemId/volumes/:volumeId/unprotect",{templateUrl:"views/unprotect-volumes.html",controller:"UnprotectVolumesCtrl",breadcrumbOptions:{labelKey:"unprotect-volume"},helpContext:"T_UNPROTECT_VOLUMES"}).when("/storage-systems/:storageSystemId/data-protection-monitoring/protect",{templateUrl:"views/protect-volumes.html",controller:"ProtectVolumesCtrl",breadcrumbOptions:{labelKey:"protect-volumes"},helpContext:"C_DATAPROTECTION"}).when("/data-protection-monitoring/protect",{templateUrl:"views/protect-volumes.html",controller:"ProtectVolumesCtrl",breadcrumbOptions:{labelKey:"protect-volumes"},helpContext:"C_DATAPROTECTION"}).when("/hosts/:hostId/protect",{templateUrl:"views/protect-volumes.html",controller:"ProtectVolumesCtrl",breadcrumbOptions:{labelKey:"protect-volumes"},helpContext:"C_DATAPROTECTION"}).when("/storage-systems/:storageSystemId/volumes/add",{templateUrl:"views/storage-system-volumes-add.html",controller:"StorageSystemVolumesAddCtrl",breadcrumbOptions:{labelKey:"storage-volumes-add"},helpContext:"T_HID_CREATING_A_VOLUME"}).when("/storage-systems/:storageSystemId/volumes/:volumeId",{templateUrl:"views/storage-system-volume.html",controller:"StorageSystemVolumeCtrl",helpContext:"R_VOLUME_DETAILS"}).when("/storage-systems/:storageSystemId/volumes/:volumeId/update",{templateUrl:"views/storage-system-volume-update.html",controller:"StorageSystemVolumeUpdateCtrl",breadcrumbOptions:{labelKey:"storage-volume-update"},helpContext:"T_UPDATE_VOL"}).when("/storage-systems/:storageSystemId/attach-volumes",{templateUrl:"views/storage-system-volumes-attach.html",controller:"StorageSystemVolumeAttachCtrl",breadcrumbOptions:{labelKey:"storage-volume-attach"},helpContext:"T_ATTACH_VOLUME"}).when("/storage-systems/:storageSystemId/storage-pools",{templateUrl:"views/storage-pools.html",controller:"StoragePoolsCtrl",breadcrumbOptions:{labelKey:"common-storage-system-pools",peers:["storage-ports","volumes","parity-groups","external-parity-groups","replication-groups","file-pools","file-systems","shares-exports","vfs"]},helpContext:"C_POOLS_INV"}).when("/storage-systems/:storageSystemId/storage-pools/add",{templateUrl:"views/storage-pools-add.html",controller:"StoragePoolsAddCtrl",breadcrumbOptions:{labelKey:"storage-pools-add"},helpContext:"C_CREATE_POOL"}).when("/storage-systems/:storageSystemId/storage-pools/:storagePoolId/update",{templateUrl:"views/storage-pool-update.html",controller:"StoragePoolUpdateCtrl",breadcrumbOptions:{labelKey:"storage-pools-update"},helpContext:"R_POOL_DETAILS"}).when("/storage-systems/:storageSystemId/storage-pools/:storagePoolId",{templateUrl:"views/storage-pool.html",controller:"StoragePoolCtrl",helpContext:"R_POOL_DETAILS"}).when("/storage-systems/:storageSystemId/storage-ports",{templateUrl:"views/storage-ports.html",controller:"StoragePortsCtrl",breadcrumbOptions:{labelKey:"common-storage-system-ports",peers:["volumes","storage-pools","parity-groups","external-parity-groups","replication-groups","file-pools","file-systems","shares-exports","vfs"]},helpContext:"T_ENABLE_PORT_SECURITY"}).when("/storage-systems/:storageSystemId/storage-ports/:storagePortId/update",{templateUrl:"views/storage-port-update.html",controller:"PortUpdateCtrl",breadcrumbOptions:{labelKey:"storage-port-update"},helpContext:""}).when("/storage-systems/:storageSystemId/parity-groups",{templateUrl:"views/parity-groups.html",controller:"ParityGroupsCtrl",breadcrumbOptions:{labelKey:"common-parity-groups",peers:["storage-ports","volumes","storage-pools","external-parity-groups","replication-groups","file-pools","file-systems","shares-exports","vfs"]},helpContext:"C_PARITY_GROUPS_INV"}).when("/storage-systems/:storageSystemId/external-parity-groups",{templateUrl:"views/external-parity-groups.html",controller:"ExternalParityGroupsCtrl",breadcrumbOptions:{labelKey:"common-external-parity-groups",peers:["storage-ports","storage-pools","volumes","parity-groups","replication-groups","file-pools","file-systems","shares-exports","vfs"]},helpContext:"C_EXTERNAL_PARITY_GROUPS_INV"}).when("/monitoring",{templateUrl:"views/monitoring.html",controller:"MonitoringCtrl",breadcrumbOptions:{labelKey:"nav-bar-header-monitoring"},helpContext:"C_MONITORING"}).when("/storage-systems/:storageSystemId/monitoring",{templateUrl:"views/monitoring.html",controller:"MonitoringCtrl",breadcrumbOptions:{labelKey:"nav-bar-header-monitoring"},helpContext:"C_MONITORING"}).when("/storage-systems/:storageSystemId/parity-groups/disk-manage",{templateUrl:"views/disk-manage.html",controller:"DiskManageCtrl",breadcrumbOptions:{labelKey:"disk-manage"},helpContext:"T_MANAGE_FREE_SPARE_DISKS"}).when("/storage-systems/:storageSystemId/parity-groups/add",{templateUrl:"views/parity-groups-add.html",controller:"ParityGroupsAddCtrl",breadcrumbOptions:{labelKey:"parity-groups-add"},helpContext:"C_CREATE_PARITY_GROUPS"}).when("/fabric-switches/add",{templateUrl:"views/fabric-switch-add.html",controller:"FabricSwitchAddCtrl",breadcrumbOptions:{labelKey:"fabric-add"},helpContext:"T_ADD_FABRIC_SWITCH"}).when("/fabric-switches",{templateUrl:"views/fabric-switches.html",controller:"FabricSwitchesCtrl",breadcrumbOptions:{labelKey:"fabric-switches"},helpContext:"T_ADD_FABRIC_SWITCH"}).when("/fabric-switches/:sanFabricId/update",{templateUrl:"views/fabric-switch-update.html",controller:"FabricUpdateCtrl",breadcrumbOptions:{labelKey:"fabric-update"},helpContext:"T_ADD_FABRIC_SWITCH"}).when("/snmp-managers",{templateUrl:"views/snmp-managers.html",controller:"SnmpManagerCtrl",breadcrumbOptions:{labelKey:"snmp-managers"},helpContext:"T_ADD_SNMP_MANAGER"}).when("/snmp-managers/add",{templateUrl:"views/snmp-manager-add.html",controller:"SnmpManagerAddCtrl",breadcrumbOptions:{labelKey:"snmp-manager-add"},helpContext:"T_ADD_SNMP_MANAGER"}).when("/snmp-managers/:name/update",{templateUrl:"views/snmp-manager-update.html",controller:"SnmpManagerUpdateCtrl",breadcrumbOptions:{labelKey:"snmp-manager-update"},helpContext:"T_UPDATE_SNMP_MANAGER"}).when("/tier-management",{templateUrl:"views/tier-edit.html",controller:"TierManagementCtrl",breadcrumbOptions:{labelKey:"tier-management"},helpContext:"C_TIER_MANAGEMENT"}).when("/change-local-password",{templateUrl:"views/change-local-password.html",controller:"ChangeLocalPasswordCtrl",breadcrumbOptions:{labelKey:"change-local-password"},helpContext:"INDEX"}).when("/storage-systems/:storageSystemId/file-pools",{templateUrl:"views/file-pools.html",controller:"FilePoolsCtrl",breadcrumbOptions:{labelKey:"common-storage-system-file-pools",peers:["storage-ports","storage-pools","volumes","parity-groups","external-parity-groups","replication-groups","file-systems","shares-exports","vfs"]},helpContext:"INDEX"}).when("/storage-systems/:storageSystemId/vfs",{templateUrl:"views/enterprise-virtual-servers.html",controller:"EnterpriseVirtualServersCtrl",breadcrumbOptions:{labelKey:"common-storage-system-file-servers",peers:["storage-ports","storage-pools","volumes","parity-groups","external-parity-groups","replication-groups","file-pools","file-systems","shares-exports"]},helpContext:"R_EVS_INV"}).when("/storage-systems/:storageSystemId/shares-exports",{templateUrl:"views/shares-exports.html",controller:"SharesExportsCtrl",breadcrumbOptions:{labelKey:"common-storage-system-shares-exports",peers:["storage-ports","storage-pools","volumes","parity-groups","external-parity-groups","replication-groups","file-pools","file-systems","vfs"]},helpContext:"R_SHARE_EXPORT_INV"}).when("/storage-systems/:storageSystemId/shares-exports/add",{templateUrl:"views/shares-exports-add.html",controller:"SharesExportsAddCtrl",breadcrumbOptions:{labelKey:"shares-exports-add"},helpContext:"T_CREATE_SHARE_EXPORT"}).when("/storage-systems/:storageSystemId/file-systems/:fileSystemId/exports/:exportId/update",{templateUrl:"views/exports-update.html",controller:"ExportsUpdateCtrl",breadcrumbOptions:{labelKey:"export-update"},helpContext:"T_UPDATE_EXPORT"}).when("/storage-systems/:storageSystemId/file-systems/:fileSystemId/shares/:shareId/update",{templateUrl:"views/shares-update.html",controller:"SharesUpdateCtrl",breadcrumbOptions:{labelKey:"share-update"},helpContext:"T_UPDATE_SHARE"}).when("/vfs",{templateUrl:"views/enterprise-virtual-servers.html",controller:"EnterpriseVirtualServersCtrl",breadcrumbOptions:{labelKey:"common-storage-system-file-servers"},helpContext:"R_EVS_INV"}).when("/vfs/add",{templateUrl:"views/evs-add.html",controller:"EvsAddCtrl",breadcrumbOptions:{labelKey:"evs-add"},helpContext:"T_CREATE_EVS"}).when("/storage-systems/:storageSystemId/file-systems",{templateUrl:"views/file-systems.html",controller:"FileSystemsCtrl",breadcrumbOptions:{labelKey:"common-storage-system-file-systems",peers:["storage-ports","storage-pools","volumes","parity-groups","external-parity-groups","replication-groups","file-pools","shares-exports","vfs"]},helpContext:"R_FILE_SYS_DETAILS"}).when("/storage-systems/:storageSystemId/file-systems/add",{templateUrl:"views/file-systems-add.html",controller:"FileSystemsAddCtrl",breadcrumbOptions:{labelKey:"file-systems-add"},helpContext:"T_CREATE_FILE_SYSTEM"}).when("/storage-systems/:storageSystemId/file-systems/:fileSystemId",{templateUrl:"views/file-system.html",controller:"FileSystemCtrl",helpContext:"R_FILE_SYS_DETAILS"}).when("/storage-systems/:storageSystemId/vfs/:evsId/file-systems/add",{templateUrl:"views/file-systems-add.html",controller:"FileSystemsAddCtrl",breadcrumbOptions:{labelKey:"file-systems-add"},helpContext:"T_CREATE_FILE_SYSTEM"}).when("/storage-systems/:storageSystemId/file-pools/:filePoolId/file-systems/add",{templateUrl:"views/file-systems-add.html",controller:"FileSystemsAddCtrl",breadcrumbOptions:{labelKey:"file-systems-add"},helpContext:"T_CREATE_FILE_SYSTEM"}).when("/storage-systems/:storageSystemId/file-systems/:fileSystemId/shares-exports/add",{templateUrl:"views/shares-exports-add.html",controller:"SharesExportsAddCtrl",breadcrumbOptions:{labelKey:"shares-exports-add"},helpContext:"T_CREATE_SHARE_EXPORT"}).when("/storage-systems/:storageSystemId/vfs/add",{templateUrl:"views/evs-add.html",controller:"EvsAddCtrl",breadcrumbOptions:{labelKey:"evs-add"},helpContext:"T_CREATE_EVS"}).when("/storage-systems/:storageSystemId/vfs/:evsId/update",{templateUrl:"views/evs-update.html",controller:"EvsUpdateCtrl",breadcrumbOptions:{labelKey:"evs-update"},helpContext:"T_UPDATE_EVS"}).when("/storage-systems/:storageSystemId/vfs/:evsId",{templateUrl:"views/enterprise-virtual-server.html",controller:"EnterpriseVirtualServerCtrl",helpContext:"R_EVS_DETAILS"}).when("/storage-systems/:storageSystemId/file-systems/:fileSystemId/update",{templateUrl:"views/file-systems-update.html",controller:"FileSystemsUpdateCtrl",breadcrumbOptions:{labelKey:"file-systems-update"},helpContext:"T_UPDATE_FILE_SYSTEM"}).when("/storage-systems/:storageSystemId/file-pools/:filePoolId/file-systems/:fileSystemId/update",{templateUrl:"views/file-systems-update.html",controller:"FileSystemsUpdateCtrl",breadcrumbOptions:{labelKey:"file-systems-update"},helpContext:"T_UPDATE_FILE_SYSTEM"}).when("/storage-systems/:storageSystemId/file-systems/:fileSystemId/exports/:exportId",{templateUrl:"views/export.html",controller:"ExportCtrl",helpContext:"R_EXPORT_DETAIL"}).when("/storage-systems/:storageSystemId/file-systems/:fileSystemId/shares/:shareId",{templateUrl:"views/share.html",controller:"ShareCtrl",helpContext:"R_SHARE_DETAIL"}).when("/storage-systems/:storageSystemId/file-pools/add",{templateUrl:"views/file-pools-add.html",controller:"FilePoolsAddCtrl",breadcrumbOptions:{labelKey:"file-pool-add"},helpContext:"T_CREATE_FILE_POOL"}).when("/storage-systems/:storageSystemId/file-pools/:filePoolId",{templateUrl:"views/file-pool.html",controller:"FilePoolCtrl",helpContext:"R_FILE_POOL_DETAILS"}).when("/storage-systems/:storageSystemId/file-pools/:filePoolId/expand",{templateUrl:"views/file-pools-expand.html",controller:"FilePoolsExpandCtrl",breadcrumbOptions:{labelKey:"file-pool-expand"},helpContext:"T_EXPAND_FILE_POOL"}).otherwise({redirectTo:"/"}),c.html5Mode(!1)}]).run(["$location","authService",function(a,b){b.getUser().authenticated||a.path("/login")}]).constant("rainerColorRange",["#FAA300","#F9D169","#B5B5B5","#CACACA","#FF9B42","#CF6100","#FC2171","#8B001F","#4B6324","#709436","#AAD16D","#339334","#33D134","#99E89A","#033D5A","#367493","#6897AE"]).constant("tiersColorRange",["#868686","#fcb663","#E3E4E7","#fbaf17"]),angular.module("config",[]).constant("ENV",{name:"development",debug:!0}).constant("BEL_UI_PATH","bower_components/bel-ui"),angular.module("rainierApp").constant("STORAGE_SYSTEM_VOLUMES_LIST_HEADER_COLUMNS",[{sort:!1,styles:"col-lg-1 col-md-1 col-sm-1 col-xs-1 cell panel-title center"},{sort:!1,styles:"col-lg-1 col-md-1 col-sm-1 col-xs-1 cell with-icon center-content"},{titleKey:"storage-volume-id",sort:!0,sortProperty:"volumeId",styles:"col-lg-1 col-md-1 col-sm-1 col-xs-1 ellipsis cell td"},{titleKey:"storage-systems-serial-number",sort:!0,sortProperty:"storageSystemId",styles:"col-lg-1 col-md-1 col-sm-1 col-xs-1 ellipsis cell td"},{titleKey:"common-name",sort:!0,sortProperty:"label",styles:"col-lg-1 col-md-1 col-sm-1 col-xs-1 ellipsis cell td"},{titleKey:"data-protection-type",sort:!0,sortProperty:"displayedDpType",styles:"col-lg-1 col-md-1 col-sm-1 col-xs-1 ellipsis cell td"},{titleKey:"data-protection-status",sort:!0,sortProperty:"dpMonitoringStatus",styles:"col-lg-1 col-md-1 col-sm-1 col-xs-1 ellipsis cell td"},{titleKey:"common-label-total",sort:!0,sortProperty:"totalCapacity.value",styles:"col-lg-1 col-md-1 col-sm-1 col-xs-1 ellipsis cell td"},{titleKey:"common-label-free",sort:!0,sortProperty:"availableCapacity.value",styles:"col-lg-1 col-md-1 col-sm-1 col-xs-1 ellipsis cell td"},{titleKey:"common-label-used",sort:!0,sortProperty:"usedCapacity.value",styles:"col-lg-1 col-md-1 col-sm-1 col-xs-1 ellipsis cell td"}]).constant("GET_STORAGE_SYSTEM_VOLUMES_RESOURCES_FUNCTION",function(a){return a.volumes}),angular.module("rainierApp").controller("AboutCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("rainierApp").controller("AttachVolumesCtrl",["$scope","ShareDataService","orchestratorService","scrollDataSourceBuilderServiceNew","viewModelService","synchronousTranslateService","paginationService","queryService","objectTransformService","$timeout","$location",function(a,b,c,d,e,f,g,h,i,j,k){function l(a,b){return a.length>b?_.difference(a,b)[0]:_.difference(b,a)[0]}function m(b){a.dataModel.attachModel.selectedHostModeOption=b,v=a.dataModel.attachModel.selectedHostModeOption}function n(b){_.forEach(b.resources,function(a){a.selected=!1}),a.dataModel.getResources=function(){return h.setSort("volumeId",!1),g.get(a.dataModel.nextToken,"volumes",i.transformVolume,!1,a.dataModel.selectedStorageSystem.storageSystemId)},a.dataModel.nextToken=b.nextToken,a.dataModel.total=b.total,a.dataModel.currentPageCount=0,a.dataModel.displayList=b.resources,d.setupDataLoader(a,b.resources,"storageSystemVolumesSearch"),a.dataModel.allItemsSelected=!1}var o=b.pop("selectedServers")||[],p=f.translate("storage-volume-attach-valid-tooltip"),q=f.translate("storage-volume-attach-invalid-tooltip"),r="storage-ports",s="volumes";a.canSubmit=!0,h.clearQueryMap(),o&&0!==o.length||k.path("hosts"),a.storageSystems=g.getAllPromises(null,"storage-systems",!0,null,i.transformStorageSystem).then(function(b){var c=[],d=!1;_.forEach(b,function(a){a.accessible&&c.push(a)});var g=c[0];0===c.length&&(d=!0);var h={view:"tile",selectedStorageSystem:g,storageSystems:c,storagePorts:[],sort:{field:"volumeId",reverse:!1,setSort:function(a){j(function(){h.sort.field===a?h.sort.reverse=!h.sort.reverse:(h.sort.field=a,h.sort.reverse=!1)})}}};angular.extend(h,e.newWizardViewModel(["select","attach"])),h.selectModel={noAvailableArray:d,confirmTitle:f.translate("storage-volume-attach-confirmation"),confirmMessage:f.translate("storage-volume-attach-zero-selected"),canGoNext:function(){return _.some(h.filteredList,"selected")},next:function(){h.selectModel.canGoNext&&!h.selectModel.canGoNext()||(j(function(){h.attachModel.selectedVolumes=_.where(h.filteredList,"selected"),_.forEach(h.attachModel.selectedVolumes,function(a){a.lun=null,a.decimalNumberRegexp=/^[^.]+$/,a.hasDuplicatedLun=!1,a.validationTooltip=p})}),h.goNext())},validation:!0,itemSelected:!1},h.process=function(a){a=_.filter(a,function(a){return"FIBRE"===a.type}),_.forEach(a,function(a){a.storageSystemModel=h.storageSystemModel,i.transformPort(a)}),h.storagePorts=h.storagePorts.concat(a)},a.dataModel=h});var t=function(b){a.dataModel.nextToken=b.nextToken,a.dataModel.displayList=b.resources,a.dataModel.itemCounts={filtered:a.dataModel.displayList.length,total:a.dataModel.total}};a.$watch("dataModel.selectedStorageSystem",function(b){b&&(h.setSort("volumeId",!1),g.get(null,"volumes",i.transformVolume,!1,b.storageSystemId).then(n),c.storageSystem(b.storageSystemId).then(function(c){a.dataModel.storageSystemModel=c.model,g.getAll(null,r,!0,b.storageSystemId,c.model,a.dataModel)}),a.filterModel={filter:{freeText:"",volumeType:"",replicationType:[],protectionStatusList:[],snapshot:!1,clone:!1,"protected":!1,unprotected:!1,secondary:!1,freeCapacity:{min:0,max:1e3,unit:"PB"},totalCapacity:{min:0,max:1e3,unit:"PB"},utilization:{min:0,max:100}},arrayType:(new g.SearchType).ARRAY,filterQuery:function(a,c,d,e){var f=new g.QueryObject(a,d,c,e);g.setFilterSearch(f),g.getQuery(s,i.transformVolume,b.storageSystemId).then(function(a){t(a)})},sliderQuery:function(a,c,d,e){g.setSliderSearch(a,c,d,e),g.getQuery(s,i.transformVolume,b.storageSystemId).then(function(a){t(a)})}})}),a.$watch(function(a){return a.dataModel&&a.dataModel.filteredList?a.dataModel.filteredList.map(function(a){return a.selected}):void 0},function(b){if(b){for(var c=!1,d=0;d<a.dataModel.filteredList.length;++d)if(a.dataModel.filteredList[d].selected){c=!0;break}a.dataModel.selectModel.itemSelected=c}},!0),a.$watch("dataModel.attachModel.selectedVolumes",function(b,c){if(b&&c&&b!==c){var d={};_.forEach(a.dataModel.attachModel.selectedVolumes,function(a){a.lun?a.validationTooltip=p:a.validationTooltip=q,d[a.lun]||(d[a.lun]=[]),void 0!==a.lun&&(0===d[a.lun].length||null===a.lun?(a.hasDuplicatedLun=!1,a.validationTooltip=p,d[a.lun].push(a)):null!==a.lun&&(_.forEach(d[a.lun],function(a){a.hasDuplicatedLun=!0,a.validationTooltip=q}),a.hasDuplicatedLun=!0,a.validationTooltip=q,d[a.lun].push(a)))})}},!0),a.$watch("dataModel.attachModel.selectedVolumes",function(b,c){if(b&&c&&b!==c){var d=!0;_.forEach(a.dataModel.attachModel.selectedVolumes,function(a){a.validationTooltip&&a.validationTooltip===q&&(d=!1)}),a.canSubmit=d}},!0);var u="AUTO",v=[0];a.$watch("dataModel.storagePorts",function(b){if(b){var d=c.hostModeOptions(),f=c.osType();f.splice(0,0,u);var g=a.dataModel;g.attachModel={subTitle:"Selected Volumes",storageSystemSelectable:!1,storagePools:b,selectedServers:o,hostModes:f,hostMode:f[0],hostModeOptions:d,serverPortMapperModel:e.newServerPortMapperModel(b,o),selectedHostModeOption:[0],enableZoning:!1,enableLunUnification:!1,canSubmit:function(){return _.every(g.attachModel.selectedVolumes,function(a){return!a.lun||_.isFinite(a.lun)})},submit:function(){if(a.canSubmit){var b=e.buildLunResources(g.attachModel.selectedVolumes),d=g.attachModel.serverPortMapperModel.getPorts(),f=_.where(g.attachModel.selectedHostModeOption,function(a){return a>0}),h={storageSystemId:g.selectedStorageSystem.storageSystemId,hostModeOptions:f,volumes:b,ports:d,enableZoning:g.attachModel.enableZoning,enableLunUnification:g.attachModel.enableLunUnification};g.attachModel.hostMode!==u&&(h.intendedImageType=g.attachModel.hostMode),c.attachVolume(h).then(function(){window.history.back()})}},previous:function(){g.goBack()}},g.checkSelectedHostModeOptions=function(){var b=a.dataModel.attachModel.selectedHostModeOption,c=l(v,b);m(0===b.length||0===c?[0]:_.without(b,0))}}})}]),angular.module("rainierApp").controller("ChangeLocalPasswordCtrl",["$scope","orchestratorService",function(a,b){function c(b){if(b)for(var c=b.users,d=0;d<c.length;d++){var e=c[d];if("sysadmin"===e.loginName){a.dataModel={accountDomainId:e.accountDomainId,sysAdminId:e.id,loginName:e.loginName,password:"",confirmPassword:"",passwordFieldType:"password",showPassword:!1,passwordMatch:!0};break}}}function d(){var b={password:a.dataModel.password};return b}function e(a){return void 0!==a&&null!==a&&a.length>0}function f(a,b){return a===b}b.accountDomains().then(function(a){if(a)for(var d=a.accountDomains,e=0;e<d.length;e++){var f=d[e];if("LOCAL"===f.domain){b.getSystemAccountsDomain(f.id).then(c);break}}}),a.isValid=function(){var b=a.dataModel;return b?e(a.dataModel.loginName)&&e(a.dataModel.password)&&e(a.dataModel.confirmPassword)&&f(a.dataModel.password,a.dataModel.confirmPassword):!1},a.updateSysAdminPassword=function(){var c=d();b.updateSystemAccountDomain(a.dataModel.accountDomainId,a.dataModel.sysAdminId,c),window.history.back()},a.$watchGroup(["dataModel.confirmPassword","dataModel.password"],function(){var b=a.dataModel;b&&e(b.password)&&e(b.confirmPassword)?a.dataModel.passwordMatch=f(b.password,b.confirmPassword):b&&e(b.password)&&""===b.confirmPassword&&(a.dataModel.passwordMatch=!0)},!0),a.$watch("dataModel.showPassword",function(){var b=a.dataModel;b&&(b.showPassword===!1?a.dataModel.passwordFieldType="password":a.dataModel.passwordFieldType="text")},!0)}]),angular.module("rainierApp").controller("CreateAndAttachVolumesCtrl",["$scope","orchestratorService","viewModelService","ShareDataService","paginationService","objectTransformService","cronStringConverterService","volumeService","$location","$timeout",function(a,b,c,d,e,f,g,h,i,j){function k(a,b){return a.length>b?_.difference(a,b)[0]:_.difference(b,a)[0]}function l(b){a.dataModel.attachModel.selectedHostModeOption=b,t=a.dataModel.attachModel.selectedHostModeOption}function m(){a.dataModel.showDropDownColumn=!0}function n(b){a.dataModel.showDropDownColumn=!1,j(m,100);var c,d=[{useNew:!0,name:"Use New"}],e=g.fromDatePickerToObjectModel(a.dataModel.protectModel.schedule.type,a.dataModel.protectModel.schedule.time,a.dataModel.protectModel.schedule.dayOfMonth,a.dataModel.protectModel.schedule.selectedDays,a.dataModel.protectModel.schedule.hourInterval,a.dataModel.protectModel.schedule.hourStartMinute);"SNAPSHOT"===b?(c=parseInt(a.dataModel.protectModel.noOfSnapshots),_.forEach(a.dataModel.copyGroups,function(f){var h="On"===f.consistent;"SNAPSHOT"===b&&("Snapshot"!==f.type||_.isFinite(c)&&0!==c&&c!==f.numberOfCopies||!g.isEqualForObjectModel(e,f.schedule)||a.dataModel.protectModel.consistencyGroup!==h||d.push(f))})):c="CLONE"===b?a.dataModel.protectModel.noOfCopies:null,a.dataModel.protectModel.copyGroup=d[0],a.dataModel.protectModel.validCopyGroups=d}var o=d.pop("selectedServers"),p="storage-ports";o&&0!==o.length||i.path("hosts"),e.getAllPromises(null,"storage-systems",!0,null,f.transformStorageSystem).then(function(b){var d=c.newWizardViewModel(["create","attach","protect"]);d.storageSystems=[],_.forEach(b,function(a){a.accessible&&d.storageSystems.push(a)}),d.selectedStorageSystem=d.storageSystems[0],d.copyGroupNameRegexp=/^[a-zA-Z0-9_][a-zA-Z0-9-_]*$/,d.decimalNumberRegexp=/^[^.]+$/,d.validLabel=function(a){a.labelIsValid=h.validateCombinedLabel(a.label,a.suffix,a.noOfVolumes)},d.storagePorts=[],d.process=function(a){a=_.filter(a,function(a){return"FIBRE"===a.type}),_.forEach(a,function(a){a.storageSystemModel=d.storageSystemModel,f.transformPort(a)}),d.storagePorts=d.storagePorts.concat(a)},a.dataModel=d});var q=function(c){c&&(r(c),e.getAllPromises(null,"storage-pools",!0,c.storageSystemId,f.transformPool).then(function(b){a.dataModel.storagePools=b}),b.storageSystem(c.storageSystemId).then(function(b){a.dataModel.storageSystemModel=b.model,e.getAll(null,p,!0,c.storageSystemId,b.model,a.dataModel)}),e.getAllPromises(null,"replication-groups",!0,c.storageSystemId,f.transformReplicationGroup).then(function(b){a.dataModel.copyGroups=b}))},r=function(b){a.dataModel.summaryModel=c.buildSummaryModel(b)};a.$watch("dataModel.selectedStorageSystem",function(a){q(a)}),a.$watch("dataModel.storagePools",function(b){b&&(a.dataModel.createModel={storageSystemSelectable:!0,volumesGroupsModel:c.newCreateVolumeModel(b)})});var s="AUTO",t=[0];a.$watch("dataModel.storagePorts",function(d){
if(d){var e=b.hostModeOptions(),f=b.osType().sort();f.splice(0,0,s);var g={storageSystemSelectable:!1,enableZoning:!1,enableLunUnification:!1,storagePools:d,selectedServers:o,selectedHostModeOption:t,hostModes:f,hostMode:f[0],hostModeOptions:e,serverPortMapperModel:c.newServerPortMapperModel(d,o),previous:function(){a.dataModel.goBack()}};a.dataModel.attachModel=g,a.dataModel.checkSelectedHostModeOptions=function(){var b=a.dataModel.attachModel.selectedHostModeOption,c=k(t,b);l(0===b.length||0===c?[0]:_.without(b,0))}}});var u=c.newSubscriptionUpdateModel();a.$watchGroup(["dataModel.selectedStorageSystem","dataModel.createModel.volumesGroupsModel.volumes"],function(a){if(!_.some(a,function(a){return!a})){var b=a[0],c=a[1],d=u.getUpdatedModel(b,c);d&&j(function(){r(d)})}},!0),a.$watch("dataModel.copyGroups",function(d){if(d){var e={replicationTechnology:"SNAPSHOT",noOfSnapshots:null,noOfCopies:0,consistencyGroup:!1,storageSystemSelectable:!1,copyGroupName:"",schedule:c.newScheduleModel(),submit:function(){a.dataModel.goNext();var c=a.dataModel,d=c.createModel.volumesGroupsModel.mapToPayloads(c.protectModel.selectedVolumes),e="NONE"===c.protectModel.replicationTechnology,f=null;e||(f=c.protectModel.getReplicationPayload());var g=_.where(c.attachModel.selectedHostModeOption,function(a){return a>0}),h={storageSystemId:c.selectedStorageSystem.storageSystemId,hostModeOptions:g,ports:c.attachModel.serverPortMapperModel.getPorts(),enableZoning:c.attachModel.enableZoning,enableLunUnification:c.attachModel.enableLunUnification,volumes:d,skipProtection:e,replicationGroup:f};c.attachModel.hostMode!==s&&(h.intendedImageType=c.attachModel.hostMode),b.createAttachProtectVolumes(h).then(function(){window.history.back()})},previous:function(){a.dataModel.goBack()}};e.canSubmit=function(){if(e.replicationModel={},"NONE"===e.replicationTechnology)return!0;if(e.copyGroup.useNew){if(_.isEmpty(e.copyGroupName)||!_.isFinite(e.noOfSnapshots))return!1;e.replicationModel.replicationGroupName=e.copyGroupName}else e.replicationModel.replicationGroupId=e.copyGroup.id;switch(e.replicationTechnology){case"SNAPSHOT":return e.schedule.isValid();case"CLONE":return _.isFinite(e.noOfSnapshots)}return!0},e.getReplicationPayload=function(){var b;if(e.copyGroup.useNew)switch(b={replicationType:e.replicationTechnology,consistencyGroupNeeded:e.consistencyGroup,replicationGroupName:e.copyGroupName,replicationGroupId:null,schedule:null,numberOfBackups:null},b.replicationGroupName=e.copyGroupName,e.replicationTechnology){case"SNAPSHOT":b.numberOfBackups=e.noOfSnapshots,b.schedule=g.fromDatePickerToObjectModel(a.dataModel.protectModel.schedule.type,a.dataModel.protectModel.schedule.time,a.dataModel.protectModel.schedule.dayOfMonth,a.dataModel.protectModel.schedule.selectedDays,a.dataModel.protectModel.schedule.hourInterval,a.dataModel.protectModel.schedule.hourStartMinute);break;case"CLONE":b.numberOfBackups=e.noOfCopies}else b={replicationGroupId:e.copyGroup.id};return b},a.dataModel.protectModel=e,n(a.dataModel.protectModel.replicationTechnology)}}),a.$watchGroup(["dataModel.currentPage","dataModel.protectModel.replicationTechnology","dataModel.protectModel.noOfSnapshots","dataModel.protectModel.noOfCopies","dataModel.protectModel.consistencyGroup","dataModel.protectModel.schedule.toScheduleString()"],function(a){if("protect"===a[0]){var b=a[1];b&&n(b)}}),a.$watchGroup(["dataModel.createModel","dataModel.attachModel"],function(b){if(!_.some(b,function(a){return!a})){var c=b[0],d=b[1],e=c.volumesGroupsModel;e&&e.getVolumeGroups&&(c.next=function(){var b=e.getVolumeGroups();d.selectedVolumes=b,a.dataModel.goNext()},c.canGoNext=function(){return e.isValid()})}}),a.$watchGroup(["dataModel.attachModel","dataModel.protectModel"],function(b){if(!_.some(b,function(a){return!a})){var c=b[1],d=b[0];d.next=function(){c.selectedVolumes=d.selectedVolumes,a.dataModel.goNext()}}})}]),angular.module("rainierApp").controller("DashboardCtrl",["$scope","orchestratorService","objectTransformService","paginationService",function(a,b,c,d){function e(e){b.tiers().then(function(a){return h=a,b.storageSystemsSummary()}).then(function(g){a.dataModel={fabricsCount:0,evsCount:0},e&&(g.unified=!0,a.dataModel.evsCount=0,a.dataModel.unified=!0,b.allEnterpriseVirtualServers().then(function(b){a.dataModel.evsCount=b.evses.length}));var i=c.transformToStorageSummaryModel(g,e,f);c.transformTierSummary(h,g.tierSummaryItems,i),a.model=i,b.hostsSummary().then(function(b){a.model.summary.hostsCount=b.totalHost}),d.get(null,j,c.transformFabricSwitch,!0).then(function(b){a.dataModel.fabricsCount=b.total})})}var f,g,h,i="storage-systems",j="san-fabrics";d.getAllPromises(null,i,!0,null,c.transformStorageSystem).then(function(a){return g=_.find(a,function(a){return a.unified&&a.accessible}),b.dataProtectionSummary()}).then(function(a){f=a,g?b.filePoolsSummary().then(function(a){e(a)},function(){e(!1)}):e(!1)})}]),angular.module("rainierApp").controller("DataProtectionMonitoringCtrl",["$scope","$timeout","$routeParams","orchestratorService","objectTransformService","synchronousTranslateService","scrollDataSourceBuilderService","$location","ShareDataService","monitoringService","inventorySettingsService","storageSystemVolumeService",function(a,b,c,d,e,f,g,h,i,j,k,l){function m(b,c){var d={};return d.displayName=b,c>0?(d.numberOfAlert=c,d.badgeClass="danger"):(d.badgeClass="disabled",d.numberOfAlert=0),"Volumes"===b?(d.id="volume",d.itemClass="active",d.iconClass="icon-volume",d.onClick=function(){g.setupDataLoader(a,a.dataModel.volumes,"storageSystemVolumesSearch"),k.setVolumesGridSettings(a.dataModel,{canAdd:!1}),q(a.dataModel),a.dataModel.isVolumes=!0,a.filterModel=a.volumesFilterModel}):(d.id="host",d.itemClass="",d.iconClass="icon-host",d.onClick=function(){g.setupDataLoader(a,a.dataModel.servers,"hostSearch"),k.setHostGridSettings(a.dataModel),r(a.dataModel),a.dataModel.isVolumes=!1,a.filterModel=a.hostsFilterModel}),d}var n=c.storageSystemId;n&&(a.storageSystemId=n);var o=function(a){i.volumeListForUnprotect=a,n?h.path(["storage-systems",n,"data-protection-monitoring","unprotect"].join("/")):h.path(["data-protection-monitoring","unprotect"].join("/"))},p=function(a,b){var c=0,d="";b&&b.length>0&&(c=b[0].volumeId),n?d=["storage-systems",n,"data-protection-monitoring","volume-actions-restore-selection"].join("/"):(n=b[0].storageSystemId,i.restoreStorageSystemId=n,d=["data-protection-monitoring","volume-actions-restore-selection"].join("/")),l.getVolumePairsAsPVol(null,c,n).then(function(a){i.SVolsList=_.filter(a.resources,function(a){return a.primaryVolume&&a.secondaryVolume&&a.replicationGroup}),i.restorePrimaryVolumeId=c,i.restorePrimaryVolumeToken=a.nextToken,_.forEach(i.SVolsList,function(a){a.selected=!1}),h.path(d)})},q=function(a){var b=[{icon:"icon-delete",type:"confirm",tooltip:"action-tooltip-delete",confirmTitle:"storage-volume-delete-confirmation",confirmMessage:"storage-volume-delete-selected-content",enabled:function(){return a.anySelected()},onClick:function(){_.forEach(a.getSelectedItems(),function(a){a.actions["delete"].onClick(d,!1)})}},{icon:"icon-edit",tooltip:"action-tooltip-edit",type:"link",enabled:function(){return a.onlyOneSelected()},onClick:function(){var b=_.first(a.getSelectedItems());b.actions.edit.onClick()}},{icon:"icon-remove-volume",tooltip:"action-tooltip-unprotect-volumes",type:"link",onClick:function(){o(a.getSelectedItems())},enabled:function(){return a.onlyOneSelected()&&!_.some(a.getSelectedItems(),function(a){return a.isUnprotected()})}},{icon:"icon-refresh",tooltip:"action-tooltip-restore-volumes",type:"link",onClick:function(){p("restore",a.getSelectedItems())},enabled:function(){return a.onlyOneSelected()&&!_.some(a.getSelectedItems(),function(a){return a.isUnprotected()})}}];a.getActions=function(){return b}},r=function(a){var b=[{icon:"icon-delete",type:"confirm",tooltip:"action-tooltip-delete",confirmTitle:"host-delete-confirmation",confirmMessage:"host-delete-selected-content",enabled:function(){return a.anySelected()},onClick:function(){_.forEach(a.getSelectedItems(),function(a){a.actions["delete"].onClick(d,!1)})}},{icon:"icon-edit",tooltip:"action-tooltip-edit",type:"link",enabled:function(){return a.onlyOneSelected()},onClick:function(){var b=_.first(a.getSelectedItems());b.actions.edit.onClick()}},{icon:"icon-attach-volume",tooltip:"action-tooltip-attach-volumes",type:"dropdown",enabled:function(){return a.anySelected()},items:[{type:"link",title:"Attach Existing Volume(s)",onClick:function(){i.push("selectedServers",a.getSelectedItems()),h.path("/hosts/attach-volumes")}},{type:"link",title:"Create and Attach Volume(s)",onClick:function(){i.push("selectedServers",a.getSelectedItems()),h.path("hosts/create-and-attach-volumes")}}]}];a.getActions=function(){return b}};j.getDpAlerts(function(c){var d=e.transformToDpSummaryModel();d.alerts.dp.count=c.total,d.alerts.dp.hostCount=c.totalHostAlertCount,d.alerts.dp.volumeCount=c.totalVolumeAlertCount;var h="error";0!==c.total&&(d.alerts.dp.level=h),d.title=f.translate("common-data-protection-monitoring"),j.getSummaryStatus(function(b){a.hardwareAlertTotals=b.hardwareAlertTotals,a.capacityAlertTotals=b.capacityAlertTotals,d.alerts.capacity.count=a.capacityAlertTotals.totalComponentWiseCapacityAlerts,d.alerts.hardware.count=a.hardwareAlertTotals.totalComponentWiseHardwareAlerts,0!==d.alerts.hardware.count&&"0"!==d.alerts.hardware.count&&(d.alerts.hardware.level=h),0!==d.alerts.capacity.count&&"0"!==d.alerts.capacity.count&&(d.alerts.capacity.level=h)}),d.interval=0;var i=[];i.push(m("Volumes",d.alerts.dp.volumeCount)),i.push(m("Servers",d.alerts.dp.hostCount)),d.slides=[{items:i}],a.summaryModel=d;var l=c.volumes,n=c.servers,o={volumes:l,servers:n,view:"list",allItemsSelected:!1,hasDelete:!0,search:{freeText:"",freeCapacity:{min:0,max:1e3,unit:"PB"},totalCapacity:{min:0,max:1e3,unit:"PB"},utilization:{min:0,max:100}},sort:{field:"volumeId",reverse:!1,setSort:function(c){b(function(){a.dataModel.sort.field===c?a.dataModel.sort.reverse=!a.dataModel.sort.reverse:(a.dataModel.sort.field=c,a.dataModel.sort.reverse=!1)})}},isDPMonitoring:!0,getSelectedVolumeCount:function(){var b=0;return _.forEach(a.dataModel.filteredList,function(a){a.selected===!0&&b++}),b},containUnprotectedVolume:function(){var b=!1;return _.forEach(a.dataModel.filteredList,function(a){return a.selected&&-1===a.dataProtectionSummary.volumeType.indexOf("P-VOL")?void(b=!0):void 0}),b},isVolumes:!0};q(o),k.setVolumesGridSettings(o,{canAdd:!1}),a.dataModel=o,g.setupDataLoader(a,l,"storageSystemVolumesSearch")}),a.volumesFilterModel={filterDpType:function(){var b=[];a.dataModel.snapshot&&b.push("SNAPSHOT"),a.dataModel.cloneNow&&b.push("CLONE"),a.dataModel.search.replicationTypes=b},filterProtectionStatus:function(){var b=[];a.dataModel["protected"]&&b.push("P-VOL"),a.dataModel.unprotected&&b.push("UNPROTECTED"),a.dataModel.secondary&&b.push("S-VOL"),a.dataModel.search.protectionStatusList=b}},a.hostsFilterModel={filterOperatingSystem:function(){var b=[],c=a.filterModel.operatingSystemType;for(var d in c)c[d]&&b.push(d);a.dataModel.search.osType=b},filterDpType:function(){var b=[];a.dataModel.snapshot&&b.push("SNAPSHOT"),a.dataModel.cloneNow&&b.push("CLONE"),a.dataModel.search.replicationTypes=b}},a.filterModel=a.volumesFilterModel}]),angular.module("rainierApp").controller("DiskManageCtrl",["$scope","$routeParams","$timeout","$window","orchestratorService","diskSizeService","$location","objectTransformService","paginationService",function(a,b,c,d,e,f,g,h,i){function j(b,c){var d={storageSystem:_.first(b),storageSystems:b,storageSystemSelectable:c,isHotSpare:null};return d.checkSubmitDisable=function(){var b=m(a.dataModel.disksList);return null===a.dataModel.search.purpose||0===b.length},d}function k(b){var c=b;a.dataModel.submitDisabled=!0;var d=[],e=[],g=[];_.forEach(c,function(a){if("FREE"===a.purpose||"SPARE"===a.purpose){var b={diskId:a.diskId,storageSystemId:a.storageSystemId,serialNumber:a.serialNumber,location:a.location,model:a.model,capacityInBytes:a.capacityInBytes,version:a.version,speed:a.speed,type:a.type,purpose:a.purpose,parityGroupId:a.parityGroupId,selected:!1,convertedDiskCapacity:f.getDisplaySize(a.capacityInBytes),speedOnly:f.getDisplaySpeedOnly(a.speed),speedUnitOnly:f.getDisplaySpeedUnitOnly(a.speed)};e.push(a.type),g.push(a.speed.toString()),d.push(b)}}),a.dataModel.types=e,a.dataModel.speeds=g,a.dataModel.disksList=d,a.dataModel.uniqueDiskTypes=_.sortBy(_.uniq(e)),a.dataModel.uniqueDiskSpeeds=_.sortBy(_.uniq(g))}function l(){"FREE"===a.dataModel.search.purpose?a.dataModel.isHotSpare="Yes":"SPARE"===a.dataModel.search.purpose&&(a.dataModel.isHotSpare="No");var b={hotSpare:a.dataModel.isHotSpare};return b}function m(a){var b=[];return _.forEach(a,function(a){a.selected===!0&&b.push(a.diskId)}),b}var n=b.storageSystemId;i.getAllPromises(null,"storage-systems",!0,null,h.transformStorageSystem).then(function(b){var c=b,d=_.isUndefined(n),e=_.find(c,function(a){return d||a.storageSystemId===n});a.dataModel=j(c,d),e&&(a.dataModel.selectedStorageSystemId=e.storageSystemId,i.getAllPromises(null,"disks",!0,e.storageSystemId,null).then(k)),a.dataModel.search={freeText:"",totalCapacity:{min:0,max:1e3,unit:"PB"},type:null,speed:null,purpose:null}}),a.initRaid=function(a){angular.forEach(a,function(a){return a.isDefault?0:void 0})},a.updateDiskPurpose=function(){var b=l();_.forEach(a.dataModel.disksList,function(c){c.selected===!0&&c.purpose===a.dataModel.search.purpose&&e.storageSystemDisksUpdate(a.dataModel.selectedStorageSystemId,c.diskId,b)}),g.path("storage-systems/"+a.dataModel.selectedStorageSystemId+"/parity-groups")}}]),angular.module("rainierApp").controller("EnterpriseVirtualServerCtrl",["$scope","$routeParams","$timeout","$filter","diskSizeService","fileSystemService","orchestratorService","objectTransformService","synchronousTranslateService","scrollDataSourceBuilderService","$location",function(a,b,c,d,e,f,g,h,i,j,k){function l(){var b=a.dataModel,c=[{icon:"icon-delete",tooltip:"action-tooltip-delete",type:"confirm",confirmTitle:"file-system-delete-confirmation",confirmMessage:"file-system-delete-selected-content",enabled:function(){return b.anySelected()},onClick:function(){_.forEach(b.getSelectedItems(),function(a){g.deleteFileSystem(o,a.id)})}},{icon:"icon-edit",tooltip:"action-tooltip-edit",type:"link",enabled:function(){return b.onlyOneSelected()},onClick:function(){k.path(["storage-systems",o,"file-systems",_.first(b.getSelectedItems()).id,"update"].join("/"))}},{icon:"icon-unmount",tooltip:"action-tooltip-unmount",type:"confirm",confirmTitle:"file-system-unmount-confirmation",confirmMessage:"file-system-unmount-selected-content",enabled:function(){return b.onlyOneSelected()&&"Not Mounted"!==_.first(b.getSelectedItems()).status},onClick:function(){var a={status:"unmount"};g.patchFileSystem(o,_.first(b.getSelectedItems()).id,a)}},{icon:"icon-mount",tooltip:"action-tooltip-mount",type:"confirmation-modal",dialogSettings:{id:"detachVolumeConfirmation",title:"file-system-mount-confirmation",content:"file-system-mount-selected-content",trueText:"file-systems-virtual-machine",falseText:"file-systems-database",switchEnabled:!1,requireSelection:!0},enabled:function(){return b.onlyOneSelected()&&"Mounted"!==_.first(b.getSelectedItems()).status?(0===_.first(b.getSelectedItems()).blockSize?($("#selection").show(),$("#selectionMessage").text(i.translate("file-system-mount-selected-content"))):($("#selection").hide(),$("#selectionMessage").text(i.translate("file-system-mount-content"))),!0):!1},confirmClick:function(){var a,c=32;this.dialogSettings.switchEnabled&&(c=4),a=0===_.first(b.getSelectedItems()).blockSize?{status:"mount",blockSize:c}:{status:"mount"},g.patchFileSystem(o,_.first(b.getSelectedItems()).id,a)}}];a.dataModel.getActions=function(){return c}}var m,n,o=b.storageSystemId,p=b.evsId;g.enterpriseVirtualServer(o,p).then(function(a){return m=a,g.evsFileSystems(o,p)}).then(function(b){n=b.fileSystems;var d={};d.storageSystemOnClick=function(){k.path(["storage-systems",o].join("/"))},a.summaryModel=d;var e=[];_.forEach(n,function(a){e.indexOf(a.evsId)<0&&e.push(a.evsId)});var f={file:!0,title:i.translate("virtual-file-server")+" "+m.name,titleTooltip:i.translate("evs-tooltip"),evsPage:!0,storageSystemId:o,view:"tile",allItemsSelected:!1,evs:m,numOfFileSystems:n.length,showRelatedResourcesHeader:!0,search:{freeText:"",freeCapacity:{min:0,max:1e3,unit:"PB"},totalCapacity:{min:0,max:1e3,unit:"PB"},fileServer:null},fileServer:e,actionTitle:i.translate("file-systems-add"),sort:{field:"usageBare",reverse:!0,setSort:function(b){c(function(){a.dataModel.sort.field===b?a.dataModel.sort.reverse=!a.dataModel.sort.reverse:(a.dataModel.sort.field=b,a.dataModel.sort.reverse=!1)})}}},h=[{icon:"icon-delete",tooltip:"action-tooltip-delete",type:"confirm",confirmTitle:"file-server-delete-confirmation",confirmMessage:"file-server-detail-delete-confirmation",enabled:function(){return!0},onClick:function(){g.deleteEvs(o,p)}},{icon:"icon-edit",tooltip:"action-tooltip-edit",type:"link",enabled:function(){return!0},onClick:function(){k.path(["storage-systems",o,"vfs",p,"update"].join("/"))}},{icon:"icon-lock",tooltip:"action-tooltip-disable",type:"confirm",confirmTitle:"file-server-disable-confirmation",confirmMessage:"file-server-disable-current-content",enabled:function(){return m.enabled},onClick:function(){var a={enabled:"false"};g.patchEvs(o,p,a)}},{icon:"icon-unlock",tooltip:"action-tooltip-enable",type:"confirm",confirmTitle:"file-server-enable-confirmation",confirmMessage:"file-server-enable-current-content",enabled:function(){return!m.enabled},onClick:function(){var a={enabled:"true"};g.patchEvs(o,p,a)}}];d.getActions=function(){return h},f.gridSettings=[{title:"Name",sizeClass:"sixth",sortField:"label",getDisplayValue:function(a){return a.label}},{title:"Status",sizeClass:"sixth",sortField:"status",getDisplayValue:function(a){return a.status}},{title:"file-pool-total",sizeClass:"twelfth",sortField:"capacityInBytes.value",getDisplayValue:function(a){return a.capacityInBytes},type:"size"},{title:"file-pool-free",sizeClass:"twelfth",sortField:"availableCapacityInBytes.value",getDisplayValue:function(a){return a.availableCapacityInBytes},type:"size"},{title:"common-file-used",sizeClass:"twelfth",sortField:"usedCapacityInBytes.value",getDisplayValue:function(a){return a.usedCapacityInBytes},type:"size"}],f.addAction=function(){k.path(["storage-systems",o,"vfs",p,"file-systems","add"].join("/"))},a.dataModel=f,j.setupDataLoader(a,n,"fileSystemsSearch"),l(),a.summaryModel=d})}]),angular.module("rainierApp").controller("EnterpriseVirtualServersCtrl",["$scope","$routeParams","$timeout","$filter","orchestratorService","objectTransformService","synchronousTranslateService","scrollDataSourceBuilderService","$location",function(a,b,c,d,e,f,g,h,i){var j=b.storageSystemId,k=null;k=j?e.enterpriseVirtualServers(j):e.allEnterpriseVirtualServers(),k.then(function(b){var d=b.evses,f={file:!0,title:g.translate("common-storage-system-file-servers"),titleTooltip:g.translate("evs-tooltip"),storageSystemId:j,view:"tile",allItemsSelected:!1,search:{freeText:"",isOnline:null,isEnabled:null,blade:null,filterStorageSystem:""},sort:{field:"id",reverse:!1,setSort:function(b){c(function(){a.dataModel.sort.field===b?a.dataModel.sort.reverse=!a.dataModel.sort.reverse:(a.dataModel.sort.field=b,a.dataModel.sort.reverse=!1)})}}},k=[{icon:"icon-delete",tooltip:"action-tooltip-delete",type:"confirm",confirmTitle:"file-server-delete-confirmation",confirmMessage:"file-server-delete-selected-content",enabled:function(){return f.anySelected()},onClick:function(){_.forEach(f.getSelectedItems(),function(a){e.deleteEvs(a.storageSystemId,a.uuid)})}},{icon:"icon-edit",tooltip:"action-tooltip-edit",type:"link",enabled:function(){return f.onlyOneSelected()},onClick:function(){i.path(["storage-systems",_.first(f.getSelectedItems()).storageSystemId,"vfs",_.first(f.getSelectedItems()).uuid,"update"].join("/"))}},{icon:"icon-lock",tooltip:"action-tooltip-disable",type:"confirm",confirmTitle:"file-server-disable-confirmation",confirmMessage:"file-server-disable-selected-content",enabled:function(){return f.onlyOneSelected()&&_.first(f.getSelectedItems()).enabled},onClick:function(){var a={enabled:"false"};e.patchEvs(_.first(f.getSelectedItems()).storageSystemId,_.first(f.getSelectedItems()).uuid,a)}},{icon:"icon-unlock",tooltip:"action-tooltip-enable",type:"confirm",confirmTitle:"file-server-enable-confirmation",confirmMessage:"file-server-enable-selected-content",enabled:function(){return f.onlyOneSelected()&&!_.first(f.getSelectedItems()).enabled},onClick:function(){var a={enabled:"true"};e.patchEvs(_.first(f.getSelectedItems()).storageSystemId,_.first(f.getSelectedItems()).uuid,a)}}];if(f.getActions=function(){return k},f.gridSettings=[{title:"Status",sizeClass:"twelfth",sortField:"isOnline",getDisplayValue:function(a){return a.isOnline?"Online":"Offline"}},{title:"Enabled",sizeClass:"twelfth",sortField:"isEnabled",getDisplayValue:function(a){return a.isEnabled}},{title:"Blade",sizeClass:"twelfth",sortField:"clusterNodeId",getDisplayValue:function(a){return a.clusterNodeId}},{title:"Name",sizeClass:"sixth",sortField:"name",getDisplayValue:function(a){return a.name}},{title:"IP Address",sizeClass:"sixth",sortField:"interfaceAddresses[0].ip",getDisplayValue:function(a){return _.first(a.interfaceAddresses).ip}}],f.addAction=function(){j?i.path(["storage-systems",j,"vfs","add"].join("/")):i.path(["vfs","add"].join("/"))},!j){var l=[];_.each(d,function(a){l.push(a.storageSystemId)}),f.storageSystemIds=_.uniq(l)}a.dataModel=f,h.setupDataLoader(a,d,"evsSearch")})}]),angular.module("rainierApp").controller("EvsAddCtrl",["$scope","$routeParams","orchestratorService","fileSystemService","$timeout","subnetMaskService","paginationService","objectTransformService",function(a,b,c,d,e,f,g,h){function i(b){b>0&&129>b&&(a.dataModel.validRange=!0)}var j,k,l,m=b.storageSystemId,n="storage-systems",o=/^((([01]?[0-9]{1,2})|(2[0-4][0-9])|(25[0-5]))[.]){3}(([0-1]?[0-9]{1,2})|(2[0-4][0-9])|(25[0-5]))$/,p=/(^\s*((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?))\s*$)|(^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$)/;g.getAllPromises(null,n,!0,null,h.transformStorageSystem).then(function(b){function d(){a.dataModel.showDropDownColumn=!0}l=_.reject(b,function(a){return!a.accessible||!a.unified}),j=_.isUndefined(m),j&&(m=_.first(l).storageSystemId),k=_.find(l,function(a){return a.storageSystemId===m});var g={validationForm:{label:"",ipAddress:"",subnetMask:"",port:"",storageSystemId:m},validIp:!0,validPort:!0,subnetMasks:f.getSubnetMasks(),storageSystems:l,storageSystem:k,storageSystemSelectable:j,storageSystemId:m,payload:{name:"",ipAddress:"",storageSystemId:"",subnetMask:"",port:"",ipv6:""}};a.dataModel=g,a.$watch("dataModel.payload.ipAddress",function(){var b=a.dataModel.payload.ipAddress.split("/");a.dataModel.validRange=!0,a.dataModel.validIp=!0,o.test(a.dataModel.payload.ipAddress)?a.dataModel.payload.ipv6=!1:p.test(_.first(b))&&!o.test(_.first(b))?(a.dataModel.payload.ipv6=!0,a.dataModel.payload.subnetMask="",a.dataModel.validRange=!1,2===b.length&&i(_.last(b))):a.dataModel.validIp=!1}),a.$watch("dataModel.storageSystem",function(){a.dataModel.showDropDownColumn=!1,e(d,500),c.ethernetInterfaces(a.dataModel.storageSystem.storageSystemId).then(function(b){a.dataModel.ports=_.map(_.reject(b.ethernetInterfaceResourceList,function(a){return 0!==a.name.indexOf("ag")}),function(a){return a.name}),a.dataModel.port=""})}),a.dataModel.canSubmit=function(){return a.dataModel.validationForm.label.$valid&&a.dataModel.validationForm.ipAddress.$valid&&(a.dataModel.payload.subnetMask||a.dataModel.payload.ipv6)&&a.dataModel.payload.port&&a.dataModel.storageSystem},a.dataModel.submit=function(){a.dataModel.payload.storageSystemId=a.dataModel.storageSystem.storageSystemId,c.addEvs(a.dataModel.payload).then(function(){window.history.back()})}})}]),angular.module("rainierApp").controller("EvsUpdateCtrl",["$scope","$routeParams","orchestratorService","fileSystemService","paginationService","objectTransformService",function(a,b,c,d,e,f){var g,h=b.storageSystemId,i="storage-systems",j=b.evsId;e.getAllPromises(null,i,!0,null,f.transformStorageSystem).then(function(a){return g=a,c.enterpriseVirtualServer(h,j)}).then(function(b){var e=_.isUndefined(h),f=_.find(g,function(a){return e||a.storageSystemId===h}),i={validationForm:{label:""},ports:d.getVirtualFileServerPorts(),storageSystems:g,storageSystem:f,payload:{name:b.name,ipAddress:_.first(b.interfaceAddresses).ip,storageSystemId:b.storageSystemId,subnetMask:_.first(b.interfaceAddresses).mask,port:_.first(b.interfaceAddresses).port}};a.dataModel=i,a.dataModel.canSubmit=function(){return a.dataModel.validationForm.label.$valid&&a.dataModel.validationForm.label.$dirty},a.dataModel.submit=function(){c.patchEvs(h,j,{evsName:a.dataModel.payload.name}).then(function(){window.history.back()})}})}]),angular.module("rainierApp").controller("ExportCtrl",["$scope","$routeParams","$timeout","$filter","diskSizeService","fileSystemService","orchestratorService","objectTransformService","synchronousTranslateService","scrollDataSourceBuilderService","$location",function(a,b,c,d,e,f,g,h,i,j,k){function l(){g.enterpriseVirtualServer(n,m.evsUuid).then(function(b){var c={},d={title:i.translate("export")+" "+p,storageSystemId:n,view:"tile","export":m,singleView:!0,onlyOperation:!0,evsIp:_.first(b.interfaceAddresses).ip},e=[{icon:"icon-delete",tooltip:"action-tooltip-delete",type:"confirm",confirmTitle:"export-delete-confirmation",confirmMessage:"export-delete-selected-content",enabled:function(){return!0},onClick:function(){g.deleteExport(n,o,p)}},{icon:"icon-edit",tooltip:"action-tooltip-edit",type:"link",enabled:function(){return!0},onClick:function(){k.path(["storage-systems",n,"file-systems",o,"exports",p,"update"].join("/"))}}];c.getActions=function(){return e},d.gridSettings=[{title:"ID",sizeClass:"twelfth",sortField:"id",getDisplayValue:function(a){return a.id},type:"id"},{title:"Name",sizeClass:"sixth",sortField:"label",getDisplayValue:function(a){return a.label}}],a.dataModel=d,a.summaryModel=c})}var m,n=b.storageSystemId,o=b.fileSystemId,p=b.exportId;g["export"](n,o,p).then(function(a){m=a,l()},function(){g.allExports(n).then(function(a){m=_.find(a.shares,function(a){return a.fileSystemId===o&&a.id===p}),l()})})}]),angular.module("rainierApp").controller("ExportsUpdateCtrl",["$scope","$routeParams","orchestratorService",function(a,b,c){var d=b.storageSystemId,e=b.fileSystemId,f=b.exportId;c["export"](d,e,f).then(function(b){var g={validationForm:{fileSystemPath:"",accessConfiguration:""},label:b.name,storageSystemId:d,fileSystemId:e,payload:{fileSystemPath:b.fileSystemPath,accessConfiguration:b.accessConfiguration}};a.dataModel=g,a.dataModel.canSubmit=function(){return(a.dataModel.validationForm.label.$dirty||a.dataModel.validationForm.fileSystemPath.$dirty||a.dataModel.validationForm.accessConfiguration.$dirty)&&a.dataModel.validationForm.label.$valid&&a.dataModel.validationForm.fileSystemPath.$valid&&a.dataModel.validationForm.accessConfiguration.$valid},a.dataModel.submit=function(){c.patchExport(d,e,f,a.dataModel.payload).then(function(){window.history.back()})}})}]),angular.module("rainierApp").controller("ExternalParityGroupsCtrl",["$scope","$routeParams","$timeout","orchestratorService","synchronousTranslateService","scrollDataSourceBuilderServiceNew","objectTransformService","queryService","paginationService",function(a,b,c,d,e,f,g,h,i){var j=b.storageSystemId,k=e.translate("common-external-parity-groups"),l="external-parity-groups";d.storageSystem(j).then(function(b){a.storageSystemModel=b.model}),i.get(null,l,g.transformExternalParityGroup,!0,j).then(function(b){var d={storageSystemId:j,title:k,view:"tile",parityGroups:b.resources,onlyOperation:!0,sort:{field:"externalParityGroupId",reverse:!1,setSort:function(b){c(function(){a.dataModel.sort.field===b?(h.setSort(b,!a.dataModel.sort.reverse),a.dataModel.sort.reverse=!a.dataModel.sort.reverse):(a.dataModel.sort.field=b,h.setSort(b,!1),a.dataModel.sort.reverse=!1),i.getQuery(l,g.transformExternalParityGroup,j).then(function(a){e(a)})})}},getSelectedExternalParityGroupCount:function(){var b=0;return _.forEach(a.dataModel.filteredList,function(a){a.selected===!0&&b++}),b}},e=function(b){a.dataModel.nextToken=b.nextToken,a.dataModel.displayList=b.resources,a.dataModel.itemCounts={filtered:a.dataModel.displayList.length,total:a.dataModel.total}};a.filterModel={filter:{freeText:"",totalCapacity:{min:0,max:1e3,unit:"PB"}},filterQuery:function(a,b,c,d){var f=new i.QueryObject(a,c,b,d);i.setFilterSearch(f),i.getQuery(l,g.transformExternalParityGroup,j).then(function(a){e(a)})},sliderQuery:function(a,b,c,d){i.setSliderSearch(a,b,c,d),i.getQuery(l,g.transformExternalParityGroup,j).then(function(a){e(a)})},searchQuery:function(a){var b=[];b.push(new i.QueryObject("externalParityGroupId",(new i.SearchType).STRING,a)),i.setTextSearch(b),i.getQuery(l,g.transformExternalParityGroup,j).then(function(a){e(a)})}},d.getResources=function(){return i.get(a.dataModel.nextToken,l,g.transformExternalParityGroup,!1,j)},d.displayList=b.resources,d.getActions=function(){return[]},d.gridSettings=[{title:"external-parity-group-id",sizeClass:"twelfth",sortField:"externalParityGroupId",getDisplayValue:function(a){return a.externalParityGroupId},type:"id"},{title:"external-parity-group-storage",sizeClass:"twelfth",sortField:"externalStorageSystemId",getDisplayValue:function(a){return a.externalStorageSystemId}},{title:"external-parity-group-vendor",sizeClass:"twelfth",sortField:"externalStorageVendor",getDisplayValue:function(a){return a.externalStorageVendor}},{title:"external-parity-group-model",sizeClass:"twelfth",sortField:"externalStorageProduct",getDisplayValue:function(a){return a.externalStorageProduct}},{title:"common-label-total",sizeClass:"twelfth",sortField:"item.capacity",getDisplayValue:function(a){return a.total},type:"size"},{title:"common-label-free",sizeClass:"twelfth",sortField:"availableCapacity",getDisplayValue:function(a){return a.free},type:"size"},{title:"common-label-used",sizeClass:"twelfth",sortField:"usedCapacity",getDisplayValue:function(a){return a.used},type:"size"}],a.dataModel=d,f.setupDataLoader(a,b.resources,"externalParityGroupsSearch")})}]),angular.module("rainierApp").controller("FabricSwitchAddCtrl",["$scope","$routeParams","$timeout","$window","$filter","orchestratorService",function(a,b,c,d,e,f){function g(a){for(var b={fabrics:[]},c=1;c<a.length;++c)b.fabrics.push({virtualFabricId:a[c].virtualFabricId,principalSwitchAddress:a[c].principalSwitchAddress,principalSwitchUsername:a[c].principalSwitchUsername,principalSwitchPassword:a[c].principalSwitchPassword,principalSwitchPortNumber:parseInt(a[c].principalSwitchPortNumber),
switchType:a[c].switchType});return b}var h=f.switchTypes(),i=f.defaultPrincipalSwitchPortNumber(),j={fabricSwitches:[],switchTypes:h,add:function(){var a=this,b={virtualFabricId:"",principalSwitchAddress:"",switchType:"",principalSwitchPortNumber:i,principalSwitchUsername:"",principalSwitchPassword:""};b.isValid=function(){return _.every([b.principalSwitchAddress,b.switchType,b.principalSwitchPortNumber,b.principalSwitchUsername,b.principalSwitchPassword],function(a){return!_.isEmpty(a)})},b.click=function(a){a?j.add():b["delete"]()},b["delete"]=function(){c(function(){_.remove(a.fabricSwitches,function(a){return a===b})})},a.fabricSwitches.splice(0,0,b)}};j.add(),j.canSubmit=function(){var a,b=j.fabricSwitches.length;if(1>=b)return!1;for(a=1;a<j.fabricSwitches.length;++a){var c=j.fabricSwitches[a];if(!c.isValid())return!1}return!0},j.submit=function(){var a=g(j.fabricSwitches);f.addFabrics(a).then(function(){window.history.back()})},a.dataModel=j}]),angular.module("rainierApp").controller("FabricUpdateCtrl",["$scope","orchestratorService","ShareDataService",function(a,b,c){function d(){var b={};return b.virtualFabricId=a.dataModel.updatedVirtualFabricId,b.principalSwitchAddress=a.dataModel.updatedPrincipalSwitchAddress,b.principalSwitchUsername=a.dataModel.updatedPrincipalSwitchUsername,b.principalSwitchPassword=a.dataModel.updatedPrincipalSwitchPassword,b.principalSwitchPortNumber=parseInt(a.dataModel.updatedPrincipalSwitchPortNumber),b}var e=c.editFabricSwitch;a.dataModel={updatedSanFabricId:e.sanFabricId,updatedVirtualFabricId:e.virtualFabricId,updatedPrincipalSwitchAddress:e.principalSwitchAddress,updatedSwitchType:e.switchType,updatedPrincipalSwitchPortNumber:e.principalSwitchPortNumber.toString(),updatedPrincipalSwitchUsername:e.principalSwitchUsername,updatedPrincipalSwitchPassword:"",isValid:function(){return!(_.isEmpty(this.updatedPrincipalSwitchAddress)||_.isEmpty(this.updatedPrincipalSwitchPortNumber)||_.isEmpty(this.updatedPrincipalSwitchUsername)||_.isEmpty(this.updatedPrincipalSwitchPassword))}},a.updateFabricSwitch=function(){b.updateFabric(e.sanFabricId,d()),window.history.back()}}]),angular.module("rainierApp").controller("FabricSwitchesCtrl",["$scope","$timeout","$window","orchestratorService","objectTransformService","synchronousTranslateService","scrollDataSourceBuilderService","ShareDataService",function(a,b,c,d,e,f,g,h){function i(d){var e=d.fabrics?d.fabrics:[];a.dataModel={title:"Fabric Switches",view:"tile",search:{freeText:"",switchType:""},sort:{field:"sanFabricId",reverse:!1,setSort:function(c){b(function(){a.dataModel.sort.field===c?a.dataModel.sort.reverse=!a.dataModel.sort.reverse:(a.dataModel.sort.field=c,a.dataModel.sort.reverse=!1)})}},gridSettings:[{title:f.translate("fabric-tile-san-fabric-id"),sizeClass:"sixth",sortField:"sanFabricId",getDisplayValue:function(a){return a.sanFabricId}},{title:f.translate("fabric-tile-virtual-fabric-id"),sizeClass:"sixth",sortField:"virtualFabricIdDisplay",getDisplayValue:function(a){return a.virtualFabricIdDisplay}},{title:f.translate("fabric-tile-switch-type"),sizeClass:"sixth",sortField:"switchType",getDisplayValue:function(a){return a.switchType}},{title:f.translate("fabric-tile-switch-ip"),sizeClass:"sixth",sortField:"principalSwitchAddress",getDisplayValue:function(a){return a.principalSwitchAddress}},{title:f.translate("fabric-tile-switch-username"),sizeClass:"twelfth",sortField:"principalSwitchUsername",getDisplayValue:function(a){return a.principalSwitchUsername}}]};var h=[{icon:"icon-edit",tooltip:"action-tooltip-edit",type:"link",enabled:function(){return a.dataModel.onlyOneSelected()},onClick:function(){a.editSelected()}},{icon:"icon-delete",tooltip:"action-tooltip-delete",type:"confirm",confirmTitle:"fabric-switch-delete-confirmation",confirmMessage:"fabric-switch-delete-selected-content",enabled:function(){return a.dataModel.anySelected()},onClick:function(){a.deleteSelectedConfirmOk()}}];a.dataModel.getActions=function(){return h},a.dataModel.addAction=function(){c.location.href="#/fabric-switches/add"},g.setupDataLoader(a,e,"fabricSwitchSearch")}function j(){var b=0,c=a.dataModel.getSelectedItems().length;_.forEach(a.dataModel.getSelectedItems(),function(a){++b,b===c?k(a):d.deleteFabric(a.sanFabricId)})}function k(a){d.deleteFabric(a.sanFabricId).then(function(){d.fabrics().then(function(a){i(a)})})}d.fabrics().then(function(a){i(a)}),a.deleteSelectedConfirmOk=function(){j()},a.editSelected=function(){for(var b,d=0;d<a.dataModel.filteredList.length;++d)b=a.dataModel.filteredList[d],b.selected&&(h.editFabricSwitch=a.dataModel.filteredList[d],c.location.href="#/fabric-switches/"+a.dataModel.filteredList[d].sanFabricId+"/update")}}]),angular.module("rainierApp").controller("FilePoolCtrl",["$scope","$routeParams","$timeout","$filter","diskSizeService","fileSystemService","orchestratorService","objectTransformService","synchronousTranslateService","scrollDataSourceBuilderService","$location",function(a,b,c,d,e,f,g,h,i,j,k){function l(){var b=a.dataModel,c=[{icon:"icon-delete",tooltip:"action-tooltip-delete",type:"confirm",confirmTitle:"file-system-delete-confirmation",confirmMessage:"file-system-delete-selected-content",enabled:function(){return b.anySelected()},onClick:function(){_.forEach(b.getSelectedItems(),function(a){g.deleteFileSystem(p,a.id)})}},{icon:"icon-edit",tooltip:"action-tooltip-edit",type:"link",enabled:function(){return b.onlyOneSelected()},onClick:function(){b.onlyOneSelected()&&k.path(["storage-systems",p,"file-systems",_.first(b.getSelectedItems()).id,"update"].join("/"))}},{icon:"icon-unmount",tooltip:"action-tooltip-unmount",type:"confirm",confirmTitle:"file-system-unmount-confirmation",confirmMessage:"file-system-unmount-selected-content",enabled:function(){return b.onlyOneSelected()&&"Not Mounted"!==_.first(b.getSelectedItems()).status},onClick:function(){if(b.onlyOneSelected()&&"Not Mounted"!==_.first(b.getSelectedItems()).status){var a={status:"unmount"};g.patchFileSystem(p,_.first(b.getSelectedItems()).id,a)}}},{icon:"icon-mount",tooltip:"action-tooltip-mount",type:"confirmation-modal",dialogSettings:{id:"detachVolumeConfirmation",title:"file-system-mount-confirmation",content:"file-system-mount-selected-content",trueText:"file-systems-virtual-machine",falseText:"file-systems-database",switchEnabled:!1,requireSelection:!0},enabled:function(){return b.onlyOneSelected()&&"Mounted"!==_.first(b.getSelectedItems()).status?(0===_.first(b.getSelectedItems()).blockSize?($("#selection").show(),$("#selectionMessage").text(i.translate("file-system-mount-selected-content"))):($("#selection").hide(),$("#selectionMessage").text(i.translate("file-system-mount-content"))),!0):!1},confirmClick:function(){var a,c=32;this.dialogSettings.switchEnabled&&(c=4),a=0===_.first(b.getSelectedItems()).blockSize?{status:"mount",blockSize:c}:{status:"mount"},g.patchFileSystem(p,_.first(b.getSelectedItems()).id,a)}}];a.dataModel.getActions=function(){return c}}var m,n,o,p=b.storageSystemId,q=b.filePoolId;g.enterpriseVirtualServers(p).then(function(a){return o=a.evses,g.filePool(p,q)}).then(function(a){return a.bottomLegend=!0,m=a,g.filePoolFileSystems(p,q)}).then(function(b){n=b.fileSystems;var d={};d.title=i.translate("common-storage-systems"),d.noBreakdown=!0,a.summaryModel=d,m.orchestratorService=g;var e=[];_.forEach(n,function(a){if(!_.find(e,function(b){return b.id===a.evsId})){var b=_.first(_.where(o,{id:a.evsId}));b&&e.push(b)}});var f={file:!0,title:i.translate("file-pool")+" "+m.label,titleTooltip:i.translate("file-pools-tooltip"),storageSystemId:p,view:"tile",allItemsSelected:!1,showRelatedResourcesHeader:!0,filePool:m,numOfFileSystems:n.length,search:{freeText:"",freeCapacity:{min:0,max:1e3,unit:"PB"},totalCapacity:{min:0,max:1e3,unit:"PB"},fileServer:null},actionTitle:i.translate("file-systems-add"),fileServer:e,sort:{field:"usageBare",reverse:!0,setSort:function(b){c(function(){a.dataModel.sort.field===b?a.dataModel.sort.reverse=!a.dataModel.sort.reverse:(a.dataModel.sort.field=b,a.dataModel.sort.reverse=!1)})}}},r=[{icon:"icon-delete",tooltip:"action-tooltip-delete",type:"confirm",confirmTitle:"file-pool-delete-confirmation",confirmMessage:"file-pool-detail-delete-confirmation",enabled:function(){return!0},onClick:function(){g.deleteFilePool(p,q)}},{icon:"icon-expand",tooltip:"action-tooltip-expand",type:"link",enabled:function(){return!0},onClick:function(){k.path(["storage-systems",p,"file-pools",q,"expand"].join("/"))}}];d.getActions=function(){return r},f.gridSettings=[{title:"Name",sizeClass:"sixth",sortField:"label",getDisplayValue:function(a){return a.label}},{title:"Status",sizeClass:"sixth",sortField:"status",getDisplayValue:function(a){return a.status}},{title:"file-pool-total",sizeClass:"twelfth",sortField:"capacityInBytes.value",getDisplayValue:function(a){return a.capacityInBytes},type:"size"},{title:"file-pool-free",sizeClass:"twelfth",sortField:"availableCapacityInBytes.value",getDisplayValue:function(a){return a.availableCapacityInBytes},type:"size"},{title:"common-file-used",sizeClass:"twelfth",sortField:"usedCapacityInBytes.value",getDisplayValue:function(a){return a.usedCapacityInBytes},type:"size"}],f.addAction=function(){k.path(["storage-systems",p,"file-pools",q,"file-systems","add"].join("/"))},h.transformFilePoolSummaryModel(f.filePool),a.dataModel=f,j.setupDataLoader(a,n,"fileSystemsSearch"),l(),a.summaryModel=d})}]),angular.module("rainierApp").controller("FilePoolsAddCtrl",["$scope","$routeParams","fileSystemService","$location","$timeout","$window","$filter","orchestratorService","objectTransformService","filePoolService","diskSizeService","synchronousTranslateService",function(a,b,c,d,e,f,g,h,i,j,k,l){var m,n=b.storageSystemId;a.diskTypeSpeedToTier={},h.filePoolTemplate(n).then(function(b){var c={validationForm:{label:""},tierManagement:function(){d.path("/tier-management")}};a.dataModel=c;var e={};a.tierKeys=_.pluck(b.tiers,"name"),_.forEach(b.tiers,function(a){_.forEach(a.templateSubTiers,function(b){e[b.diskType+" "+k.getDisplaySpeed(b.speed)]=a.tier})}),a.diskTypeSpeedToTier=e,a.dataModel.template=b,a.dataModel.selectedStorageSystem=n,a.dataModel.subscriptionLimit=b.overCommitRatio+"%",a.dataModel.max=10,a.dataModel.min=1,a.dataModel.iops=0,a.dataModel.warning=l.translate("file-pool-raid-warning"),a.dataModel.submit=function(){var b=[],c=a.dataModel;a.dataModel.selectedCapacity&&b.push({capacity:c.selectedCapacity.capacity.value.toString(),diskType:c.selectedCapacity.diskType,raidLevel:c.selectedCapacity.raidLevel,raidLayout:c.selectedCapacity.raidLayout,speed:c.selectedCapacity.speed,sizeToUse:c.selectedCapacity.requestedCapacity.value.toString(),name:c.selectedCapacity.name}),a.dataModel.selectedPlatinumCapacity&&b.push({capacity:c.selectedPlatinumCapacity.capacity.value.toString(),diskType:c.selectedPlatinumCapacity.diskType,raidLevel:c.selectedPlatinumCapacity.raidLevel,raidLayout:c.selectedPlatinumCapacity.raidLayout,speed:c.selectedPlatinumCapacity.speed,sizeToUse:c.selectedPlatinumCapacity.requestedCapacity.value.toString(),name:c.selectedPlatinumCapacity.name});var d={label:a.dataModel.label,templateTiers:b,utilizationThreshold1:a.dataModel.template.utilizationThreshold1,utilizationThreshold2:a.dataModel.template.utilizationThreshold2};h.createFilePool(n,d).then(function(){window.history.back()})},a.dataModel.canSubmit=function(){return a.dataModel.validationForm.label.$valid&&a.dataModel.selectedCapacity||a.dataModel.selectedPlatinumCapacity},a.$watch("dataModel.template",function(b){j.watchTemplateTypeWizard(a.dataModel,b,k),m=_.first(a.dataModel.diskSizesByTier).name}),a.$watch("dataModel.poolTiered",function(){j.uncheckSelection(a.dataModel)}),a.$watchGroup(["dataModel.selectedCapacity","dataModel.selectedPlatinumCapacity"],function(c){var d=i.transformCreateTieredFilePoolCapacitySummaryModel(c,b.overCommitRatio);d.noBreakdown=!0,a.dataModel.keyAndColors=j.getKeyAndColors(_.first(d.arrayDataVisualizationModel.items)),a.dataModel.summaryModel=d,a.dataModel.iops=j.calculateIops(c,a.dataModel.template.overCommitRatio,m)},!0)})}]),angular.module("rainierApp").controller("FilePoolsExpandCtrl",["$scope","$routeParams","fileSystemService","$location","$timeout","$window","$filter","orchestratorService","objectTransformService","filePoolService","diskSizeService",function(a,b,c,d,e,f,g,h,i,j,k){var l=b.storageSystemId,m=b.filePoolId;a.diskTypeSpeedToTier={},h.filePoolExpandTemplate(l,m).then(function(b){var c={validationForm:{label:""},tierManagement:function(){d.path("/tier-management")},expand:!0};a.dataModel=c;var e={};a.tierKeys=_.pluck(b.tiers,"name"),_.forEach(b.tiers,function(a){_.forEach(a.templateSubTiers,function(b){e[b.diskType+" "+k.getDisplaySpeed(b.speed)]=a.tier})}),a.diskTypeSpeedToTier=e,a.dataModel.template=b,a.dataModel.selectedStorageSystem=l,a.dataModel.max=10,a.dataModel.min=1,a.dataModel.label=b.label,a.dataModel.submit=function(){var b=[],c=a.dataModel;a.dataModel.selectedCapacity&&b.push({capacity:c.selectedCapacity.capacity.value.toString(),diskType:c.selectedCapacity.diskType,raidLevel:c.selectedCapacity.raidLevel,raidLayout:c.selectedCapacity.raidLayout,speed:c.selectedCapacity.speed,sizeToUse:c.selectedCapacity.requestedCapacity.value.toString(),name:c.selectedCapacity.name}),a.dataModel.selectedPlatinumCapacity&&b.push({capacity:c.selectedPlatinumCapacity.capacity.value.toString(),diskType:c.selectedPlatinumCapacity.diskType,raidLevel:c.selectedPlatinumCapacity.raidLevel,raidLayout:c.selectedPlatinumCapacity.raidLayout,speed:c.selectedPlatinumCapacity.speed,sizeToUse:c.selectedPlatinumCapacity.requestedCapacity.value.toString(),name:c.selectedPlatinumCapacity.name});var d={label:a.dataModel.label,templateTiers:b,utilizationThreshold1:a.dataModel.template.utilizationThreshold1,utilizationThreshold2:a.dataModel.template.utilizationThreshold2};h.expandFilePool(l,m,d).then(function(){window.history.back()})},a.dataModel.canSubmit=function(){return a.dataModel.validationForm.label.$valid&&a.dataModel.validationForm.label.$dirty||a.dataModel.selectedCapacity||a.dataModel.selectedPlatinumCapacity},a.$watch("dataModel.template",function(b){j.watchTemplateTypeWizard(a.dataModel,b,k)}),a.$watch("dataModel.poolTiered",function(){j.uncheckSelection(a.dataModel)}),a.$watchGroup(["dataModel.selectedCapacity","dataModel.selectedPlatinumCapacity"],function(c){var d=i.transformCreateTieredFilePoolCapacitySummaryModel(c,b.overCommitRatio);d.noBreakdown=!0,a.dataModel.keyAndColors=j.getKeyAndColors(_.first(d.arrayDataVisualizationModel.items)),a.dataModel.summaryModel=d},!0)})}]),angular.module("rainierApp").controller("FilePoolsCtrl",["$scope","$routeParams","$timeout","$filter","orchestratorService","objectTransformService","synchronousTranslateService","scrollDataSourceBuilderService","$location",function(a,b,c,d,e,f,g,h,i){var j,k=b.storageSystemId;e.filePoolSummary(k).then(function(a){return j=a,e.filePools(k)}).then(function(b){var d=b.filePools,l={file:!0,title:g.translate("common-storage-system-file-pools"),titleTooltip:g.translate("file-pools-tooltip"),storageSystemId:k,view:"tile",allItemsSelected:!1,filePoolSummary:j,search:{freeText:"",freeCapacity:{min:0,max:1e3,unit:"PB"},totalCapacity:{min:0,max:1e3,unit:"PB"},healthy:null},filePools:d,sort:{field:"usageBare",reverse:!0,setSort:function(b){c(function(){a.dataModel.sort.field===b?a.dataModel.sort.reverse=!a.dataModel.sort.reverse:(a.dataModel.sort.field=b,a.dataModel.sort.reverse=!1)})}}};f.transformFilePoolsSummaryModel(l),l.gridSettings=[{title:"Name",sizeClass:"sixth",sortField:"label",getDisplayValue:function(a){return a.label}},{title:"Tiered",sizeClass:"twelfth",sortField:"tiered",getDisplayValue:function(a){return g.translate(a.tiered?"tiered":"untiered")}},{title:"file-pool-total",sizeClass:"twelfth",sortField:"capacityInBytes.value",getDisplayValue:function(a){return a.capacityInBytes},type:"size"},{title:"file-pool-free",sizeClass:"twelfth",sortField:"availableCapacityInBytes.value",getDisplayValue:function(a){return a.availableCapacityInBytes},type:"size"},{title:"common-file-used",sizeClass:"twelfth",sortField:"usedCapacityInBytes.value",getDisplayValue:function(a){return a.usedCapacityInBytes},type:"size"}];var m=[{icon:"icon-delete",tooltip:"action-tooltip-delete",type:"confirm",confirmTitle:"file-pool-delete-confirmation",confirmMessage:"file-pool-delete-selected-content",enabled:function(){return l.anySelected()},onClick:function(){_.forEach(l.getSelectedItems(),function(a){e.deleteFilePool(k,a.id)})}},{icon:"icon-expand",tooltip:"action-tooltip-expand",type:"link",enabled:function(){return l.onlyOneSelected()},onClick:function(){l.onlyOneSelected()&&i.path(["storage-systems",k,"file-pools",_.first(l.getSelectedItems()).id,"expand"].join("/"))}}];l.getActions=function(){return m},l.addAction=function(){i.path(["storage-systems",k,"file-pools","add"].join("/"))},a.dataModel=l,h.setupDataLoader(a,d,"filePoolSearch")})}]),angular.module("rainierApp").controller("FileSystemCtrl",["$scope","$routeParams","$timeout","$filter","diskSizeService","fileSystemService","orchestratorService","objectTransformService","synchronousTranslateService","scrollDataSourceBuilderService","$location",function(a,b,c,d,e,f,g,h,i,j,k){function l(){var b=[{icon:"icon-delete",tooltip:"action-tooltip-delete",type:"confirm",confirmTitle:"shares-exports-delete-confirmation",confirmMessage:"shares-exports-delete-selected-content",enabled:function(){return a.dataModel.anySelected()},onClick:function(){_.forEach(a.dataModel.getSelectedItems(),function(a){"Share"===a.type?g.deleteShare(r,s,a.id):g.deleteExport(r,s,a.id)})}},{icon:"icon-edit",tooltip:"action-tooltip-edit",type:"link",enabled:function(){return a.dataModel.onlyOneSelected()},onClick:function(){if(a.dataModel.onlyOneSelected()){var b=_.first(a.dataModel.getSelectedItems());k.path(["storage-systems",r,"file-systems",b.fileSystemId,b.urlType,b.id,"update"].join("/"))}}}];a.dataModel.getActions=function(){return b}}var m,n,o,p,q,r=b.storageSystemId,s=b.fileSystemId;g.exports(r,s).then(function(a){return n=a.exports,g.shares(r,s)}).then(function(a){return o=a.shares,g.fileSystem(r,s)}).then(function(a){return a.bottomLegend=!0,p=a,g.filePool(r,a.filePoolId)}).then(function(a){return m=a,g.enterpriseVirtualServers(r)}).then(function(b){q=_.find(b.evses,function(a){return a.id===p.evsId});var d={},e=0,f=0;d.title=i.translate("common-storage-systems"),d.noBreakdown=!0,d.filePoolOnClick=function(){k.path(["storage-systems",r,"file-pools",m.id].join("/"))},a.summaryModel=d,o?e=o.length:o=[],n?f=n.length:n=[];var h={file:!0,title:i.translate("common-storage-system-file-system")+" "+p.label,storageSystemId:r,view:"tile",allItemsSelected:!1,showRelatedResourcesHeader:!0,windows:e,linux:f,search:{type:null},fileSystem:p,filePool:m,format:p.blockSizeDisplay,expansionLimit:p.expansionLimitInBytes,actionTitle:i.translate("shares-exports-add"),fileServer:q,fileServerIp:_.first(q.interfaceAddresses).ip,sort:{field:"usageBare",reverse:!0,setSort:function(b){c(function(){a.dataModel.sort.field===b?a.dataModel.sort.reverse=!a.dataModel.sort.reverse:(a.dataModel.sort.field=b,a.dataModel.sort.reverse=!1)})}}},t=[{icon:"icon-delete",tooltip:"action-tooltip-delete",type:"confirm",confirmTitle:"file-system-delete-confirmation",confirmMessage:"file-system-delete-selected-content",enabled:function(){return!0},onClick:function(){g.deleteFileSystem(r,s)}},{icon:"icon-edit",tooltip:"action-tooltip-edit",type:"link",enabled:function(){return!0},onClick:function(){k.path(["storage-systems",r,"file-systems",s,"update"].join("/"))}},{icon:"icon-unmount",tooltip:"action-tooltip-unmount",type:"confirm",confirmTitle:"file-system-unmount-confirmation",confirmMessage:"file-system-unmount-selected-content",enabled:function(){return"Mounted"===a.dataModel.fileSystem.status},onClick:function(){var a={status:"unmount"};g.patchFileSystem(r,s,a)}},{icon:"icon-mount",tooltip:"action-tooltip-mount",type:"confirmation-modal",dialogSettings:{id:"detachVolumeConfirmation",title:"file-system-mount-confirmation",content:"file-system-mount-selected-content",trueText:"file-systems-virtual-machine",falseText:"file-systems-database",switchEnabled:!1,requireSelection:!0},enabled:function(){return"Not Mounted"===a.dataModel.fileSystem.status?(0===a.dataModel.fileSystem.blockSize?($("#selection").show(),$("#selectionMessage").text(i.translate("file-system-mount-selected-content"))):($("#selection").hide(),$("#selectionMessage").text(i.translate("file-system-mount-content"))),!0):!1},confirmClick:function(){var b,c=32;this.dialogSettings.switchEnabled&&(c=4),b=0===a.dataModel.fileSystem.blockSize?{status:"mount",blockSize:c}:{status:"mount"},g.patchFileSystem(r,s,b)}}];d.getActions=function(){return t},h.gridSettings=[{title:"Type",sizeClass:"twelfth",sortField:"type",getDisplayValue:function(a){return a.type}},{title:"Path",sizeClass:"quarter",sortField:"fileSystemPath",getDisplayValue:function(a){return a.fileSystemPath}}],h.addAction=function(){k.path(["storage-systems",r,"file-systems",s,"shares-exports","add"].join("/"))},a.dataModel=h,a.summaryModel=d,j.setupDataLoader(a,o.concat(n),"fileSystemSearch"),l()})}]),angular.module("rainierApp").controller("FileSystemsAddCtrl",["$scope","$routeParams","fileSystemService","$timeout","$window","$filter","orchestratorService","diskSizeService","objectTransformService","synchronousTranslateService","paginationService",function(a,b,c,d,e,f,g,h,i,j,k){var l,m=b.storageSystemId,n="storage-systems",o=b.evsId,p=b.filePoolId,q=[m],r=/^((([01]?[0-9]{1,2})|(2[0-4][0-9])|(25[0-5]))[.]){3}(([0-1]?[0-9]{1,2})|(2[0-4][0-9])|(25[0-5]))$/,s=c.getVirtualFileServerPorts();k.getAllPromises(null,n,!0,null,i.transformStorageSystem).then(function(a){return m||(q=_.reject(a,function(a){return!a.accessible||!a.unified})),g.filePools(m)}).then(function(a){return l=_.sortBy(a.filePools,function(a){return a.freeCapacity}),g.enterpriseVirtualServers(m)}).then(function(b){function e(){a.dataModel.showDropDownColumn=!0}function f(){return"new"===a.dataModel.virtualFileServer?a.dataModel.port&&a.dataModel.selectedStorageSystem&&a.dataModel.validationForm.ipAddress.$valid&&(a.dataModel.validationForm.subnetMask.$valid||a.dataModel.ipv6)&&a.dataModel.validationForm.fileServerName.$valid:!0}var k={validCapacity:!0,whiteSpace:!1,maxCapacity:!1,validationForm:{label:"",capacity:"",ipAddress:"",subnetMask:"",fileServerName:""}};if(a.dataModel=k,a.dataModel.allFilePools=l,a.dataModel.filePools=l,a.dataModel.virtualFileServers=b.evses,p){var n=_.find(l,function(a){return a.id===p});n&&(a.dataModel.defaultFilePool=!0,a.dataModel.filePool=n,a.dataModel.filePools=[n])}else if(o){var t=_.find(b.evses,function(a){return a.uuid===o});t&&(a.dataModel.defaultEvs=!0,a.dataModel.virtualFileServer=t.id,a.dataModel.virtualFileServers=[t])}!p&&l.length>0&&(a.dataModel.filePool=_.last(l));var u=c.getFormats(),v=c.getUnits();a.dataModel.selectedStorageSystem=m,a.dataModel.storageSystems=q,a.dataModel.formats=u,a.dataModel.units=v,a.dataModel.unit=v[0],a.dataModel.poolTier="1",a.dataModel.ports=s,a.dataModel.subnetPattern=/^(255.)((([01]?[0-9]{1,2})|(2[0-4][0-9])|(25[0-5]))[.]){2}(([0-1]?[0-9]{1,2})|(2[0-4][0-9])|(25[0-5]))$/,a.dataModel.selectedPattern=/(^\s*((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?))\s*$)|(^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$)/,a.dataModel.submit=function(){var b;b="new"===a.dataModel.virtualFileServer?{label:a.dataModel.label,filePoolId:a.dataModel.filePool.id,capacity:h.createDisplaySize(a.dataModel.capacity,a.dataModel.unit).value.toString(),blockSize:c.getFormatInKiloBytes(a.dataModel.format),evsId:a.dataModel.virtualFileServer,createNewEvs:!0,createEVSParams:{evsName:a.dataModel.virtualFileServerName,ipAddress:a.dataModel.ipAddress,subnetMask:a.dataModel.subnetMask,port:a.dataModel.port}}:{label:a.dataModel.label,filePoolId:a.dataModel.filePool.id,capacity:h.createDisplaySize(a.dataModel.capacity,a.dataModel.unit).value.toString(),blockSize:c.getFormatInKiloBytes(a.dataModel.format),evsId:a.dataModel.virtualFileServer,createNewEvs:!1},g.createFileSystem(a.dataModel.selectedStorageSystem,b).then(function(){window.history.back()})},a.dataModel.canSubmit=function(){return a.dataModel.format&&a.dataModel.filePool&&a.dataModel.validationForm.label.$valid&&a.dataModel.virtualFileServer&&a.dataModel.validationForm.capacity.$valid&&!a.dataModel.whiteSpace&&f()&&a.dataModel.validCapacity&&!a.dataModel.maxCapacity},a.$watch("dataModel.poolTier",function(){a.dataModel.showDropDownColumn=!1,d(e,500),a.dataModel.showDropDownColumn=!0},!0),a.$watch("dataModel.ipAddress",function(){r.test(a.dataModel.ipAddress)?a.dataModel.ipv6=!1:(a.dataModel.ipv6=!0,a.dataModel.subnetMask="")}),a.$watch("dataModel.label",function(){a.dataModel.label&&(a.dataModel.whiteSpace=a.dataModel.label.indexOf(" ")>-1)}),a.$watchGroup(["dataModel.filePool","dataModel.capacity","dataModel.unit"],function(){var b=h.createDisplaySize(a.dataModel.capacity,a.dataModel.unit);if(p||(a.dataModel.showDropDownColumn=!1,d(e,500),a.dataModel.filePools=_.sortBy(_.filter(a.dataModel.allFilePools,function(a){return parseInt(a.freeCapacity)>b.value}),function(a){return-1*parseInt(a.freeCapacity)}),a.dataModel.filePool=_.find(a.dataModel.filePools,function(b){return a.dataModel.filePool?b.id===a.dataModel.filePool.id:!1})),a.dataModel.filePool&&b){a.dataModel.validCapacity=parseInt(a.dataModel.filePool.freeCapacity)-parseInt(a.dataModel.filePool.usedCapacity)>b.value;var f=i.transformFilePoolCapacitySummaryModel(a.dataModel.filePool,a.dataModel.capacity,a.dataModel.unit);f.title=j.translate("common-storage-systems"),f.noBreakdown=!0,f.noLegendBox=!0,a.dataModel.keyAndColors=c.getKeyAndColors(a.dataModel.filePool,a.dataModel.capacity,a.dataModel.unit),a.dataModel.summaryModel=f}},!0)})}]),angular.module("rainierApp").controller("FileSystemsUpdateCtrl",["$scope","$routeParams","fileSystemService","$timeout","$window","$filter","orchestratorService","diskSizeService","objectTransformService","synchronousTranslateService",function(a,b,c,d,e,f,g,h,i,j){var k,l,m=b.storageSystemId,n=b.fileSystemId;g.fileSystem(m,n).then(function(a){return l=a,g.filePool(m,a.filePoolId.toString())}).then(function(a){return k=[a],g.enterpriseVirtualServers(m)}).then(function(b){var d={validCapacity:!0,whiteSpace:!1,maxCapacity:!1,validationForm:{label:"",capacity:""}};a.dataModel=d,d=a.dataModel;var e=c.getFormats(),f=c.getUnits(),o=_.find(k,function(a){return a.id===l.filePoolId});d.filePools=k,d.virtualFileServers=b.evses,d.selectedStorageSystem=m,d.label=l.label,d.formats=e,d.format=c.getFormatLabel(l.blockSize.value),d.units=f,d.unit=l.expansionLimitInBytes.unit,d.capacity=parseInt(l.expansionLimitInBytes.size),d.virtualFileServer=l.evsId.toString(),d.filePool=o,d.poolTier="1",d.submit=function(){var b={label:a.dataModel.label,expansionLimit:h.createDisplaySize(d.capacity,d.unit).value.toString()};g.patchFileSystem(m,n,b).then(function(){window.history.back()})},a.$watch("dataModel.label",function(){a.dataModel.label&&(a.dataModel.whiteSpace=a.dataModel.label.indexOf(" ")>-1)}),a.$watchGroup(["dataModel.filePool","dataModel.capacity","dataModel.unit"],function(){var b=h.createDisplaySize(a.dataModel.capacity,a.dataModel.unit);a.dataModel.maxCapacity=b.value>0x4000000000000;var d=_.find(a.dataModel.filePools,function(b){return a.dataModel.filePool?b.id===a.dataModel.filePool.id:!1});if(d){a.dataModel.validCapacity=parseInt(a.dataModel.filePool.freeCapacity)-parseInt(a.dataModel.filePool.usedCapacity)>b.value;var e=i.transformFilePoolCapacitySummaryModel(d,a.dataModel.capacity,a.dataModel.unit);e.title=j.translate("common-storage-systems"),e.noBreakdown=!0,a.dataModel.keyAndColors=c.getKeyAndColors(d,a.dataModel.capacity,a.dataModel.unit),a.dataModel.summaryModel=e}},!0),a.dataModel.canSubmit=function(){var b=h.createDisplaySize(a.dataModel.capacity,a.dataModel.unit).value;return(a.dataModel.validationForm.label.$dirty||a.dataModel.validationForm.capacity.$dirty)&&!a.dataModel.whiteSpace&&a.dataModel.validationForm.label.$valid&&a.dataModel.validationForm.capacity.$valid&&parseInt(a.dataModel.filePool.freeCapacity)>b&&!a.dataModel.maxCapacity}})}]),angular.module("rainierApp").controller("FileSystemsCtrl",["$scope","$routeParams","$timeout","$filter","orchestratorService","objectTransformService","synchronousTranslateService","scrollDataSourceBuilderService","$location",function(a,b,c,d,e,f,g,h,i){var j,k=b.storageSystemId;e.enterpriseVirtualServers(k).then(function(a){return j=a.evses,e.fileSystems(k)}).then(function(b){var d=b.fileSystems,f=[];_.forEach(d,function(a){if(!_.find(f,function(b){return b.id===a.evsId})){var b=_.first(_.where(j,{id:a.evsId}));b&&f.push(b)}});var l={file:!0,title:g.translate("common-storage-system-file-systems"),storageSystemId:k,view:"tile",allItemsSelected:!1,search:{freeText:"",freeCapacity:{min:0,max:1e3,unit:"PB"},totalCapacity:{min:0,max:1e3,unit:"PB"},fileServer:null},fileServer:f,sort:{field:"usageBare",reverse:!0,setSort:function(b){c(function(){a.dataModel.sort.field===b?a.dataModel.sort.reverse=!a.dataModel.sort.reverse:(a.dataModel.sort.field=b,a.dataModel.sort.reverse=!1)})}}},m=[{icon:"icon-delete",tooltip:"action-tooltip-delete",type:"confirm",confirmTitle:"file-system-delete-confirmation",confirmMessage:"file-system-delete-selected-content",enabled:function(){return l.anySelected()},onClick:function(){_.forEach(l.getSelectedItems(),function(a){e.deleteFileSystem(k,a.id)})}},{icon:"icon-edit",tooltip:"action-tooltip-edit",type:"link",enabled:function(){return l.onlyOneSelected()},onClick:function(){i.path(["storage-systems",k,"file-systems",_.first(l.getSelectedItems()).id,"update"].join("/"))}},{icon:"icon-unmount",tooltip:"action-tooltip-unmount",type:"confirm",confirmTitle:"file-system-unmount-confirmation",confirmMessage:"file-system-unmount-selected-content",enabled:function(){return l.onlyOneSelected()&&"Not Mounted"!==_.first(l.getSelectedItems()).status},onClick:function(){var a={status:"unmount"};e.patchFileSystem(k,_.first(l.getSelectedItems()).id,a)}},{icon:"icon-mount",tooltip:"action-tooltip-mount",type:"confirmation-modal",dialogSettings:{id:"detachVolumeConfirmation",title:"file-system-mount-confirmation",content:"file-system-mount-selected-content",trueText:"file-systems-virtual-machine",falseText:"file-systems-database",switchEnabled:!1,requireSelection:!0},enabled:function(){return l.onlyOneSelected()&&"Mounted"!==_.first(l.getSelectedItems()).status?(0===_.first(l.getSelectedItems()).blockSize?($("#selection").show(),$("#selectionMessage").text(g.translate("file-system-mount-selected-content"))):($("#selection").hide(),$("#selectionMessage").text(g.translate("file-system-mount-content"))),!0):!1},confirmClick:function(){var a,b=32;this.dialogSettings.switchEnabled&&(b=4),
a=0===_.first(l.getSelectedItems()).blockSize?{status:"mount",blockSize:b}:{status:"mount"},e.patchFileSystem(k,_.first(l.getSelectedItems()).id,a)}}];l.getActions=function(){return m},l.gridSettings=[{title:"Name",sizeClass:"sixth",sortField:"label",getDisplayValue:function(a){return a.label}},{title:"Status",sizeClass:"sixth",sortField:"status",getDisplayValue:function(a){return a.status}},{title:"file-pool-total",sizeClass:"twelfth",sortField:"capacityInBytes.value",getDisplayValue:function(a){return a.capacityInBytes},type:"size"},{title:"file-pool-free",sizeClass:"twelfth",sortField:"availableCapacityInBytes.value",getDisplayValue:function(a){return a.availableCapacityInBytes},type:"size"},{title:"common-file-used",sizeClass:"twelfth",sortField:"usedCapacityInBytes.value",getDisplayValue:function(a){return a.usedCapacityInBytes},type:"size"}],l.addAction=function(){i.path(["storage-systems",k,"file-systems","add"].join("/"))},a.dataModel=l,h.setupDataLoader(a,d,"fileSystemsSearch")})}]),angular.module("rainierApp").controller("HostAddCtrl",["$scope","$filter","orchestratorService","$timeout",function(a,b,c,d){function e(a,b,c,d,e){var f=[];return _.forEach(e.split(","),function(a){a=a.trim(),f.push(a)}),{serverName:a,description:b,ipAddress:c,osType:d,wwpns:f}}var f=c.osType(),g={hostsModel:{hosts:[],addHost:function(a){var b=this,c={name:"",description:"",ipAddress:"",osType:f[0],wwns:""};angular.extend(c,a),c.isValid=function(){return!_.isEmpty(c.name)&&!_.isEmpty(c.osType)&&!_.isEmpty(c.wwns)},c["delete"]=function(){d(function(){_.remove(b.hosts,function(a){return a===c})})},b.hosts.splice(0,0,c)}},osTypes:f};g.hostsModel.addHost(),g.canSubmit=function(){var a,b,c=g.hostsModel.hosts.length;if(1>=c)return!1;for(a=1;c>a;++a)if(b=g.hostsModel.hosts[a],!b.isValid())return!1;return!0},g.submit=function(){var a,b={servers:[]};for(a=1;a<g.hostsModel.hosts.length;++a){var d=g.hostsModel.hosts[a];b.servers.push(e(d.name,d.description,d.ipAddress,d.osType,d.wwns))}c.createServers(b).then(function(){window.history.back()})},g.reset=function(){g.hostsModel.hosts=[],g.hostsModel.addHost()};var h={name:"name",description:"description",ipaddress:"ipAddress",ostype:"osType",wwns:"wwns"};a.$watch("dataModel.importedHosts",function(a){a&&(a.length>0&&(g.hostsModel.hosts=[]),_.forEach(a,function(a){var b={},c=!1;for(var d in a){var e=h[d.toLowerCase()];e&&("osType"===e?b[e]=a[d].toUpperCase():b[e]=a[d],c=!0)}c&&g.hostsModel.addHost(b)}),0===g.hostsModel.hosts.length&&g.hostsModel.addHost())}),a.dataModel=g}]),angular.module("rainierApp").controller("HostUpdateCtrl",["$scope","$routeParams","orchestratorService",function(a,b,c){function d(){var b=[];_.forEach(a.dataModel.updatedWwns.split(","),function(a){a=a.trim(),b.push(a)});var d=a.dataModel.originalHost.wwpns,e=_.difference(b,d),g=_.difference(d,b);e.length>0&&c.addHostWwn(f,{wwpns:e}),g.length>0&&c.removeHostWwn(f,{wwpns:g})}function e(){var b={},d=a.dataModel.originalHost;d.serverName!==a.dataModel.updatedHostName&&(b.serverName=a.dataModel.updatedHostName),d.description!==a.dataModel.updatedDescription&&(b.description=a.dataModel.updatedDescription),d.ipAddress!==a.dataModel.updatedIpAddress&&(b.ipAddress=a.dataModel.updatedIpAddress),d.osType!==a.dataModel.updatedOsType&&(b.osType=a.dataModel.updatedOsType),(b.serverName||b.description||b.ipAddress||b.osType)&&c.updateHost(f,b)}var f=b.hostId;c.host(f).then(function(b){var d=b.wwpns.join(", ");a.dataModel={originalHost:b,updatedHostName:b.serverName,updatedDescription:b.description,updatedIpAddress:b.ipAddress,updatedOsType:b.osType,updatedWwns:d,osTypes:c.osType(),isValid:function(){return!(_.isEmpty(this.updatedHostName)||_.isEmpty(this.updatedOsType)||_.isEmpty(this.updatedWwns)||b.serverName===a.dataModel.updatedHostName&&b.description===a.dataModel.updatedDescription&&b.ipAddress===a.dataModel.updatedIpAddress&&b.osType===a.dataModel.updatedOsType&&d===a.dataModel.updatedWwns)}}}),a.updateHost=function(){d(),e(),window.history.back()}}]),angular.module("rainierApp").controller("HostCtrl",["$scope","$routeParams","$window","$timeout","$location","orchestratorService","objectTransformService","scrollDataSourceBuilderService","ShareDataService","inventorySettingsService","storageSystemVolumeService","queryService","paginationService","scrollDataSourceBuilderServiceNew",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o=b.hostId,p="compute/servers/attached-volumes",q=function(a){var b=0;return _.forEach(a,function(a){a.id=++b}),a},r=function(a){i.volumeListForUnprotect=a,e.path(["hosts",o,"unprotect"].join("/"))},s=function(a,b){var c=0;b&&b.length>0&&(c=b[0].volumeId);var d=b[0].storageSystemId;i.restoreStorageSystemId=d,k.getVolumePairsAsPVol(null,c,d).then(function(a){i.SVolsList=_.filter(a.resources,function(a){return a.primaryVolume&&a.secondaryVolume}),i.restorePrimaryVolumeId=c,i.restorePrimaryVolumeToken=a.nextToken,_.forEach(i.SVolsList,function(a){a.selected=!1}),e.path(["/hosts/",o,"/volume-actions-restore-selection"].join(""))})};f.host(o).then(function(b){var c=0,d=0,e=0;f.hostVolumes(b.serverId).then(function(h){_.forEach(h.dpVolResouce,function(a){c+=a.totalCapacity.value,d+=a.usedCapacity.value,e+=a.availableCapacity.value});var i=g.transformToHostSummaryModel(c,d,e);i.title="Server "+o,i.noBreakdown=!0,f.dpAlertsCountForHost(o).then(function(c){i.alerts.dp.count=c.volumeAlerts,0!==c.volumeAlerts&&(i.alerts.dp.level="error"),i.server=b,i.getActions=function(){return this.server.getActions()},a.summaryModel=i,a.attachedVolumes={}})})}),m.clearQuery(),l.setQueryMapEntry("serverId",parseInt(o)),m.get(null,p,g.transformVolume,!1).then(function(b){q(b.resources);var c={view:"list",hostId:o,removeConnection:!0,hasDetach:!0,hasIconAndExpandingRows:!0,nextToken:b.nextToken,total:b.total,currentPageCount:0,displayList:b.resources,busy:!1,sort:{field:"volumeId",reverse:!1,setSort:function(b){d(function(){a.dataModel.sort.field===b?(l.setSort(b,!a.dataModel.sort.reverse),a.dataModel.sort.reverse=!a.dataModel.sort.reverse):(a.dataModel.sort.field=b,l.setSort(b,!1),a.dataModel.sort.reverse=!1),m.getQuery(p,g.transformVolume).then(function(a){t(a)})})}}};j.setVolumesGridSettings(c,{canAdd:!1});var h=[{icon:"icon-edit",tooltip:"action-tooltip-edit",type:"link",enabled:function(){return c.onlyOneSelected()},onClick:function(){var a=_.first(c.getSelectedItems());a.actions.edit.onClick()}},{icon:"icon-detach-volume",tooltip:"action-tooltip-detach-volumes",type:"confirmation-modal",dialogSettings:{id:"detachVolumeConfirmation",title:"storage-volume-detach-confirmation",content:"storage-volume-detach-selected-content",trueText:"storage-volume-detach-remove-zone",falseText:"storage-volume-detach-not-remove-zone",switchEnabled:!1},enabled:function(){return c.anySelected()},onClick:function(){$("#"+this.dialogSettings.id).modal("hide");var a=this.dialogSettings.switchEnabled;_.forEach(c.getSelectedItems(),function(b){var c={storageSystemId:b.storageSystemId,serverId:o,volumeId:b.volumeId,removeConnection:a};f.detachVolume(c)})}},{icon:"icon-data-protection",tooltip:"action-tooltip-protect-volumes",type:"link",onClick:function(){i.volumesList=c.getSelectedItems(),e.path("/hosts/"+o+"/protect")},enabled:function(){return c.anySelected()}},{icon:"icon-remove-volume",tooltip:"action-tooltip-unprotect-volumes",type:"link",onClick:function(){r(c.getSelectedItems())},enabled:function(){return c.onlyOneSelected()&&!_.some(c.getSelectedItems(),function(a){return a.isUnprotected()})}},{icon:"icon-refresh",tooltip:"action-tooltip-restore-volumes",type:"link",onClick:function(){s("restore",c.getSelectedItems())},enabled:function(){return c.onlyOneSelected()&&!_.some(c.getSelectedItems(),function(a){return a.isUnprotected()})}}];c.getActions=function(){return h},c.getResources=function(){return m.get(a.dataModel.nextToken,p,g.transformVolume,!1)},a.dataModel=c,n.setupDataLoader(a,b.resources)});var t=function(b){a.dataModel.nextToken=b.nextToken,a.dataModel.displayList=q(b.resources),a.dataModel.itemCounts={filtered:a.dataModel.displayList.length,total:a.dataModel.total}};a.filterModel={filter:{freeText:"",volumeType:"",replicationType:[],protectionStatusList:[],snapshot:!1,clone:!1,"protected":!1,unprotected:!1,secondary:!1,freeCapacity:{min:0,max:1e3,unit:"PB"},totalCapacity:{min:0,max:1e3,unit:"PB"},utilization:{min:0,max:100}},arrayType:(new m.SearchType).ARRAY,filterQuery:function(a,b,c,d){var e=new m.QueryObject(a,c,b,d);m.setFilterSearch(e),m.getQuery(p,g.transformVolume).then(function(a){t(a)})},sliderQuery:function(a,b,c,d){m.setSliderSearch(a,b,c,d),m.getQuery(p,g.transformVolume).then(function(a){t(a)})},searchQuery:function(a){var b=[];b.push(new m.QueryObject("volumeId",(new m.SearchType).INT,a)),b.push(new m.QueryObject("label",(new m.SearchType).STRING,a)),m.setTextSearch(b),m.getQuery(p,g.transformVolume).then(function(a){t(a)})}}}]),angular.module("rainierApp").controller("HostsCtrl",["$scope","$timeout","orchestratorService","objectTransformService","synchronousTranslateService","scrollDataSourceBuilderServiceNew","ShareDataService","queryService","paginationService","$location",function(a,b,c,d,e,f,g,h,i,j){function k(a){for(var b=0;b<n.length;b++)if(n[b].name===a)return n[b].caption;return a}function l(a){d.transformHost(a),a.metaData[0].details.push(a.attachedVolumeCount+" volume(s)")}a.operatingSystemType={},a.operatingSystems=c.osType(),h.clearQueryMap();var m="compute/servers",n=[{name:"HP_UX",caption:"Hewlett-Packard Unix"},{name:"SOLARIS",caption:"Oracle Solaris"},{name:"AIX",caption:"IBM AIX"},{name:"TRU64",caption:"Tru64 Unix"},{name:"HI_UX",caption:"HI Unix"},{name:"WIN",caption:"Windows"},{name:"WIN_EX",caption:"Windows EX"},{name:"LINUX",caption:"Linux"},{name:"VMWARE",caption:"VMware"},{name:"VMWARE_EX",caption:"VMware EX"},{name:"UVM",caption:"UVM"},{name:"NETWARE",caption:"Netware"},{name:"OVMS",caption:"OVMS"}];c.hostsSummary().then(function(b){var c={chartData:[]};c.totalHost=b.totalHost;for(var d=0;d<a.operatingSystems.length;++d)b.osTypeCount[a.operatingSystems[d]]&&c.chartData.push({name:k(a.operatingSystems[d]),value:b.osTypeCount[a.operatingSystems[d]]});c.title=e.translate("common-hosts"),a.summaryModel=c}),i.get(null,m,l,!0).then(function(d){var e=d.resources,k={hosts:e,view:"tile",allItemsSelected:!1,nextToken:d.nextToken,total:d.total,busy:!1,sort:{field:"serverId",reverse:!1,setSort:function(c){b(function(){a.dataModel.sort.field===c?(h.setSort(c,!a.dataModel.sort.reverse),a.dataModel.sort.reverse=!a.dataModel.sort.reverse):(a.dataModel.sort.field=c,h.setSort(c,!1),a.dataModel.sort.reverse=!1),i.getQuery(m,l).then(function(a){o(a)})})}}},n=[{icon:"icon-delete",type:"confirm",tooltip:"action-tooltip-delete",confirmTitle:"host-delete-confirmation",confirmMessage:"host-delete-selected-content",enabled:function(){return k.anySelected()},onClick:function(){_.forEach(k.getSelectedItems(),function(a){a.actions["delete"].onClick(c,!1)})}},{icon:"icon-edit",tooltip:"action-tooltip-edit",type:"link",enabled:function(){return k.onlyOneSelected()},onClick:function(){var a=_.first(k.getSelectedItems());a.actions.edit.onClick()}},{icon:"icon-attach-volume",tooltip:"action-tooltip-attach-volumes",type:"dropdown",enabled:function(){return k.anySelected()},items:[{type:"link",title:"Attach Existing Volume(s)",onClick:function(){g.push("selectedServers",k.getSelectedItems()),j.path("/hosts/attach-volumes")}},{type:"link",title:"Create and Attach Volume(s)",onClick:function(){g.push("selectedServers",k.getSelectedItems()),j.path("hosts/create-and-attach-volumes")}}]}];k.getActions=function(){return n},k.addAction=function(){j.path(["hosts","add"].join("/"))},k.gridSettings=[{title:"hosts-id",sizeClass:"twelfth",sortField:"serverId",getDisplayValue:function(a){return a.serverId},type:"id"},{title:"hosts-label",sizeClass:"sixth",sortField:"serverName",getDisplayValue:function(a){return a.serverName}},{title:"hosts-ip-address",sizeClass:"sixth",sortField:"ipAddress",getDisplayValue:function(a){return a.ipAddress}},{title:"hosts-volume-count",sizeClass:"twelfth",sortField:"attachedVolumeCount",getDisplayValue:function(a){return a.attachedVolumeCount}},{title:"hosts-data-protection-type",sizeClass:"sixth",sortField:"displayedDpType",getDisplayValue:function(a){return a.displayedDpType},getToolTipValue:function(a){return a.toolTipDpType},type:"dpType"}],k.getResources=function(){return i.get(a.dataModel.nextToken,m,l,!1)},k.displayList=d.resources,a.dataModel=k,f.setupDataLoader(a,e,"hostSearch")});var o=function(b){a.dataModel.nextToken=b.nextToken,a.dataModel.displayList=b.resources,a.dataModel.itemCounts={filtered:a.dataModel.displayList.length,total:a.dataModel.total}};a.filterModel={filterOperatingSystem:function(){var b=[],c=a.filterModel.operatingSystemType;for(var d in c)c[d]&&b.push(d);a.filterModel.filter.osType=b},filterDpType:function(){var b=[];a.dataModel.snapshot&&b.push("SNAPSHOT"),a.dataModel.cloneNow&&b.push("CLONE"),a.filterModel.filter.replicationTypes=b},filter:{freeText:"",status:"",osType:null,replicationType:null,snapshot:!1,clone:!1},arrayType:(new i.SearchType).ARRAY,filterQuery:function(a,b,c,d){var e=new i.QueryObject(a,c,b,d);i.setFilterSearch(e),i.getQuery(m,l).then(function(a){o(a)})},searchQuery:function(a){var b=[];b.push(new i.QueryObject("serverId",(new i.SearchType).INT,a)),b.push(new i.QueryObject("serverName",(new i.SearchType).STRING,a)),i.setTextSearch(b),i.getQuery(m,l).then(function(a){o(a)})}}}]),angular.module("rainierApp").controller("LoginCtrl",["$scope","$location","authService",function(a,b,c){a.model={date:new Date,username:"",password:"",loginDisabled:function(){return 0===a.model.username.length||0===a.model.password.length},login:function(){c.login(a.model.username,a.model.password).then(function(){b.path("/")},function(b){b&&401===b.status?a.model.unauthorized=!0:a.model.loginFailed=!0})}}}]),angular.module("rainierApp").controller("MainCtrl",function(){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}),angular.module("rainierApp").controller("MonitoringCapacityCarouselCtrl",["$scope","monitoringService",function(a,b){function c(a){var c=b.getModel();if(c.hasOwnProperty("capacityAlertTotals")&&c.capacityAlertTotals.hasOwnProperty("capacityComponents")){var d=c.capacityAlertTotals.capacityComponents;if(d.hasOwnProperty(a))return d[a]?"danger":"disabled"}}a.interval=0,a.slides=[{active:!0,items:[{id:"pool",itemClass:"active",iconClass:"icon-pools",displayName:"Pools",badgeClass:c("poolAlerts"),onClick:b.setSelectedComponent}]}]}]),angular.module("rainierApp").controller("MonitoringDataProtectionCarouselCtrl",["$scope","monitoringService",function(a,b){a.interval=0,a.slides=[{active:!0,items:[{id:"disk",itemClass:"active",iconClass:"icon-volume",headerValue:"23",displayName:"Volumes",badgeClass:"danger",onClick:b.setSelectedComponent},{itemClass:"",iconClass:"icon-host",headerValue:"25",id:"disk",displayName:"Hosts",badgeClass:"disabled",onClick:b.setSelectedComponent}]}]}]),angular.module("rainierApp").controller("MonitoringHardwareCarouselCtrl",["$scope","monitoringService",function(a,b){function c(a){var c=b.getModel();if(c.hasOwnProperty("hardwareAlertTotals")&&c.hardwareAlertTotals.hasOwnProperty("hardwareComponents")){var d=c.hardwareAlertTotals.hardwareComponents;if(d.hasOwnProperty(a))return d[a]?"danger":"disabled"}}a.interval=0,a.slides=[{active:!0,items:[{id:"disk",itemClass:"active",iconClass:"icon-disk-status",displayName:"Disk",badgeClass:c("diskAlerts"),onClick:b.setSelectedComponent},{itemClass:"",iconClass:"icon-fan",id:"fan",displayName:"Fan",badgeClass:c("fanAlerts"),onClick:b.setSelectedComponent},{itemClass:"",iconClass:"icon-battery",id:"battery",displayName:"Battery",badgeClass:c("batteryAlerts"),onClick:b.setSelectedComponent}]},{active:!1,items:[{itemClass:"",iconClass:"icon-cache",id:"cache",displayName:"Cache",badgeClass:c("cacheAlerts"),onClick:b.setSelectedComponent},{itemClass:"",iconClass:"icon-processor",id:"processor",displayName:"Processor",badgeClass:c("processorAlerts"),onClick:b.setSelectedComponent},{itemClass:"",iconClass:"icon-power-status",id:"powerSupply",displayName:"Power",badgeClass:c("powerSupplyAlerts"),onClick:b.setSelectedComponent}]},{active:!1,items:[{itemClass:"",iconClass:"icon-ports",id:"port",displayName:"Ports",badgeClass:c("portAlerts"),onClick:b.setSelectedComponent},{itemClass:"",iconClass:"icon-memory",id:"memory",displayName:"Memory",badgeClass:c("memoryAlerts"),onClick:b.setSelectedComponent}]}]}]),angular.module("rainierApp").controller("MonitoringCtrl",["$scope","$timeout","$window","monitoringService","scrollDataSourceBuilderService","diskSizeService",function(a,b,c,d,e,f){function g(){a.model={title:"Monitoring",alerts:{capacity:{count:a.capacityAlertTotals.totalComponentWiseCapacityAlerts,level:a.capacityAlertTotals&&0!==a.capacityAlertTotals.totalComponentWiseCapacityAlerts&&"0"!==a.capacityAlertTotals.totalComponentWiseCapacityAlerts?i:j},dp:{count:a.dpAlertTotals,level:0!==a.dpAlertTotals&&"0"!==a.dpAlertTotals?i:j},hardware:{count:a.hardwareAlertTotals.totalComponentWiseHardwareAlerts,level:a.hardwareAlertTotals&&0!==a.hardwareAlertTotals.totalComponentWiseHardwareAlerts&&"0"!==a.hardwareAlertTotals.totalComponentWiseHardwareAlerts?i:j},jobs:{count:0,level:"healthy"}}},a.interval=0;var b=[],c={},e=[];e.push(h("Volumes",a.dpAlertVolumes)),e.push(h("Hosts",a.dpAlertHosts)),c.items=e,b.push(c),a.slides=b,a.onSelectComponent(d.getSelectedComponent())}function h(a,b){var c={};return c.displayName=a,c.onClick=d.launchDpMonitoring,b>0?(c.numberOfAlert=b,c.badgeClass="danger"):(c.badgeClass="disabled",c.numberOfAlert=0),"Volumes"===a?(c.id="volume",c.itemClass="active",c.iconClass="icon-volume"):(c.id="host",c.itemClass="",c.iconClass="icon-host"),c}var i="error",j="healthy";d.getSummaryStatus(function(b){a.hardwareAlertTotals=b.hardwareAlertTotals,a.capacityAlertTotals=b.capacityAlertTotals,d.getDpAlerts(function(b){a.dpAlertTotals=b.total,a.dpAlertHosts=b.totalHostAlertCount,a.dpAlertVolumes=b.totalVolumeAlertCount,g()})}),a.onSelectComponent=function(c){a.dropdownReady=!1,d.getComponentAlerts(c,function(g){a.dataModel={title:"Alerts",view:"list",diskTable:"disk"===c,poolTable:"pool"===c,storageArrays:d.getUniqueStorageSerialNumbers(g),alertLevels:d.getUniqueAlertLevels(g),isStorageArrayId:d.isStorageArrayId(),search:{freeText:""},sort:{reverse:!0,setSort:function(c){b(function(){a.dataModel.sort.field===c?a.dataModel.sort.reverse=!a.dataModel.sort.reverse:(a.dataModel.sort.field=c,a.dataModel.sort.reverse=!1)})}}},a.dropdownReady=!0,"disk"===c&&_.forEach(g,function(a){a.diskSpec.capacity=f.getDisplaySize(a.diskSpec.capacity)}),e.setupDataLoader(a,g,"alertSearch",!0)})},a.selectedComponent=d.getSelectedComponent(),a.$watch(d.getSelectedComponent,function(b){b&&a.onSelectComponent(b)})}]),angular.module("rainierApp").controller("ParityGroupsAddCtrl",["$scope","$routeParams","$timeout","$window","orchestratorService","diskSizeService","$location","synchronousTranslateService","objectTransformService","paginationService",function(a,b,c,d,e,f,g,h,i,j){function k(b,c){var d={storageSystems:b,storageSystemSelectable:c,raidOptions:[],pgTemplateRows:[],uniqueRaidLevel:[],uniqueRaidLayout:[]};return d.getBasicEncryption=function(){return a.dataModel.basicEncryption},d.getDiskType=function(a){var b=f.getDisplaySize(a.size);return a.diskType+" "+f.getDisplaySpeed(a.speed)+" "+b.size+b.unit},d.getUsableCapacity=function(a){var b=a.numberOfParityGroups*a.singleParitiGroupSize,c=f.getDisplaySize(b);return c.size+" "+c.unit},d.checkAdvancedSubmitDisable=function(){var b=r(a.dataModel.disksList);return null===a.dataModel.search.raidLevel||null===a.dataModel.search.raidLayout||0===b.length},d}function l(b){var c=b.parityGroupTemplateItems;(c&&0===c.length||!c)&&(a.dataModel.displayPrompt=!0),a.dataModel.submitBasicDisabled=!0,a.dataModel.parityGroupTemplateItems=b.parityGroupTemplateItems,a.dataModel.parityGroupPayloadItems=angular.copy(b.parityGroupTemplateItems);var d=[],e=[],f=[];_.forEach(c,function(b){if(f=f.concat(b.raidOptions),b.encryption=a.dataModel.getBasicEncryption(),0!==b.numberOfAvailableDisks){var c=_.where(b.raidOptions,function(a){return a.numberOfParityGroups>0});if(0===c.length)return;var g={diskType:b.diskType,speed:b.speed,size:b.size,encryption:b.encryption,totalNumberOfDisks:b.totalNumberOfDisks,numberOfExistingHotSpares:b.numberOfExistingHotSpares,numberOfAvailableDisks:b.numberOfAvailableDisks,raidOptions:n(c),raidConfig:c,numberOfNewHotSpares:b.numberOfNewHotSpares,parityGroupTitle:"Parity Group"};e=e.concat(c),d.push(g)}}),0===d.length&&(a.dataModel.displayPrompt=!0),a.dataModel.raidOptions=a.dataModel.raidOptions.concat(e),a.dataModel.uniqueRaidLevel=_.uniq(_.pluck(a.dataModel.raidOptions,"raidLevel")),a.dataModel.uniqueRaidLayout=_.uniq(_.pluck(a.dataModel.raidOptions,"raidLayout")),a.dataModel.pgTemplateRows=a.dataModel.pgTemplateRows.concat(d),a.dataModel.advancedUniqueRaidLevel=_.uniq(_.pluck(f,"raidLevel")),a.dataModel.advancedUniqueRaidLayout=_.uniq(_.pluck(f,"raidLayout")),a.dataModel.advancedUniqueRaidLayoutOriginal=_.uniq(_.pluck(f,"raidLayout")),o(c)}function m(b){var c=b;a.dataModel.submitAdvanceDisabled=!0;var d=[],e=[],g=[],h=[];_.forEach(c,function(a){if("FREE"===a.purpose||"SPARE"===a.purpose){var b={diskId:a.diskId,storageSystemId:a.storageSystemId,serialNumber:a.serialNumber,location:a.location,model:a.model,capacityInBytes:a.capacityInBytes,version:a.version,speed:a.speed,type:a.type,purpose:a.purpose,parityGroupId:a.parityGroupId,selected:!1,convertedDiskCapacity:f.getDisplaySize(a.capacityInBytes),speedOnly:f.getDisplaySpeedOnly(a.speed),speedUnitOnly:f.getDisplaySpeedUnitOnly(a.speed)};"FREE"===a.purpose&&h.push("FREE"),"SPARE"===a.purpose&&h.push("SPARE"),e.push(a.type),g.push(a.speed.toString()),d.push(b)}}),a.dataModel.types=e,a.dataModel.speeds=g,a.dataModel.purposes=h,a.dataModel.disksList=d,a.dataModel.uniqueDiskTypes=_.sortBy(_.uniq(e)),a.dataModel.uniqueDiskSpeeds=_.sortBy(_.uniq(g)),a.dataModel.uniqueDiskPurposes=_.sortBy(_.uniq(h))}function n(a){for(var b=null,c=0;c<a.length;++c){var d=a[c];d.numberOfParityGroupsOriginal=d.numberOfParityGroups;var e=f.getDisplaySize(d.usableCapacity),g=d.numberOfParityGroupsOriginal,h=0===g?0:e.value/g;d.singleParitiGroupSize=h,d.isDefault&&(b=d)}return b||(b=a[0]),b}function o(b){var c=angular.copy(b),d=_.some(c,function(a){return _.isNull(a.raidOptions.numberOfParityGroups)||_.isUndefined(a.raidOptions.numberOfParityGroups)||a.raidOptions.numberOfParityGroups%1!==0});if(d)return a.dataModel.submitBasicDisabled=!0,void angular.forEach(b,function(a){a.raidOptions.numberOfParityGroups?a.parityGroupTitle="Parity Group":a.parityGroupTitle=h.translate("parity-group-add-invalid-tooltip")+a.raidOptions.numberOfParityGroupsOriginal});var e=s(c);0===e.length?a.dataModel.submitBasicDisabled=!0:a.dataModel.submitBasicDisabled=!1}function p(){var b=s(a.dataModel.pgTemplateRows);angular.forEach(b,function(b){b.raidLevel=b.raidOptions.raidLevel,b.raidLayout=b.raidOptions.raidLayout,b.numberOfParityGroups=b.raidOptions.numberOfParityGroups,b.encryption=a.dataModel.getBasicEncryption(),delete b.numberOfAvailableDisks,delete b.numberOfExistingHotSpares,delete b.numberOfNewHotSpares,delete b.totalNumberOfDisks,delete b.raidConfig,delete b.raidOptions,delete b.$$hashKey});var c={createParityGroupItems:b};return c}function q(){var b=r(a.dataModel.disksList),c={diskIds:b,raidLevel:a.dataModel.search.raidLevel,raidLayout:a.dataModel.search.raidLayout,encryption:a.dataModel.advEncryption};return c}function r(a){var b=[];return _.forEach(a,function(a){a.selected===!0&&b.push(a.diskId)}),b}function s(a){_.forEach(a,function(a){delete a.parityGroupTitle});var b=[];if(null!==a)for(var c=0;c<a.length;c++)a[c].raidOptions.numberOfParityGroups>0&&b.push(a[c]);return b}function t(){a.dataModel.showRaidLayoutDropDown=!0}var u=b.storageSystemId,v="disks",w="storage-systems",x={RAID5:["3D+1P","4D+1P","6D+1P","7D+1P"],RAID6:["14D+2P","12D+2P","6D+2P"],"RAID1+0":["2D+2D"]};j.getAllPromises(null,w,!0,null,i.transformStorageSystem).then(function(b){var c=b,d=_.isUndefined(u),f=_.find(c,function(a){return d||a.storageSystemId===u});a.dataModel=k(c,d),a.dataModel.displayPrompt=!1,a.dataModel.raidTypeValidation=!1,a.dataModel.raidLayoutValidation=!1,a.dataModel.showRaidLayoutDropDown=!0,a.dataModel.advEncryption=!1,a.dataModel.basicEncryption=!1,a.dataModel.storageSystem=f,f&&(a.dataModel.selectedStorageSystemId=f.storageSystemId,e.parityGroupTemplate(f.storageSystemId).then(l),j.getAllPromises(null,v,!0,u).then(m)),a.model={wizardType:"basic"},a.dataModel.search={freeText:"",totalCapacity:{min:0,max:1e3,unit:"PB"},type:null,speed:null,purpose:null,raidLevel:null,raidLayout:null},a.itemSelected=!1}),a.initRaid=function(a){angular.forEach(a,function(a){return a.isDefault?0:void 0})},a.changeStorageSystem=function(a){e.parityGroupTemplate(a).then(l)},a.createParityGroupsBasic=function(){if(!a.dataModel.submitBasicDisabled){var b=p();e.createParityGroups(a.dataModel.selectedStorageSystemId,b),g.path("storage-systems/"+a.dataModel.selectedStorageSystemId+"/parity-groups")}},a.createParityGroupAdvanced=function(){if(a.dataModel.search.raidLevel?a.dataModel.raidTypeValidation=!1:a.dataModel.raidTypeValidation=!0,a.dataModel.search.raidLayout?a.dataModel.raidLayoutValidation=!1:a.dataModel.raidLayoutValidation=!0,!a.dataModel.checkAdvancedSubmitDisable()){var b=q();e.createParityGroup(a.dataModel.selectedStorageSystemId,b),g.path("storage-systems/"+a.dataModel.selectedStorageSystemId+"/parity-groups")}},a.$watch("dataModel.pgTemplateRows",function(a){a&&o(a)},!0),a.$watch("dataModel.disksList",function(b){var c=!1;_.forEach(b,function(a){a.selected===!0&&(c=!0)}),a.itemSelected=c},!0),a.$watch("dataModel.search.raidLevel",function(b){a.dataModel.showRaidLayoutDropDown=!1,c(t,10);for(var d in x)if(x.hasOwnProperty(d)&&b===d){var e=angular.copy(a.dataModel.advancedUniqueRaidLayoutOriginal);a.dataModel.advancedUniqueRaidLayout=[];for(var f=0;f<e.length;f++)x[d].indexOf(e[f])>-1&&a.dataModel.advancedUniqueRaidLayout.push(e[f])}})}]),angular.module("rainierApp").controller("ParityGroupsCtrl",["$q","$scope","$routeParams","$timeout","orchestratorService","objectTransformService","synchronousTranslateService","diskSizeService","scrollDataSourceBuilderService","$location","paginationService",function(a,b,c,d,e,f,g,h,i,j,k){function l(){_.forEach(b.dataModel.filteredList,function(a){a.selected===!0&&e.deleteParityGroup(a.storageSystemId,a.parityGroupId)})}function m(){_.forEach(b.dataModel.filteredList,function(a){a.selected===!0&&e.initializeParityGroup(a.storageSystemId,a.parityGroupId)})}function n(){_.forEach(b.dataModel.filteredList,function(a){a.selected===!0&&e.compressParityGroup(a.storageSystemId,a.parityGroupId)})}var o=c.storageSystemId,p=g.translate("common-parity-groups"),q="parity-groups";e.storageSystem(o).then(function(a){b.storageSystemModel=a.model}),e.parityGroupSummary(o).then(function(a){var c=[];if(a&&a.parityGroupSummaryItems){for(var d=a.parityGroupSummaryItems,e=0;e<d.length;e++){var f={},g=h.getDisplaySize(d[e].size),i=h.getDisplaySpeed(d[e].speed);_.isNull(i)||_.isUndefined(i)?f.diskConfig=d[e].diskType+" "+g.size+g.unit:f.diskConfig=d[e].diskType+" "+i+" "+g.size+g.unit,f.pgCount=d[e].numberOfParityGroups;var j=d[e].totalPgCapacityInBytes;f.pgCapacity=h.getDisplaySize(j),f.numberOfAvailableDisks=d[e].numberOfAvailableDisks,f.numberOfExistingHotSpares=d[e].numberOfExistingHotSpares,c.push(f)}c=_.sortBy(c,"diskConfig")}b.summaryModel=c});var r=function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c].raidLevel,e=a[c].raidLayout,f=d+" "+e;_.contains(b,f)||b.push(f)}return b=_.sortBy(b)},s=function(a){for(var c=[],d=0;d<a.length;d++){var e,f=a[d].diskSpec.type,g=h.getDisplaySize(a[d].diskSpec.capacityInBytes),i=a[d].diskSpec.speed;e=_.isNull(i)||_.isUndefined(i)?f+""+g.size+g.unit:f+" "+i+" "+g.size+g.unit,c.push({conf:e,pgCap:a[d].totalCapacityInBytes})}return b.allDiskConfigs=c,c},t=function(a){for(var c=[],d=s(a),e=0;e<d.length;e++)if(_.findIndex(c,{conf:d[e].conf})<0){var f=0;c.push({conf:d[e].conf,pgCount:f,pgCap:f})}return c=_.sortBy(c,"conf"),b.uniqueDiskConfigs=c,u(d),c},u=function(a){for(var c=0;c<a.length;c++){var d=_.where(b.uniqueDiskConfigs,{conf:a[c].conf});d[0].conf=a[c].conf,d[0].pgCount+=1,d[0].pgCap+=parseInt(a[c].pgCap)}};k.getAllPromises(null,q,!0,o,f.transformParityGroup).then(function(a){var c=a,f={storageSystemId:o,title:p,view:"tile",parityGroups:c,raidConfig:r(c),raidSelection:b.raidSelection,diskConfig:t(c),allItemsSelected:!1,search:{freeText:"",totalCapacity:{min:0,max:1e3,unit:"PB"}},sort:{field:"parityGroupId",reverse:!1,setSort:function(a){d(function(){b.dataModel.sort.field===a?b.dataModel.sort.reverse=!b.dataModel.sort.reverse:(b.dataModel.sort.field=a,b.dataModel.sort.reverse=!1)})}},statuses:["AVAILABLE","FORMATTING","QUICK_FORMATTING","IN_USE","UNINITIALIZED","EXTERNALIZED","UNSUPPORTED_ATTACHED","UNSUPPORTED_INACCESSIBLE_RESOURCEGROUP"],getSelectedParityGroupCount:function(){var a=0;return _.forEach(b.dataModel.filteredList,function(b){b.selected===!0&&a++}),a}},g={icon:"icon-initialize-pg",tooltip:"parity-group-initialize-tooltip",type:"confirm",confirmTitle:"parity-group-initialize-confirmation",confirmMessage:"parity-group-initialize-selected-content",enabled:function(){return f.anySelected()},onClick:function(){_.forEach(f.getSelectedItems(),function(a){a.actions.initialize.onClick(e,!1)})}},h={icon:"icon-compression",tooltip:"parity-group-compress-tooltip",type:"confirm",confirmTitle:"parity-group-compress-confirmation",confirmMessage:"parity-group-compress-selected-content",enabled:function(){return f.anySelected()},onClick:function(){_.forEach(f.getSelectedItems(),function(a){a.actions.compress.onClick(e,!1)})}},k={icon:"icon-delete",tooltip:"action-tooltip-delete",type:"confirm",confirmTitle:"parity-group-delete-confirmation",confirmMessage:"parity-group-delete-selected-content",enabled:function(){return f.anySelected()},onClick:function(){_.forEach(f.getSelectedItems(),function(a){a.actions["delete"].onClick(e,!1)})}},l=[g,k,h],m=[g,h];f.getActions=function(){return"VSP G1000"===b.storageSystemModel?m:l},f.addAction=function(){j.path(["storage-systems",o,"parity-groups","add"].join("/"))},f.hideAddTile="VSP G1000"===b.storageSystemModel,f.gridSettings=[{title:"ID",sizeClass:"twelfth",sortField:"parityGroupId",getDisplayValue:function(a){return a.parityGroupId},type:"id"},{title:"Status",sizeClass:"twelfth",sortField:"status",getDisplayValue:function(a){return a.status}},{title:"RAID Type",sizeClass:"twelfth",sortField:"raidType",getDisplayValue:function(a){return a.raidType}},{title:"Disk Type",sizeClass:"twelfth",sortField:"diskType",getDisplayValue:function(a){return a.diskType}},{title:"common-label-total",sizeClass:"twelfth",sortField:"total.value",getDisplayValue:function(a){return a.total},type:"size"},{title:"common-label-free",sizeClass:"twelfth",sortField:"free.value",getDisplayValue:function(a){return a.free},type:"size"},{title:"common-label-used",sizeClass:"twelfth",sortField:"used.value",getDisplayValue:function(a){return a.used},type:"size"}],b.dataModel=f,i.setupDataLoader(b,c,"parityGroupsSearch")}),b.deleteSelectedConfirmOk=function(){l()},b.initializeSelectedConfirmOk=function(){m()},b.compressSelectedConfirmOk=function(){n()}}]),angular.module("rainierApp").controller("ProtectVolumesCtrl",["$scope","$routeParams","$timeout","$window","$filter","$q","orchestratorService","diskSizeService","ShareDataService","cronStringConverterService","paginationService","objectTransformService",function(a,b,c,d,e,f,g,h,i,j,k,l){function m(){function b(){var b=a.dataModel.replicationTechnology,c=a.dataModel.numberOfSnapshots;c=parseInt(c);var d=o(),e=a.dataModel.consistencyGroupNeeded?"On":"Off";b===v?_.forEach(a.dataModel.volumeRows,function(a){a.copyGroupNames=_.where(p[a.storageSystemId],function(a){
return"Snapshot"===a.type&&e===a.consistent&&(!_.isFinite(c)||c===a.numberOfCopies)&&(_.isEmpty(d)||j.isEqualForObjectModel(d,a.schedule))}),a.CGSelection={}}):b===w&&_.forEach(a.dataModel.volumeRows,function(a){a.copyGroupNames=_.where(p[a.storageSystemId],function(a){return"Clone"===a.type&&e===a.consistent}),a.CGSelection={}})}function d(){a.dataModel.showDropDownColumn=!0}function e(){for(var b=a.dataModel.volumeRows.length-1;b>=0;b--)a.dataModel.volumeRows[b].isChecked===!0&&a.dataModel.volumeRows.splice(b,1);0===a.dataModel.volumeRows.length&&(a.dataModel.submitDisabled=!0)}function h(){return a.dataModel.replicationTechnology===w?!!a.dataModel.copyGroupName:a.dataModel.replicationTechnology===v&&a.dataModel.schedule===r?!!(a.dataModel.numberOfSnapshots&&a.dataModel.copyGroupName&&a.dataModel.hourInterval&&null!==a.dataModel.scheduleMinute):a.dataModel.replicationTechnology===v&&a.dataModel.schedule===s?!(!a.dataModel.numberOfSnapshots||!a.dataModel.copyGroupName):a.dataModel.replicationTechnology===v&&a.dataModel.schedule===u?!!(a.dataModel.numberOfSnapshots&&a.dataModel.copyGroupName&&i()):a.dataModel.replicationTechnology===v&&a.dataModel.schedule===t?!!(a.dataModel.numberOfSnapshots&&a.dataModel.copyGroupName&&a.dataModel.scheduleDate):void 0}function i(){for(var b in a.dataModel.Days)if(a.dataModel.Days.hasOwnProperty(b)){var c=a.dataModel.Days[b];for(var d in c)if(c.hasOwnProperty(d)&&"isChecked"===d&&c[d])return!0}return!1}function k(){angular.forEach(a.dataModel.volumeRows,function(b){a.storageSystemIds.indexOf(b.storageSystemId)<0&&a.storageSystemIds.push(b.storageSystemId)})}function l(){a.arrayVolumeMap={},angular.forEach(a.storageSystemIds,function(b){var c={};angular.forEach(a.dataModel.volumeRows,function(a){if(b===a.storageSystemId){var d=a.volumeId.toString();a.CGSelection&&a.CGSelection.id?c[d]=a.CGSelection.id:c[d]="Use New"}});var d=b.toString();a.arrayVolumeMap[d]=c})}function m(a){return 0===Object.keys(a).length}function o(){return j.fromDatePickerToObjectModel(a.dataModel.schedule,a.dataModel.scheduleTime,a.dataModel.scheduleDate,q(),a.dataModel.hourInterval,a.dataModel.scheduleMinute)}function q(){var b="";return a.dataModel.Days.Mon.isChecked&&(b+="Monday, "),a.dataModel.Days.Tue.isChecked&&(b+="Tuesday, "),a.dataModel.Days.Wed.isChecked&&(b+="Wednesday, "),a.dataModel.Days.Thu.isChecked&&(b+="Thursday, "),a.dataModel.Days.Fri.isChecked&&(b+="Friday, "),a.dataModel.Days.Sat.isChecked&&(b+="Saturday, "),a.dataModel.Days.Sun.isChecked&&(b+="Sunday, "),""!==b&&b.length>2?b.substring(0,b.length-2):" "}var r="HOURLY",s="DAILY",t="MONTHLY",u="WEEKLY",v="SNAPSHOT",w="CLONE";a.dataModel={replicationTechnology:v,filterDD:!1,schedule:r,submitDisabled:"true",showDropDownColumn:!0,numberOfCopiesInput:"",numberOfSnapshots:null,numberOfCopies:null,volumeRows:n,consistencyGroupNeeded:!1,getSelectedVolumeCount:function(){var b=0;return _.forEach(a.dataModel.volumeRows,function(a){a.isChecked===!0&&b++}),b}},a.dataModel.Days={Sun:{isChecked:!0,isDisabled:!1},Mon:{isChecked:!1,isDisabled:!1},Tue:{isChecked:!1,isDisabled:!1},Wed:{isChecked:!1,isDisabled:!1},Thu:{isChecked:!1,isDisabled:!1},Fri:{isChecked:!1,isDisabled:!1},Sat:{isChecked:!1,isDisabled:!1}},a.dataModel.numberOfCopiesInput=a.dataModel.numberOfSnapshots;var x=new Date;x.setHours(24),x.setMinutes(0),a.dataModel.scheduleTime=x,a.dataModel.scheduleDate=1,a.dataModel.hourInterval=1,a.dataModel.scheduleTimeUnit="AM",a.dataModel.scheduleTimeHour=12,a.dataModel.scheduleTimeMins=0,a.dataModel.scheduleMinute=0,a.$watchGroup(["dataModel.replicationTechnology","dataModel.scheduleTime"],function(b,c){b&&c&&(a.allUseExisting=!1,_.forEach(a.dataModel.volumeRows,function(a){a.CGSelection={}}))}),a.filterCopyGroups=function(){a.dataModel.showDropDownColumn=!1,c(d,500),b()},b(),a.deleteSelectedConfirmOk=function(){e(),$("#deleteSelectedConfirmation").modal("hide")},a.dataModel.allItemsSelected=!1,a.selectVolume=function(){a.changeSubmitButtonStatus();for(var b=0;b<a.dataModel.volumeRows.length;b++)if(!a.dataModel.volumeRows[b].isChecked)return void(a.dataModel.allItemsSelected=!1);a.dataModel.allItemsSelected=!0},a.changeSubmitButtonStatus=function(){return h()?void(a.dataModel.submitDisabled=!1):void(a.dataModel.submitDisabled=!0)},a.selectAll=function(){for(var b=0;b<a.dataModel.volumeRows.length;b++)a.dataModel.volumeRows[b].isChecked=a.dataModel.allItemsSelected},a.$watch("dataModel.schedule",function(){a.allUseExisting=!1,a.dataModel.schedule===s?(a.dataModel.Days.Mon.isChecked=!0,a.dataModel.Days.Mon.isDisabled=!0,a.dataModel.Days.Tue.isChecked=!0,a.dataModel.Days.Tue.isDisabled=!0,a.dataModel.Days.Wed.isChecked=!0,a.dataModel.Days.Wed.isDisabled=!0,a.dataModel.Days.Thu.isChecked=!0,a.dataModel.Days.Thu.isDisabled=!0,a.dataModel.Days.Fri.isChecked=!0,a.dataModel.Days.Fri.isDisabled=!0,a.dataModel.Days.Sat.isChecked=!0,a.dataModel.Days.Sat.isDisabled=!0,a.dataModel.Days.Sun.isChecked=!0,a.dataModel.Days.Sun.isDisabled=!0):(a.dataModel.Days.Mon.isChecked=!1,a.dataModel.Days.Mon.isDisabled=!1,a.dataModel.Days.Tue.isChecked=!1,a.dataModel.Days.Tue.isDisabled=!1,a.dataModel.Days.Wed.isChecked=!1,a.dataModel.Days.Wed.isDisabled=!1,a.dataModel.Days.Thu.isChecked=!1,a.dataModel.Days.Thu.isDisabled=!1,a.dataModel.Days.Fri.isChecked=!1,a.dataModel.Days.Fri.isDisabled=!1,a.dataModel.Days.Sat.isChecked=!1,a.dataModel.Days.Sat.isDisabled=!1,a.dataModel.Days.Sun.isChecked=!0,a.dataModel.Days.Sun.isDisabled=!1),a.changeSubmitButtonStatus()}),a.$watch("Days",function(){a.changeSubmitButtonStatus()},!0),a.CGChanged=function(){a.allUseExisting=!0;for(var b=0;b<a.dataModel.volumeRows.length;++b)if(!a.dataModel.volumeRows[b].hasOwnProperty("CGSelection")||a.dataModel.volumeRows[b].CGSelection&&!a.dataModel.volumeRows[b].CGSelection.hasOwnProperty("name")||null===a.dataModel.volumeRows[b].CGSelection||m(a.dataModel.volumeRows[b].CGSelection)){a.allUseExisting=!1;break}},a.validationForm={},a.submitProtectVolumes=function(){if(a.dataModel.replicationTechnology===v&&a.validationForm.leftPanel.numberOfSnapshots&&a.validationForm.leftPanel.numberOfSnapshots.$invalid&&(a.numberOfSnapshotsValidation=!0,a.numberOfCopiesValidation=!0),a.validationForm.rightPanel.copyGroupName&&a.validationForm.rightPanel.copyGroupName.$invalid&&(a.copyGroupNameValidation=!0),a.dataModel.replicationTechnology===v&&"MONTHLY"===a.dataModel.schedule&&a.validationForm.timePicker.date.$invalid&&(a.dateValidation=!0),a.dataModel.replicationTechnology===v&&"HOURLY"===a.dataModel.schedule&&a.validationForm.timePicker.minute.$invalid&&(a.minuteValidation=!0),a.dataModel.replicationTechnology===v&&"HOURLY"===a.dataModel.schedule&&a.validationForm.timePicker.hourInterval.$invalid&&(a.hourIntervalValidation=!0),a.allUseExisting&&(a.dataModel.submitDisabled=!1),!(a.dataModel.submitDisabled===!0||a.dataModel.replicationTechnology===v&&a.validationForm.leftPanel.numberOfSnapshots&&a.validationForm.leftPanel.numberOfSnapshots.$invalid||a.validationForm.rightPanel.copyGroupName&&a.validationForm.rightPanel.copyGroupName.$invalid||a.dataModel.replicationTechnology===v&&"MONTHLY"===a.dataModel.schedule&&a.validationForm.timePicker.date.$invalid||a.dataModel.replicationTechnology===v&&"HOURLY"===a.dataModel.schedule&&(a.validationForm.timePicker.minute.$invalid||a.validationForm.timePicker.hourInterval.$invalid))){k();var b="",c="",d=!1;if(a.dataModel.comments&&(b=a.dataModel.comments),a.dataModel.copyGroupName&&(c=a.dataModel.copyGroupName),a.dataModel.consistencyGroupNeeded&&(d=a.dataModel.consistencyGroupNeeded),l(),a.dataModel.replicationTechnology===v){var e=[];for(var h in a.arrayVolumeMap){var i=[],n={};if(a.arrayVolumeMap.hasOwnProperty(h)){for(var o in a.arrayVolumeMap[h])if(a.arrayVolumeMap[h].hasOwnProperty(o))if("Use New"===a.arrayVolumeMap[h][o])i.push(parseInt(o));else if(o){var p=n[parseInt(a.arrayVolumeMap[h][o])]||[];p.push(parseInt(o)),n[parseInt(a.arrayVolumeMap[h][o])]=p}var r={name:c,comments:b,consistent:d};r.type=v,r.numberOfCopies=a.dataModel.numberOfCopiesInput,r.primaryVolumeIds=i,r.schedule=j.fromDatePickerToObjectModel(a.dataModel.schedule,a.dataModel.scheduleTime,a.dataModel.scheduleDate,q(),a.dataModel.hourInterval,a.dataModel.scheduleMinute),_.isEmpty(r.primaryVolumeIds)||e.push(g.createReplicationGroup(h,r));for(var s in n)n.hasOwnProperty(s)&&e.push(g.protectVolumes(parseInt(h),parseInt(s),{primaryVolumeIds:n[s]}))}}f.all(e).then(function(){window.history.back()})}else if(a.dataModel.replicationTechnology===w){var t=[];for(var u in a.arrayVolumeMap){var x=[],y={};if(a.arrayVolumeMap.hasOwnProperty(u)){for(var z in a.arrayVolumeMap[u])if(a.arrayVolumeMap[u].hasOwnProperty(z))if("Use New"===a.arrayVolumeMap[u][z])x.push(parseInt(z));else if(z){var A=y[parseInt(a.arrayVolumeMap[u][z])]||[];A.push(parseInt(z)),y[parseInt(a.arrayVolumeMap[u][z])]=A}var B={name:c,comments:b,consistent:d};B.type=w,B.primaryVolumeIds=x,m(B.primaryVolumeIds)||t.push(g.createReplicationGroup(u,B));for(var C in y)y.hasOwnProperty(C)&&t.push(g.protectVolumes(parseInt(u),parseInt(C),{primaryVolumeIds:y[C]}))}}f.all(t).then(function(){window.history.back()})}}},a.$watchCollection("[dataModel.replicationTechnology, dataModel.numberOfSnapshots,dataModel.numberOfCopies, dataModel.consistencyGroupNeeded, dataModel.scheduleTime,dataModel.scheduleDate, dataModel.hourInterval, dataModel.scheduleTimeUnit, dataModel.scheduleTimeHour, dataModel.scheduleTimeMins, dataModel.schedule]",function(b,c){a.dataModel.replicationTechnology===v?a.dataModel.numberOfCopiesInput=a.dataModel.numberOfSnapshots:a.dataModel.numberOfCopiesInput=a.dataModel.numberOfCopies,b!==c&&a.filterCopyGroups(),a.changeSubmitButtonStatus()},!0),a.$watch("dataModel.Days",function(b,c){b!==c&&a.filterCopyGroups(),a.changeSubmitButtonStatus()},!0),a.filterCopyGroups()}a.numberOfSnapshotsValidation=!1,a.copyGroupNameValidation=!1,a.numberOfCopiesValidation=!1,a.dateValidation=!1,a.minuteValidation=!1,a.hourIntervalValidation=!1,a.allUseExisting=!1,a.copyGroupNameRegexp=/^[a-zA-Z0-9_][a-zA-Z0-9-_]*$/,a.decimalNumberRegexp=/^[^.]+$/,a.orderByField="volumeId",a.reverseSort=!1,a.storageSystemIds=[],a.selectBoxName="index",a.filterIndex=1,a.volumesSelected=!1;var n=i.volumesList;n?a.volumesSelected=!0:window.history.back();var o=_.uniq(_.pluck(n,"storageSystemId")),p={},q=_.map(o,function(a){return k.getAllPromises(null,"replication-groups",!0,a,l.transformReplicationGroup).then(function(b){p[a]=b},function(){p[a]=[]})});f.all(q).then(function(){m()})}]),angular.module("rainierApp").controller("replicationGroupActionsConfirmationCtrl",["$scope","orchestratorService","objectTransformService","scrollDataSourceBuilderService","$routeParams","$timeout","ShareDataService",function(a,b,c,d,e,f,g){var h=e.storageSystemId,i=g.replicationGroupAction,j=g.selectedReplicationGroup;i&&j||window.history.back(),b.affectedVolumePairsByReplicationGroup(h,_.first(j).id).then(function(b){_.forEach(b.volumePairs,function(a){c.transformVolumePairs(a)}),a.dataModel={affectedVolumePairs:b.volumePairs,view:"list",pageAction:i,sort:{field:"primaryVolume.id",reverse:!1,setSort:function(b){f(function(){a.dataModel.sort.field===b?a.dataModel.sort.reverse=!a.dataModel.sort.reverse:(a.dataModel.sort.field=b,a.dataModel.sort.reverse=!1)})}}},d.setupDataLoader(a,a.dataModel.affectedVolumePairs)}),a.submitActions=function(){var a,c=_.first(j);switch(i){case"suspend":"Snapshot"===c.type?(a={scheduleEnabled:!1},b.editReplicationGroup(h,c.id,a).then(function(){window.history.back()})):b.suspendReplicationGroup(h,c.id).then(function(){window.history.back()});break;case"resume":"Snapshot"===c.type?(a={scheduleEnabled:!0},b.editReplicationGroup(h,c.id,a).then(function(){window.history.back()})):b.resumeReplicationGroup(h,_.first(j).id).then(function(){window.history.back()});break;case"delete":b.deleteReplicationGroup(h,_.first(j).id).then(function(){window.history.back()})}}}]),angular.module("rainierApp").controller("replicationGroupEditCtrl",["$scope","orchestratorService","objectTransformService","$routeParams","$q","$timeout","cronStringConverterService","ShareDataService","$filter","paginationService","queryService","storageSystemVolumeService",function(a,b,c,d,e,f,g,h,i,j,k,l){function m(){function c(a){var b=!1;if(null===a||void 0===a)return!1;for(var c in a)if(a.hasOwnProperty(c)&&a[c]===!0){b=!0;break}return b}function d(){if(!a.dataModel.schedule||!a.dataModel.schedule.type)return!1;switch(a.dataModel.schedule.type){case"HOURLY":return a.dataModel.schedule.hourInterval&&a.validationForm.timePicker.hourInterval&&void 0!==a.dataModel.schedule.hourStartMinute&&null!==a.dataModel.schedule.hourStartMinute&&a.validationForm.timePicker.hourStartMinute?!a.validationForm.timePicker.hourInterval.$invalid&&!a.validationForm.timePicker.hourStartMinute.$invalid:!1;case"DAILY":return!!a.dataModel.schedule.time;case"WEEKLY":return a.dataModel.schedule.time&&a.dataModel.schedule.days&&c(a.dataModel.schedule.days);case"MONTHLY":return a.dataModel.schedule.date&&a.validationForm.timePicker.date?a.dataModel.schedule.time&&!a.validationForm.timePicker.date.$invalid:!1;default:return!0}}function h(){if(!a.dataModel.replicationName||a.validationForm.rightPanel.numberOfSnapshots.$invalid)return!1;if(a.dataModel.schedule&&a.dataModel.schedule.type&&"MONTHLY"===a.dataModel.schedule.type&&a.validationForm.timePicker.date&&a.validationForm.timePicker.date.$invalid)return!1;if(a.dataModel.schedule&&a.dataModel.schedule.type&&"HOURLY"===a.dataModel.schedule.type&&(a.validationForm.timePicker.hourStartMinute&&a.validationForm.timePicker.hourStartMinute.$invalid||a.validationForm.timePicker.hourInterval&&a.validationForm.timePicker.hourInterval.$invalid))return!1;if(a.dataModel.schedule&&a.dataModel.schedule.type&&"WEEKLY"===a.dataModel.schedule.type&&!c(a.dataModel.schedule.days))return!1;var b=a.dataModel.schedule?g.fromDatePickerToObjectModel(a.dataModel.schedule.type,a.dataModel.schedule.time,a.dataModel.schedule.date,a.dataModel.schedule.days,a.dataModel.schedule.hourInterval,a.dataModel.schedule.hourStartMinute):o.schedule;return a.dataModel.replicationName!==o.name||a.dataModel.comments!==("N/A"!==o.comments?o.comments:"")||a.dataModel.numberOfSnapshots!==o.numberOfCopies||d()&&!g.isEqualForObjectModel(b,o.schedule)||a.anyPrimaryVolumeSelected}a.dataModel={schedule:o.schedule?g.fromObjectModelToDatePicker(o.schedule):null,comments:o.comments&&"N/A"!==o.comments?o.comments:"",numberOfSnapshots:o.numberOfCopies?o.numberOfCopies:null,removeSecondaryVolume:!0,primaryVolumesOpen:!1,noPrimaryVolume:!!_.isEmpty(p),primaryVolumes:_.sortBy(p,"id"),replicationType:o.type,replicationName:o.name,replicationConsistency:o.consistent,sort:{field:"id",reverse:!1,setSort:function(b){f(function(){a.dataModel.sort.field===b?a.dataModel.sort.reverse=!a.dataModel.sort.reverse:(a.dataModel.sort.field=b,a.dataModel.sort.reverse=!1)})}}},a.canSubmit=function(){return"Clone"===a.dataModel.replicationType?a.anyPrimaryVolumeSelected&&a.dataModel.replicationName||a.dataModel.replicationName&&a.dataModel.replicationName!==o.name||a.dataModel.replicationName&&a.dataModel.comments!==("N/A"!==o.comments?o.comments:""):"Snapshot"===a.dataModel.replicationType?h():void 0},a.$watch("dataModel.primaryVolumes",function(b,c){if(b&&c&&b!==c){for(var d=!1,e=!0,f=0;f<a.dataModel.primaryVolumes.length;++f)a.dataModel.primaryVolumes[f].selected&&(d=!0),a.dataModel.primaryVolumes[f].selected||(e=!1);a.anyPrimaryVolumeSelected=d,a.allPrimaryVolumeSelected=e}},!0),a.$watch("dataModel.sort",function(){a.dataModel&&(a.dataModel.primaryVolumes=i("orderBy")(a.dataModel.primaryVolumes,a.dataModel.sort.field,a.dataModel.sort.reverse))},!0),a.submitActions=function(){if("Clone"===a.dataModel.replicationType){var c=[],d={};if(a.dataModel.comments!==("N/A"!==o.comments?o.comments:"")&&(d.comments=a.dataModel.comments),a.dataModel.replicationName&&a.dataModel.replicationName!==o.name&&(d.name=a.dataModel.replicationName),_.isEmpty(d)||c.push(b.editReplicationGroup(n,o.id,d)),a.anyPrimaryVolumeSelected){var f=[];_.forEach(a.dataModel.primaryVolumes,function(a){a.selected&&f.push(a.id)});var h={primaryVolumeIds:f,deleteSecondaryVolume:a.dataModel.removeSecondaryVolume};c.push(b.unprotectReplicationGroup(n,o.id,h))}e.all(c).then(function(){window.history.back()})}if("Snapshot"===a.dataModel.replicationType){var i=[];if(a.anyPrimaryVolumeSelected){var j=[];_.forEach(a.dataModel.primaryVolumes,function(a){a.selected&&j.push(a.id)});var k={primaryVolumeIds:j,deleteSecondaryVolume:a.dataModel.removeSecondaryVolume};i.push(b.unprotectReplicationGroup(n,o.id,k))}var l={};a.dataModel.replicationName&&a.dataModel.replicationName!==o.name&&(l.name=a.dataModel.replicationName),a.dataModel.comments!==("N/A"!==o.comments?o.comments:"")&&(l.comments=a.dataModel.comments),a.dataModel.numberOfSnapshots!==o.numberOfCopies&&(l.numberOfCopies=a.dataModel.numberOfSnapshots);var m=a.dataModel.schedule?g.fromDatePickerToObjectModel(a.dataModel.schedule.type,a.dataModel.schedule.time,a.dataModel.schedule.date,a.dataModel.schedule.days,a.dataModel.schedule.hourInterval,a.dataModel.schedule.hourStartMinute):null;null===m||g.isEqualForObjectModel(m,o.schedule)||(l.schedule=m),_.isEmpty(l)||i.push(b.editReplicationGroup(n,o.id,l)),e.all(i).then(function(){window.history.back()})}}}var n=d.storageSystemId,o=_.first(h.selectedReplicationGroup),p=[];a.anyPrimaryVolumeSelected=!1,a.allPrimaryVolumeSelected=!1,a.validationForm={},o||window.history.back(),_.forEach(o.primaryVolumeIds,function(a){p.push({id:a,label:"N/A",numberOfSecondaryVolume:"N/A",primaryStorageSystemId:o.storageSystemId,selected:!1})});var q=_.map(p,function(a){return b.volume(n,parseInt(a.id)).then(function(b){return a.label=b.label,j.clearQuery(),k.setQueryMapEntry("replicationGroup",o.name.toString()),k.setQueryMapEntry("primaryVolume.id",parseInt(a.id)),j.get(null,l.VOLUME_PAIRS_PATH,null,!1,n)}).then(function(b){a.numberOfSecondaryVolume=b.total})});e.all(q).then(function(){m()})}]),angular.module("rainierApp").controller("ReplicationGroupsCtrl",["$scope","$routeParams","$timeout","$location","$q","orchestratorService","objectTransformService","scrollDataSourceBuilderService","synchronousTranslateService","ShareDataService","dataProtectionSettingsService","replicationGroupsService","scrollDataSourceBuilderServiceNew","ReplicationGroupSInitialResult","queryService","paginationService","storageSystemVolumeService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){var r=b.storageSystemId;f.dataProtectionSummaryForStorageSystem(r).then(function(b){var c=g.transformToBreakdownSummary(b);c.arrayDataVisualizationModel.hideButtons=!0,c.title=i.translate("common-replication-groups"),a.summaryModel=c}),l.getReplicationGroups(null,r,"initialResult").then(function(b){n.cloneExternalVolumePairExist&&b.resources.push(new l.ExternalReplicationGroup("Clone")),n.snapshotExternalVolumePairExist&&b.resources.push(new l.ExternalReplicationGroup("Snapshot")),a.replicationGroups=b.resources;var d={storageSystemId:r,singleView:!0,view:"list",onlyOperation:!0,noAlerts:!0,noIcon:!0,replicationGroups:a.replicationGroups,allItemsSelected:!1,enableRestore:!1,noVolumePairSelected:!0,nextToken:b.nextToken,total:b.total,childrenToken:null,busy:!1,busyLoadingMoreChildren:!1,currentPageCount:0,displayList:b.resources,sort:{field:"id",reverse:!1,setSort:function(b){c(function(){a.dataModel.sort.field===b?(o.setSort(b,!a.dataModel.sort.reverse),a.dataModel.sort.reverse=!a.dataModel.sort.reverse):(a.dataModel.sort.field=b,o.setSort(b,!1),a.dataModel.sort.reverse=!1),p.getQuery(q.REPLICATION_GROUPS_PATH,g.transformReplicationGroup,r).then(function(b){a.filterModel.updateResultAndTokenAndCounts(b)})})}},fetchFirstPageChildren:function(b){l.getVolumePairsForOneReplicationGroup(null,r,b).then(function(c){_.forEach(c.resources,function(a){g.transformVolumePairs(a)}),b.volumePairs=c.resources,a.dataModel.childrenToken=c.nextToken}),p.clearQuery()},loadMoreChildren:function(b){b.hasOwnProperty("volumePairs")&&b.volumePairs.length>=p.PAGE_SIZE&&null!==a.dataModel.childrenToken&&!a.dataModel.busyLoadingMoreChildren&&(a.dataModel.busyLoadingMoreChildren=!0,l.getVolumePairsForOneReplicationGroup(a.dataModel.childrenToken,r,b).then(function(c){b.volumePairs=b.volumePairs.concat(c.resources),a.dataModel.childrenToken=c.nextToken,a.dataModel.busyLoadingMoreChildren=!1}))}},e=[{icon:"icon-edit",tooltip:"action-tooltip-edit-replication-groups",type:"link",enabled:function(){return d.onlyOneSelected()&&d.noVolumePairSelected},onClick:function(){a.replicationGroupEdit(d.getSelectedItems())}},{icon:"icon-pause",tooltip:"action-tooltip-suspend-replication-groups",type:"link",enabled:function(){return d.onlyOneSelected()&&d.noVolumePairSelected},onClick:function(){a.replicationGroupSuspendResumeDelete("suspend",d.getSelectedItems())}},{icon:"icon-play",tooltip:"action-tooltip-resume-replication-groups",type:"link",enabled:function(){return d.onlyOneSelected()&&d.noVolumePairSelected},onClick:function(){a.replicationGroupSuspendResumeDelete("resume",d.getSelectedItems())}},{icon:"icon-delete",tooltip:"action-tooltip-delete-replication-groups",type:"link",enabled:function(){return d.onlyOneSelected()&&d.noVolumePairSelected},onClick:function(){a.replicationGroupSuspendResumeDelete("delete",d.getSelectedItems())}},{icon:"icon-refresh",tooltip:"action-tooltip-restore-replication-groups",type:"confirm",confirmTitle:"replication-group-actions-restore-confirmation-title",confirmMessage:"replication-group-actions-restore-confirmation-message",onClick:function(){a.replicationGroupRestore()},enabled:function(){return!d.anySelected()&&d.enableRestore}}];d.getActions=function(){return e},d.getResources=function(){return l.getReplicationGroups(a.dataModel.nextToken,r)},k.setReplicationGroupGridSettings(d),a.dataModel=d,m.setupDataLoader(a,a.replicationGroups),k.setDataModelFunctions(a),k.setReplicationGroupActions(a,r),a.filterModel={filter:{freeText:"",type:""},updateResultAndTokenAndCounts:function(b){a.dataModel.nextToken=b.nextToken,a.dataModel.displayList=b.resources,a.dataModel.itemCounts={filtered:a.dataModel.displayList.length,total:a.dataModel.total}},queryGenerationFunctions:{setTypeSearch:l.setTypeSearch,setTextSearch:l.setTextSearch},newSortOrFilterRequest:function(b){b(a.filterModel.filter),l.getSortedAndFilteredReplicationGroups(r).then(function(b){a.filterModel.updateResultAndTokenAndCounts(b)})}}})}]),angular.module("rainierApp").controller("SecurityCtrl",["$scope","$q","$timeout","orchestratorService",function(a,b,c,d){function e(b){var c={accountDomain:b,groupMappingModel:null};c.save=function(){if(c.accountDomain&&c.accountDomain.id){var a={username:c.accountDomain.username,password:c.accountDomain.password};d.updateAccountDomain(c.accountDomain.id,a).then(function(){window.history.back()})}else{var b={domain:c.accountDomain.domain,username:c.accountDomain.username,password:c.accountDomain.password};d.addAccountDomain(b).then(function(){window.history.back()})}},c.remove=function(){d.deleteAccountDomain(c.accountDomain.id).then(function(){window.history.back()})},c.canSave=function(){return c.accountDomain&&!_.isEmpty(c.accountDomain.domain)&&!_.isEmpty(c.accountDomain.username)&&!_.isEmpty(c.accountDomain.password)},a.dataModel=c,null!==b&&g(b.id)}function f(){d.accountDomains().then(function(a){var b=null;_.forEach(a.accountDomains,function(a){return"ACTIVE_DIRECTORY"===a.type?(b=a,!1):void 0}),e(b)})}a.$watch("dataModel.accountDomain.id",function(a){g(a)}),a.$watch("dataModel.groupMappingModel.mappings",function(b){if(a.dataModel&&a.dataModel.groupMappingModel){var c=!1,d=!1;_.forEach(b,function(a){a.deleted?d=!0:a.added&&(c=!0)});var e=!1;e=c?c:d,a.dataModel.groupMappingModel.canSubmit=e,a.dataModel.cannotDelete=_.some(b,"id")}},!0),f();var g=function(e){e&&d.groupMappings(e).then(function(f){var h=[],i={roles:["StorageAdministrator","SystemAdministrator","SecurityAdministrator"],deleted:!1,added:!1};_.forEach(f.mappings,function(a){var b=_.cloneDeep(i);angular.extend(b,a),b.readOnly=!0,b["delete"]=function(){b.deleted=!0},h.push(b)});var j={mappings:h,getUserGroups:function(a){return d.userGroups(e,a).then(function(a){return a.groups})},addMapping:function(a){if(!(h.length>0&&(_.isEmpty(h[0].groupName)||_.isEmpty(h[0].userRole)))){var b=_.cloneDeep(i);b["delete"]=function(){c(function(){_.remove(h,function(a){return a===b})})},!a&&h.length>0&&h[0].added===!1&&(h[0].added=!0,h[0].readOnly=!0),h.splice(0,0,b)}}};j.reset=function(){g(e)},j.submit=function(){var a,c=[],f=[];for(a=1;a<j.mappings.length;a++){var g=j.mappings[a];g.deleted?c.push(d.deleteGroupMapping(g.accountDomainId,g.id)):g.added&&f.push(g)}_.forEach(f,function(a){var b={groupName:a.groupName,userRole:a.userRole};c.push(d.addGroupMapping(e,b))}),0!==c.length&&b.all(c).then(function(){window.history.back()})},j.addMapping(!0),a.dataModel.groupMappingModel=j})}}]),angular.module("rainierApp").controller("ShareCtrl",["$scope","$routeParams","$timeout","$filter","diskSizeService","fileSystemService","orchestratorService","objectTransformService","synchronousTranslateService","scrollDataSourceBuilderService","$location",function(a,b,c,d,e,f,g,h,i,j,k){function l(){g.enterpriseVirtualServer(n,m.evsUuid).then(function(b){var d={},e={file:!0,title:i.translate("share")+" "+p,storageSystemId:n,view:"tile",allItemsSelected:!1,share:m,onlyOperation:!0,evsIp:_.first(b.interfaceAddresses).ip,userGroups:m.permissions.length,search:{permission:null},sort:{field:"usageBare",reverse:!0,setSort:function(b){c(function(){a.dataModel.sort.field===b?a.dataModel.sort.reverse=!a.dataModel.sort.reverse:(a.dataModel.sort.field=b,a.dataModel.sort.reverse=!1)})}}},f=[{icon:"icon-delete",tooltip:"action-tooltip-delete",type:"confirm",confirmTitle:"share-delete-confirmation",confirmMessage:"share-delete-selected-content",enabled:function(){return!0},onClick:function(){g.deleteShare(n,o,p)}},{icon:"icon-edit",tooltip:"action-tooltip-edit",type:"link",enabled:function(){return!0},onClick:function(){k.path(["storage-systems",n,"file-systems",o,"shares",p,"update"].join("/"))}}];d.getActions=function(){return f},e.gridSettings=[{title:"Group Name",sizeClass:"sixth",sortField:"groupName",getDisplayValue:function(a){return a.groupName},type:"id"},{title:"Permission Type",sizeClass:"quarter",sortField:"permissionDisplay",getDisplayValue:function(a){return a.permissionDisplay}}],a.dataModel=e,a.summaryModel=d,a.dataModel.permissions=_.uniq(_.map(m.permissions,function(a){return _.first(a.metaData).detailsNoSlash[1]})),j.setupDataLoader(a,m.permissions,"permissionsSearch")})}var m,n=b.storageSystemId,o=b.fileSystemId,p=b.shareId;g.share(n,o,p).then(function(a){m=a,l()},function(){g.allShares(n).then(function(a){m=_.find(a.shares,function(a){return a.fileSystemId===o&&a.id===p}),l()})})}]),angular.module("rainierApp").controller("SharesExportsAddCtrl",["$scope","$routeParams","orchestratorService",function(a,b,c){var d=b.storageSystemId,e=b.fileSystemId;c.fileSystems(d).then(function(b){var f={validationForm:{label:"",path:""},storageSystemId:d,fileSystems:b.fileSystems,fileSystem:_.find(b.fileSystems,function(a){return e===a.id}),fileSystemSelectable:_.isUndefined(e),label:"",fileSystemPath:"\\HSA",windows:"true"};a.dataModel=f,a.dataModel.canSubmit=function(){return a.dataModel.validationForm.label.$valid&&a.dataModel.validationForm.fileSystemPath.$valid&&a.dataModel.fileSystem},a.dataModel.submit=function(){var b={};b.fileSystemPath=a.dataModel.fileSystemPath,b.fileSystemId=a.dataModel.fileSystem.id,a.dataModel.windows?(b.shareName=a.dataModel.label,c.addShare(d,b).then(function(){window.history.back()})):(b.exportName=a.dataModel.label,c.addExport(d,b).then(function(){window.history.back()}))}})}]),angular.module("rainierApp").controller("SharesExportsCtrl",["$scope","$routeParams","$timeout","$filter","orchestratorService","objectTransformService","synchronousTranslateService","scrollDataSourceBuilderService","$location",function(a,b,c,d,e,f,g,h,i){function j(b){var d={file:!0,title:g.translate("common-storage-system-shares-exports"),storageSystemId:l,allEvsPage:!0,view:"tile",evsIds:_.uniq(_.map(b,function(a){return a.evsId})),allItemsSelected:!1,search:{freeText:"",type:null,filterEvs:""},sort:{field:"usageBare",reverse:!0,setSort:function(b){c(function(){a.dataModel.sort.field===b?a.dataModel.sort.reverse=!a.dataModel.sort.reverse:(a.dataModel.sort.field=b,a.dataModel.sort.reverse=!1)})}}},f=[{icon:"icon-delete",tooltip:"action-tooltip-delete",type:"confirm",confirmTitle:"shares-exports-delete-confirmation",confirmMessage:"shares-exports-delete-selected-content",enabled:function(){return a.dataModel.anySelected()},onClick:function(){_.forEach(a.dataModel.getSelectedItems(),function(a){"Share"===a.type?e.deleteShare(l,a.fileSystemId,a.id):e.deleteExport(l,a.fileSystemId,a.id)})}},{icon:"icon-edit",tooltip:"action-tooltip-edit",type:"link",enabled:function(){return a.dataModel.onlyOneSelected()},onClick:function(){var b=_.first(a.dataModel.getSelectedItems());i.path(["storage-systems",l,"file-systems",b.fileSystemId,b.urlType,b.id,"update"].join("/"))}}];d.getActions=function(){return f},d.gridSettings=[{title:"Name",sizeClass:"twelfth",sortField:"name",getDisplayValue:function(a){return a.name}},{title:"Type",sizeClass:"twelfth",sortField:"type",getDisplayValue:function(a){return a.type}},{title:"Path",sizeClass:"quarter",sortField:"fileSystemPath",getDisplayValue:function(a){return a.fileSystemPath}}],d.addAction=function(){i.path(["storage-systems",l,"shares-exports","add"].join("/"))},a.dataModel=d,h.setupDataLoader(a,b,"sharesExportsSearch")}var k,l=b.storageSystemId;e.allShares(l).then(function(a){return k=a.shares,e.allExports(l)},function(){j([])}).then(function(a){var b=k.concat(a.exports);j(b)},function(){j([])})}]),angular.module("rainierApp").controller("SharesUpdateCtrl",["$scope","$timeout","$routeParams","orchestratorService","scrollDataSourceBuilderService",function(a,b,c,d,e){var f=c.storageSystemId,g=c.fileSystemId,h=c.shareId;d.share(f,g,h,!0).then(function(c){var i={validationForm:{label:"",fileSystemPath:""},accessConfigurationForm:{accessConfiguration:""},permission:{allow:[!1,!1,!1],deny:[!1,!1,!1]},singleView:!0,view:"tile",allItemsSelected:!1,share:c,search:{permission:null},sort:{field:"usageBare",reverse:!0,setSort:function(c){b(function(){a.dataModel.sort.field===c?a.dataModel.sort.reverse=!a.dataModel.sort.reverse:(a.dataModel.sort.field=c,a.dataModel.sort.reverse=!1)})}}};a.dataModel=i,a.dataModel.canSubmit=function(){return a.dataModel.validationForm.label.$valid&&a.dataModel.validationForm.fileSystemPath.$valid&&a.dataModel.accessConfigurationForm.accessConfiguration.$valid&&(a.dataModel.validationForm.label.$dirty||a.dataModel.validationForm.fileSystemPath.$dirty||a.dataModel.accessConfigurationForm.accessConfiguration.$dirty)||a.dataModel.anySelected()},a.dataModel.change=function(b,c){var d=a.dataModel.permission.deny;b&&(d=a.dataModel.permission.allow);var e=[!1,!1,!1];d="full"===c?[!0,!0,!0]:"change"===c?d[1]?[!1,!1,d[2]]:[!1,!0,!0]:d[2]?[!1,!1,!1]:[!1,!1,!0],b?(a.dataModel.permission.allow=d,a.dataModel.permission.deny=e):(a.dataModel.permission.deny=d,a.dataModel.permission.allow=e)},a.dataModel.submit=function(){var b=a.dataModel,c=[];_.forEach(b.getSelectedItems(),function(a){a.permissionType.allowFullControl=b.permission.allow[0],a.permissionType.allowRead=b.permission.allow[2],a.permissionType.allowChange=b.permission.allow[1],a.permissionType.denyFullControl=b.permission.deny[0],a.permissionType.denyRead=b.permission.deny[2],a.permissionType.denyChange=b.permission.deny[1],c.push({groupName:a.name,permissionType:a.permissionType})});var e={fileSystemPath:b.share.fileSystemPath,accessConfiguration:b.share.accessConfiguration,permissions:c};0===c.length&&(e={fileSystemPath:b.share.fileSystemPath,accessConfiguration:b.share.accessConfiguration}),d.patchShare(f,g,h,e).then(function(){
window.history.back()})},a.dataModel.permissions=_.uniq(_.map(a.dataModel.share.permissions,function(a){return _.first(a.metaData).detailsNoSlash[1]})),e.setupDataLoader(a,a.dataModel.share.permissions,"permissionsSearch")})}]),angular.module("rainierApp").controller("SnmpManagerAddCtrl",["$scope","$window","orchestratorService",function(a,b,c){function d(a){var b={snmpManagers:[]};return _.forEach(a,function(a){b.snmpManagers.push({name:a.name,username:a.username,ipAddress:a.ipAddress,authProtocol:a.authProtocol,authPassword:"NO_AUTH"===a.authProtocol?null:a.authPassword,privacyProtocol:a.privacyProtocol,privacyPassword:"NO_PRIV"===a.privacyProtocol?null:a.privacyPassword,port:a.port})}),b}var e={snmpManager:{authProtocol:"NO_AUTH",privacyProtocol:"NO_PRIV"},authProtocols:c.authProtocols(),privacyProtocols:c.privacyProtocols()};e.canSubmit=function(){var a=!(_.isEmpty(e.snmpManager.ipAddress)||_.isEmpty(e.snmpManager.port)||_.isEmpty(e.snmpManager.name)||_.isEmpty(e.snmpManager.username));if(a){if("NO_PRIV"!==e.snmpManager.privacyProtocol&&_.isEmpty(e.snmpManager.privacyPassword))return!1;if("NO_AUTH"!==e.snmpManager.authProtocol&&_.isEmpty(e.snmpManager.authPassword))return!1;if("NO_PRIV"!==e.snmpManager.privacyProtocol&&"NO_AUTH"===e.snmpManager.authProtocol)return!1}return a},e.submit=function(){var a=d([e.snmpManager]);c.addSnmpManager(a).then(function(){window.history.back()})},a.dataModel=e}]),angular.module("rainierApp").controller("SnmpManagerUpdateCtrl",["$scope","$routeParams","$window","orchestratorService",function(a,b,c,d){var e=b.name,f={authProtocols:d.authProtocols(),privacyProtocols:d.privacyProtocols()};d.snmpManager(e).then(function(a){f.snmpManager=a,f.snmpManager.originalIpAddress=a.ipAddress,f.snmpManager.originalPort=a.port,f.snmpManager.originalUsername=a.username,f.snmpManager.originalPrivacyProtocol=a.privacyProtocol,f.snmpManager.originalAuthProtocol=a.authProtocol}),f.canSubmit=function(){if(!f.snmpManager)return!1;var a=!_.isEmpty(f.snmpManager.ipAddress)&&f.snmpManager.port&&!_.isEmpty(f.snmpManager.username);if(a){if("NO_PRIV"!==f.snmpManager.privacyProtocol&&_.isEmpty(f.snmpManager.privacyPassword))return!1;if("NO_AUTH"!==f.snmpManager.authProtocol&&_.isEmpty(f.snmpManager.authPassword))return!1;if("NO_PRIV"!==f.snmpManager.privacyProtocol&&"NO_AUTH"===f.snmpManager.authProtocol)return!1}return a},f.submit=function(){var a={ipAddress:f.snmpManager.originalIpAddress!==f.snmpManager.ipAddress?f.snmpManager.ipAddress:null,port:f.snmpManager.originalPort!==f.snmpManager.port?f.snmpManager.port:null,username:f.snmpManager.originalUsername!==f.snmpManager.username?f.snmpManager.username:null,privacyProtocol:f.snmpManager.privacyProtocol,privacyPassword:"NO_PRIV"===f.snmpManager.privacyProtocol?null:f.snmpManager.privacyPassword,authProtocol:f.snmpManager.authProtocol,authPassword:"NO_AUTH"===f.snmpManager.authProtocol?null:f.snmpManager.authPassword};d.updateSnmpManager(f.snmpManager.name,a).then(function(){window.history.back()})},a.dataModel=f}]),angular.module("rainierApp").controller("SnmpManagerCtrl",["$scope","$timeout","$location","$window","orchestratorService","objectTransformService","synchronousTranslateService","scrollDataSourceBuilderService",function(a,b,c,d,e,f,g,h){function i(d){var f=d.snmpManagerInformationList?d.snmpManagerInformationList:[];_.forEach(f,function(a){a.itemIcon="icon-snmp",a.metaData=[{left:!0,title:a.name,details:[a.ipAddress,a.username,a.privacyProtocol,a.authProtocol]},{left:!1,title:"PORT",details:[a.port]}]});var i={view:"tile",title:g.translate("snmp-managers"),noAlerts:!1,displayPrompt:!1,allItemsSelected:!1,authProtocols:e.authProtocols(),privacyProtocols:e.privacyProtocols(),search:{freeText:""},sort:{field:"name",reverse:!1,setSort:function(c){b(function(){a.dataModel.sort.field===c?a.dataModel.sort.reverse=!a.dataModel.sort.reverse:(a.dataModel.sort.field=c,a.dataModel.sort.reverse=!1)})}}},j=[{icon:"icon-edit",type:"link",enabled:function(){return i.onlyOneSelected()},onClick:function(){a.updateSelected()}},{icon:"icon-delete",type:"confirm",tooltip:"action-tooltip-delete",confirmTitle:"snmp-manager-delete-confirmation",confirmMessage:"snmp-manager-delete-selected-content",enabled:function(){return i.anySelected()},onClick:function(){_.forEach(i.getSelectedItems(),function(a){e.deleteSnmpManager(a.name)})}}];i.getActions=function(){return j},i.addAction=function(){c.path(["snmp-managers","add"].join("/"))},i.gridSettings=[{title:"Name",sizeClass:"sixth",sortField:"name",getDisplayValue:function(a){return a.name}},{title:"IP Address",sizeClass:"sixth",sortField:"ipAddress",getDisplayValue:function(a){return a.ipAddress}},{title:"Username",sizeClass:"sixth",sortField:"username",getDisplayValue:function(a){return a.username}},{title:"Auth Protocol",sizeClass:"twelfth",sortField:"authProtocol",getDisplayValue:function(a){return a.authProtocol}},{title:"Privary Protocol",sizeClass:"twelfth",sortField:"privacyProtocol",getDisplayValue:function(a){return a.privacyProtocol}},{title:"Port",sizeClass:"twelfth center-content",sortField:"port",getDisplayValue:function(a){return a.port}}],a.dataModel=i,0===f.length&&(a.dataModel.displayPrompt=!0),h.setupDataLoader(a,f,"snmpManagerSearch")}e.snmpManagers().then(function(a){i(a)}),a.updateSelected=function(){for(var b,c=0;c<a.dataModel.filteredList.length;++c)if(b=a.dataModel.filteredList[c],b.selected){d.location.href="#/snmp-managers/"+b.name+"/update";break}}}]),angular.module("rainierApp").controller("StoragePoolUpdateCtrl",["$scope","$routeParams","$timeout","orchestratorService","diskSizeService","storagePoolService",function(a,b,c,d,e,f){function g(){var b=[];return _.forEach(a.model.selectedTiers,function(a){var c=0;a.currentCapacity&&a.selectedSize.diskSize.value<=a.currentCapacity||(c=a.currentCapacity&&a.selectedSize.diskSize.value>a.currentCapacity?a.selectedSize.diskSize.value-a.currentCapacity:a.selectedSize.diskSize.value,b.push({name:a.name,sizeToUseInBytes:c}))}),b}function h(b){a.dataVizModel=f.dataVizModelForBasic(a.model,b,a.tierKeys,e)}function i(a){a&&a.unlimited===!0&&(a.value=null)}function j(b){a.dataVizModel=f.dataVizModelForAdvanced(a.model,b,e)}var k=b.storageSystemId,l=b.storagePoolId;d.storagePool(k,l).then(function(b){a.model=b,a.model.originalLabel=b.label,a.model.originalPoolType=b.type,a.model.poolType=b.type,a.model.availablePoolTypes=[b.type],a.model.wizardType="basic",a.model.originalHtiPool="HTI"===b.type,a.model.htiPool=a.model.originalHtiPool,a.model.originalUtilizationThreshold1=a.model.utilizationThreshold1,a.model.originalUtilizationThreshold2=a.model.utilizationThreshold2,a.model.originalSubscriptionLimit={unlimited:b.subscriptionLimit.unlimited,value:b.subscriptionLimit.value},a.model.templateSubscriptionLimit={},a.model.originalTemplateSubscriptionLimit={},a.model.hasHdpLicense=!1,a.model.hasHdtLicense=!1,a.model.hasHtiLicense=!1,a.model.hasActiveFlashLicense=b.activeFlashEnabled,a.model.originalActiveFlashEnabled=!1,d.parityGroups(k).then(function(c){a.model.parityGroups=f.filterParityGroups(c.parityGroups);var d=_.chain(a.model.parityGroups);a.model.diskTypes=d.pluck(function(a){return a.diskSpec.type}).uniq().value(),a.model.raidLayouts=d.pluck("raidLayout").uniq().value(),a.model.raidLevels=d.pluck("raidLevel").uniq().value(),a.model.diskSpeeds=d.pluck(function(a){return a.diskSpec.speed}).uniq().value(),a.model.diskSpeeds=_.map(a.model.diskSpeeds,function(a){return""===a&&(a="0"),a}),a.model.diskSpeeds.sort();var e=null,g=null,h=null,i=null,j=!1,k=[],l=[];_.forEach(a.model.parityGroups,function(a){_.contains(b.parityGroupIds,a.parityGroupId)?(e||g||h||i?e===a.diskSpec.type&&g===a.raidLayout&&h===a.raidLevel&&i===a.diskSpec.speed||(j=!1):(e=a.diskSpec.type,g=a.raidLayout,h=a.raidLevel,i=a.diskSpec.speed,j=!0),a.selected=!0,a.inuse=!0,l.push(a)):"AVAILABLE"!==a.status&&"FORMATTING"!==a.status||(a.selected=!1,a.inuse=!1,k.push(a))}),a.model.inUseParityGroups=l,a.model.parityGroups=k,a.model.search=j?{freeText:"",diskSpec:{type:e,speed:i},raidLayout:g,raidLevel:h}:{freeText:"",diskSpec:{type:null,speed:null},raidLayout:null,raidLevel:null}}),d.tiers().then(function(b){a.tierKeys=_.pluck(b.tiers,"tier")}),d.getUpdatePoolTemplate(k,l).then(function(b){a.model.poolTemplate=b,a.model.templateUtilizationThreshold1=parseInt(b.utilizationThreshold1),a.model.templateUtilizationThreshold2=parseInt(b.utilizationThreshold2),a.model.originalTemplateUtilizationThreshold1=a.model.templateUtilizationThreshold1,a.model.originalTemplateUtilizationThreshold2=a.model.templateUtilizationThreshold2,a.model.templateSubscriptionLimit={unlimited:b.subscriptionLimit.unlimited,value:b.subscriptionLimit.value},a.model.originalTemplateSubscriptionLimit=b.subscriptionLimit}),d.licenses(k).then(function(b){_.forEach(b.licenseSettings,function(b){"ACTIVE FLASH"===b.productName.toUpperCase()&&b.installed===!0?a.model.hasActiveFlashLicense=!0:"DYNAMIC TIERING"===b.productName.toUpperCase()&&b.installed===!0&&(1===a.model.availablePoolTypes.length&&"HDP"===a.model.availablePoolTypes[0]&&a.model.availablePoolTypes.push("HDT"),a.model.hasHdtLicense=!0)})}),a.payload={submit:function(){var b=a.model.originalLabel===a.model.label?null:a.model.label;if("basic"===a.model.wizardType){var c=g(),e={htiPool:a.model.htiPool,label:b,utilizationThreshold1:a.model.templateUtilizationThreshold1,utilizationThreshold2:a.model.templateUtilizationThreshold2,subscriptionLimit:a.model.templateSubscriptionLimit,poolTemplateSubTiers:c};d.updatePoolTemplate(k,l,e).then(function(){window.history.back()})}else{var f={label:b,activeFlashEnabled:a.model.activeFlashEnabled===a.model.originalActiveFlashEnabled?null:a.model.activeFlashEnabled,poolType:a.model.poolType===a.model.originalPoolType?null:a.model.poolType,utilizationThreshold1:a.model.utilizationThreshold1,utilizationThreshold2:a.model.utilizationThreshold2,subscriptionLimit:a.model.subscriptionLimit,parityGroupIds:0===a.model.selectedParityGroups.length?null:a.model.selectedParityGroups};d.updateStoragePool(k,l,f).then(function(){window.history.back()})}},isValid:function(){return a.model?"basic"===a.model.wizardType?a.model.originalLabel!==a.model.label||g().length>0||a.model.originalHtiPool!==a.model.htiPool||a.model.templateUtilizationThreshold1!==a.model.originalTemplateUtilizationThreshold1||a.model.templateUtilizationThreshold2!==a.model.originalTemplateUtilizationThreshold2||a.model.templateSubscriptionLimit.unlimited!==a.model.originalTemplateSubscriptionLimit.unlimited||a.model.templateSubscriptionLimit.value!==a.model.originalTemplateSubscriptionLimit.value:a.model.originalLabel!==a.model.label||a.model.selectedParityGroups.length>0||a.model.originalPoolType!==a.model.poolType||a.model.utilizationThreshold1!==a.model.originalUtilizationThreshold1||a.model.utilizationThreshold2!==a.model.originalUtilizationThreshold2||a.model.subscriptionLimit.unlimited!==a.model.originalSubscriptionLimit.unlimited||a.model.subscriptionLimit.value!==a.model.originalSubscriptionLimit.value:!1}}}),a.$watchGroup(["model.poolTemplate","model.wizardType"],function(b){f.watchTemplateTypeWizard(a.model,b,e,!0)}),a.$watch("model.diskSizesByTier",h,!0),a.$watch("model.subscriptionLimit",i,!0),a.$watch("model.templateSubscriptionLimit",i,!0),a.$watchGroup(["model.wizardType"],function(b){var c=b[0];c&&("advanced"===c?(a.model.selectedParityGroup=null,a.model.search={freeText:"",diskSpec:{type:null,speed:null},raidLayout:null,raidLevel:null},j(a.model.parityGroups)):"basic"===c&&h(a.model.diskSizesByTier))}),a.$watch("model.parityGroups",j,!0)}]),angular.module("rainierApp").controller("StoragePoolCtrl",["$scope","$routeParams","$window","orchestratorService","objectTransformService","diskSizeService",function(a,b,c,d,e,f){function g(a){return a+"%"}function h(a,b){return a+":"+b}function i(a){return a.size+" "+a.unit}var j=b.storageSystemId,k=b.storagePoolId;d.storagePool(j,k).then(function(b){var c=e.transformToPoolSummaryModel(b);c.title="Storage pool "+k,c.noBreakdown=!0,a.summaryModel=c,b.orchestratorService=d,b.actionsList=_.map(b.actions),b.utilizationThreshold1=g(b.utilizationThreshold1),b.utilizationThreshold2=g(b.utilizationThreshold2),b.subscriptionLimit.value=g(b.subscriptionLimit.value),b.physicalCapacityInBytes=i(f.getDisplaySize(b.physicalCapacityInBytes)),b.usedPhysicalCapacityInBytes=i(f.getDisplaySize(b.usedPhysicalCapacityInBytes)),b.availablePhysicalCapacityInBytes=i(f.getDisplaySize(b.availablePhysicalCapacityInBytes)),b.expansionRate=h(1,b.expansionRate),b.compressionRate=h(b.compressionRate,1),a.dataModel=b})}]),angular.module("rainierApp").controller("StoragePoolsAddCtrl",["$scope","$routeParams","$timeout","orchestratorService","diskSizeService","storagePoolService","objectTransformService","paginationService",function(a,b,c,d,e,f,g,h){function i(b){a.dataVizModel=f.dataVizModelForBasic(a.model,b,a.tierKeys,e)}function j(b){a.dataVizModel=f.dataVizModelForAdvanced(a.model,b,e)}var k=b.storageSystemId,l="parity-groups",m="storage-systems";a.diskTypeSpeedToTier={},a.$watch("model.storageSystem",function(b){b&&(d.tiers().then(function(b){var c={};a.tierKeys=_.pluck(b.tiers,"tier"),_.forEach(b.tiers,function(a){_.forEach(a.subTiers,function(b){c[b.diskType+" "+e.getDisplaySpeed(b.speed)]=a.tier})}),a.diskTypeSpeedToTier=c}),d.poolTemplate(b.storageSystemId).then(function(b){a.model.poolTemplate=b,a.model.utilizationThreshold1=parseInt(b.utilizationThreshold1),a.model.utilizationThreshold2=parseInt(b.utilizationThreshold2),a.model.subscriptionLimit=b.subscriptionLimit,a.model.templateUtilizationThreshold1=parseInt(b.utilizationThreshold1),a.model.templateUtilizationThreshold2=parseInt(b.utilizationThreshold2),a.model.templateSubscriptionLimit=b.subscriptionLimit,a.model.htiPool=!1,a.model.hasHdpLicense=!1,a.model.hasHdtLicense=!1,a.model.hasHtiLicense=!1,a.model.hasActiveFlashLicense=!1,a.model.activeFlashEnabled=!1}),h.getAllPromises(null,l,!0,b.storageSystemId,g.transformParityGroup).then(function(b){var c=["AVAILABLE","FORMATTING","QUICK_FORMATTING"],d=_.filter(b,function(a){return c.indexOf(a.status)>-1});a.model.parityGroups=f.filterParityGroups(d);var e=_.chain(a.model.parityGroups);a.model.diskTypes=e.pluck(function(a){return a.diskSpec.type}).uniq().value(),a.model.raidLayouts=e.pluck("raidLayout").uniq().value(),a.model.raidLevels=e.pluck("raidLevel").uniq().value(),a.model.diskSpeeds=e.pluck(function(a){return a.diskSpec.speed}).uniq().value(),a.model.diskSpeeds=_.map(a.model.diskSpeeds,function(a){return""===a&&(a="0"),a}),a.model.diskSpeeds.sort()}),d.licenses(b.storageSystemId).then(function(b){_.forEach(b.licenseSettings,function(b){"ACTIVE FLASH"===b.productName.toUpperCase()&&b.installed===!0?a.model.hasActiveFlashLicense=!0:"THIN IMAGE"===b.productName.toUpperCase()&&b.installed===!0?(a.model.hasHtiLicense===!1&&a.model.availablePoolTypes.push("HTI"),a.model.hasHtiLicense=!0):"DYNAMIC PROVISIONING"===b.productName.toUpperCase()&&b.installed===!0?(a.model.hasHdpLicense===!1&&a.model.availablePoolTypes.push("HDP"),a.model.hasHdpLicense=!0):"DYNAMIC TIERING"===b.productName.toUpperCase()&&b.installed===!0&&(a.model.hasHdtLicense===!1&&a.model.availablePoolTypes.push("HDT"),a.model.hasHdtLicense=!0)})}))}),a.$watchGroup(["model.poolTemplate","model.wizardType"],function(b){f.watchTemplateTypeWizard(a.model,b,e,!1)}),a.$watch("model.diskSizesByTier",i,!0),a.$watch("model.parityGroups",j,!0),a.$watch("model.wizardType",function(b){b&&"advanced"===b&&(a.model.selectedParityGroup=null,a.model.search={freeText:"",diskSpec:{type:null,speed:null},raidLayout:null,raidLevel:null})}),h.getAllPromises(null,m,!0,null,g.transformStorageSystem).then(function(b){var c=b,e=_.isUndefined(k),f=_.find(c,function(a){return e||a.storageSystemId===k});a.model={poolType:"",wizardType:"basic",label:"",storageSystemSelectable:e,storageSystem:f,storageSystems:c,availablePoolTypes:[],hasHdpLicense:!1,hasHdtLicense:!1,hasHtiLicense:!1,hasActiveFlashLicense:!1},a.payload={submit:function(){if("basic"===a.model.wizardType){var b=_.map(a.model.selectedTiers,function(a){return{name:a.name,sizeToUseInBytes:a.selectedSize.diskSize.value+""}}),c={htiPool:a.model.htiPool,label:a.model.label,utilizationThreshold1:a.model.utilizationThreshold1,utilizationThreshold2:a.model.utilizationThreshold2,subscriptionLimit:a.model.subscriptionLimit,poolTemplateSubTiers:b};d.deployPoolTemplate(a.model.storageSystem.storageSystemId,c).then(function(){window.history.back()})}else{var e={type:a.model.poolType,label:a.model.label,activeFlashEnabled:a.model.activeFlashEnabled,utilizationThreshold1:a.model.utilizationThreshold1,utilizationThreshold2:a.model.utilizationThreshold2,subscriptionLimit:a.model.subscriptionLimit,parityGroupIds:a.model.selectedParityGroups};d.createStoragePool(a.model.storageSystem.storageSystemId,e).then(function(){window.history.back()})}},isInvalid:function(){var b=!a.model||!a.model.storageSystem||_.isEmpty(a.model.label)||!a.model.availablePoolTypes||0===a.model.availablePoolTypes.length;return b||("basic"===a.model.wizardType?b="HDT"===a.model.poolType?_.size(a.model.selectedTiers)<2:0===_.size(a.model.selectedTiers):(b=0===_.size(a.model.selectedParityGroups),b=b||_.isEmpty(a.model.poolType))),b}}})}]),angular.module("rainierApp").controller("StoragePoolsCtrl",["$scope","$routeParams","$timeout","$filter","orchestratorService","objectTransformService","synchronousTranslateService","scrollDataSourceBuilderServiceNew","$location","paginationService","queryService",function(a,b,c,d,e,f,g,h,i,j,k){var l=b.storageSystemId,m="storage-pools";e.tiers().then(function(b){a.tiers=b.tiers}),e.storagePoolsSummary(l).then(function(b){a.usageGraphs=_.map(b.summariesByType,f.transformToSummaryByTypeModel)}),a.$watchGroup(["dataModel","tiers","usageGraphs"],function(a){var b=a[0];b&&(b.tiers=a[1],b.usageGraphs=a[2])}),j.get(null,m,f.transformPool,!0,l).then(function(b){var d=b.resources,n={title:g.translate("common-storage-system-pools"),alerts:{capacity:{count:0,level:"healthy"},dp:{count:0,level:"healthy"},hardware:{count:0,level:"healthy"},jobs:{count:0,level:"healthy"}},storageSystemId:l,nextToken:b.nextToken,total:b.total,view:"tile",allItemsSelected:!1,sort:{field:"name",reverse:!1,setSort:function(b){c(function(){a.dataModel.sort.field===b?(k.setSort(b,!a.dataModel.sort.reverse),a.dataModel.sort.reverse=!a.dataModel.sort.reverse):(a.dataModel.sort.field=b,k.setSort(b,!1),a.dataModel.sort.reverse=!1),j.getQuery(m,f.transformPool,l).then(function(a){o(a)})})}}};a.filterModel={filter:{freeText:"",freeCapacity:{min:0,max:1e3,unit:"PB"},totalCapacity:{min:0,max:1e3,unit:"PB"}},filterQuery:function(a,b,c,d){var e=new j.QueryObject(a,c,b,d);j.setFilterSearch(e),j.getQuery(m,f.transformPool,l).then(function(a){o(a)})},sliderQuery:function(a,b,c,d){j.setSliderSearch(a,b,c,d),j.getQuery(m,f.transformPool,l).then(function(a){o(a)})},searchQuery:function(a){var b=[];b.push(new j.QueryObject("storagePoolId",(new j.SearchType).INT,a)),b.push(new j.QueryObject("label",(new j.SearchType).STRING,a)),j.setTextSearch(b),j.getQuery(m,f.transformPool,l).then(function(a){o(a)})}};var o=function(b){a.dataModel.nextToken=b.nextToken,a.dataModel.displayList=b.resources,a.dataModel.itemCounts={filtered:a.dataModel.displayList.length,total:a.dataModel.total}};n.getResources=function(){return j.get(a.dataModel.nextToken,m,f.transformPool,!1,l)},n.displayList=d,n.isAnyPoolUsingExternalStorage=function(a){var b=!1;if(a&&a.length>0){var c=_.find(a,function(a){return a.isUsingExternalStorage()});c&&(b=!0)}return b};var p=[{icon:"icon-delete",tooltip:"action-tooltip-delete",type:"confirm",confirmTitle:"storage-pool-delete-confirmation",confirmMessage:"storage-pool-delete-selected-content",enabled:function(){return n.anySelected()&&!n.isAnyPoolUsingExternalStorage(n.getSelectedItems())},onClick:function(){_.forEach(n.getSelectedItems(),function(a){a.actions["delete"].onClick(e,!1)})}},{icon:"icon-edit",tooltip:"action-tooltip-edit",type:"link",enabled:function(){return n.onlyOneSelected()&&!n.isAnyPoolUsingExternalStorage(n.getSelectedItems())},onClick:function(){var a=_.first(n.getSelectedItems());a.actions.edit.onClick()}}];n.getActions=function(){return p},n.gridSettings=[{title:"ID",sizeClass:"twelfth",sortField:"storagePoolId",getDisplayValue:function(a){return a.storagePoolId},type:"id"},{title:"Name",sizeClass:"sixth",sortField:"label",getDisplayValue:function(a){return a.label}},{title:"Type",sizeClass:"twelfth",sortField:"type",getDisplayValue:function(a){return g.translate(a.type)}},{title:"pool-active-flash",sizeClass:"twelfth",sortField:"activeFlashEnabled",getDisplayValue:function(a){return a.activeFlashEnabled}},{title:"common-label-total",sizeClass:"twelfth",sortField:"capacityInBytes.value",getDisplayValue:function(a){return a.capacityInBytes},type:"size"},{title:"common-label-free",sizeClass:"twelfth",sortField:"availableCapacityInBytes.value",getDisplayValue:function(a){return a.availableCapacityInBytes},type:"size"},{title:"common-label-used",sizeClass:"twelfth",sortField:"usedCapacityInBytes.value",getDisplayValue:function(a){return a.usedCapacityInBytes},type:"size"}],n.addAction=function(){i.path(["storage-systems",l,"storage-pools","add"].join("/"))},a.dataModel=n,h.setupDataLoader(a,d,"storagePoolSearch")})}]),angular.module("rainierApp").controller("PortUpdateCtrl",["$scope","$routeParams","orchestratorService","ShareDataService",function(a,b,c,d){function e(){var b={};return b.securitySwitchEnabled=a.dataModel.storagePortSecurity,a.isStorageModelG1000()&&("Target"===a.dataModel.storagePortAttribute?b.attribute="TARGET_PORT":"Initiator"===a.dataModel.storagePortAttribute?b.attribute="MCU_INITIATOR_PORT":"RCU Target"===a.dataModel.storagePortAttribute?b.attribute="RCU_TARGET_PORT":"External"===a.dataModel.storagePortAttribute&&(b.attribute="EXTERNAL_INITIATOR_PORT")),b}var f=b.storageSystemId,g=d.storageSystemModel,h=d.editStoragePort;a.dataModel={storagePortId:h.storagePortId,storagePortSpeed:h.speed,storagePortType:h.type,storagePortFabric:h.fabric,storagePortConnectionType:h.connectionType,storagePortSecurity:h.securitySwitchEnabled,storagePortAttribute:h.attributes[0],portAttributes:["Target","RCU Target","Initiator","External"]},a.updateStoragePort=function(){c.updateStoragePort(f,h.storagePortId,e()),window.history.back()},a.isNullAttribute=function(){return _.isNull(a.dataModel.storagePortAttribute)},a.isStorageModelG1000=function(){return"VSP G1000"===g}}]),angular.module("rainierApp").controller("StoragePortCtrl",["$scope","$routeParams","orchestratorService",function(a,b,c){var d=b.storageSystemId,e=b.storagePortId;c.storagePort(d,e).then(function(b){a.model=b})}]),angular.module("rainierApp").controller("StoragePortsCtrl",["$scope","$routeParams","$timeout","$window","orchestratorService","objectTransformService","synchronousTranslateService","scrollDataSourceBuilderServiceNew","ShareDataService","paginationService","queryService",function(a,b,c,d,e,f,g,h,i,j,k){function l(a){return _.countBy(a,function(a){return a.type})}var m=b.storageSystemId,n="storage-ports",o=[{name:"FIBRE",caption:"Fibre"},{name:"ENAS",caption:"Enas"},{name:"ESCON",caption:"ESCON"},{name:"FCOE",caption:"FCoE"},{name:"FICON",caption:"FICON"},{name:"ISCSI",caption:"iSCSI"},{name:"SCSI",caption:"SCSI"}];e.storageSystem(m).then(function(b){a.storageSystemModel=b.model}),j.get(null,n,f.transformPort,!0,m).then(function(b){var d=_.filter(b.resources,function(a){return"FIBRE"===a.type});angular.forEach(d,function(a){"FABRIC_ON_ARB_LOOP"===a.topology?(a.fabric="On",a.connectionType="FC-AL"):"FABRIC_OFF_ARB_LOOP"===a.topology?(a.fabric="Off",a.connectionType="FC-AL"):"FABRIC_ON_POINT_TO_POINT"===a.topology?(a.fabric="On",a.connectionType="P-to-P"):"FABRIC_OFF_POINT_TO_POINT"===a.topology&&(a.fabric="Off",a.connectionType="P-to-P");var b=[];angular.forEach(a.attributes,function(a){"TARGET_PORT"===a?b.push("Target"):"MCU_INITIATOR_PORT"===a?b.push("Initiator"):"RCU_TARGET_PORT"===a?b.push("RCU Target"):"EXTERNAL_INITIATOR_PORT"===a&&b.push("External")}),a.attributes=b});for(var e={chartData:[]},i=l(d),p=0;p<o.length;++p)i[o[p].name]&&e.chartData.push({name:g.translate(o[p].name),value:i[o[p].name]});e.title=g.translate("common-storage-system-ports"),a.summaryModel=e;var q={view:"tile",nextToken:b.nextToken,total:b.total,currentPageCount:0,displayList:b.resources,sort:{field:"name",reverse:!1,setSort:function(b){c(function(){a.dataModel.sort.field===b?(k.setSort(b,!a.dataModel.sort.reverse),a.dataModel.sort.reverse=!a.dataModel.sort.reverse):(a.dataModel.sort.field=b,k.setSort(b,!1),a.dataModel.sort.reverse=!1),j.getQuery(n,f.transformPort,m).then(function(a){r(a)})})}},portAttributes:["Target","RCU Target","Initiator","External"],showPortAttributeFilter:"VSP G1000"===a.storageSystemModel,chartData:e.chartData};a.filterModel={filter:{freeText:""},filterQuery:function(a,b,c,d){var e=new j.QueryObject(a,c,b,d);j.setFilterSearch(e),j.getQuery(n,f.transformPort,m).then(function(a){r(a)})},sliderQuery:function(a,b,c,d){j.setSliderSearch(a,b,c,d),j.getQuery(n,f.transformPort,m).then(function(a){r(a)})},searchQuery:function(a){var b=[];b.push(new j.QueryObject("storagePortId",(new j.SearchType).STRING,a)),j.setTextSearch(b),j.getQuery(n,f.transformPort,m).then(function(a){r(a)})}};var r=function(b){a.dataModel.nextToken=b.nextToken,a.dataModel.displayList=b.resources,a.dataModel.itemCounts={filtered:a.dataModel.displayList.length,total:a.dataModel.total}},s=[{icon:"icon-edit",type:"link",enabled:function(){return q.onlyOneSelected()},onClick:function(){a.updateSelected()}}];q.getActions=function(){return s},q.getResources=function(){return j.get(null,n,f.transformPort,!1,m)},q.gridSettings=[{title:"ID",sizeClass:"sixth",sortField:"storagePortId",getDisplayValue:function(a){return a.storagePortId},type:"id"},{title:"Type",sizeClass:"sixth",sortField:"type",getDisplayValue:function(a){return a.type}},{title:"Speed",sizeClass:"twelfth",sortField:"speed",getDisplayValue:function(a){return a.speed}},{title:"Fabric",sizeClass:"twelfth",sortField:"fabric",getDisplayValue:function(a){return a.fabric}},{title:"Connection Type",sizeClass:"twelfth",sortField:"connectionType",getDisplayValue:function(a){return a.connectionType}},{title:"Security",sizeClass:"twelfth",sortField:"securitySwitchEnabled",getDisplayValue:function(a){return a.securitySwitchEnabled?"Enabled":"Disabled"}}],"VSP G1000"===a.storageSystemModel&&q.gridSettings.push({title:"Attribute",sizeClass:"sixth",sortField:"attribute",getDisplayValue:function(a){return a.attributes[0]}}),a.dataModel=q,h.setupDataLoader(a,b.resources,"storagePortSearch",!0)}),a.updateSelected=function(){for(var b,c=0;c<a.dataModel.filteredList.length;++c)b=a.dataModel.filteredList[c],b.selected&&(i.editStoragePort=b,i.storageSystemModel=a.storageSystemModel,d.location.href="#/storage-systems/"+m+"/storage-ports/"+b.storagePortId+"/update")}}]),angular.module("rainierApp").controller("StorageSystemSettingsCtrl",["$routeParams","$timeout","$filter","$location","orchestratorService","diskSizeService",function(a,b,c,d,e,f){function g(){return e.commonSettings(a.storageSystemId).then(function(a){A.commonSettings={},A.commonSettings.storageSystemName=a.storageSystemName,A.commonSettings.contact=a.contact,A.commonSettings.location=a.location,A.commonData=!0,A.showIndicator=A.updateIndicator(),A.originalCommonSettings=_.cloneDeep(A.commonSettings)},function(){A.handleIndicator()})}function h(){return e.dateTime(a.storageSystemId).then(function(a){m(a),A.dateData=!0,A.showIndicator=A.updateIndicator(),A.originalDateTime.selected=_.cloneDeep(A.selected),A.originalDateTime.dt=_.cloneDeep(A.dt),A.originalDateTime.ntpServers=A.ntpServers},function(){A.handleIndicator()})}function i(){return e.timeZones(a.storageSystemId).then(function(a){var b=a.timeZones;A.timeZones=A.timeZones.concat(b)},function(){A.handleIndicator()})}function j(){return e.alertNotifications(a.storageSystemId).then(function(a){A.email=a.email;var b="";_.forEach(a.email.recipients,function(a){b+=""===b?"":";",b+=a}),A.email.recipients=b,A.smtp=a.smtp,A.snmp=a.snmp,A.alertData=!0,A.showIndicator=A.updateIndicator(),A.originalEmail=_.cloneDeep(A.email),A.originalSmtp=_.cloneDeep(A.smtp),A.originalSnmp=_.cloneDeep(A.snmp)},function(){A.handleIndicator()})}function k(){return e.licenses(a.storageSystemId).then(function(a){l(a.licenses),A.licenseData=!0,A.showIndicator=A.updateIndicator(),A.originalLicenseModel=_.cloneDeep(A.licenseModel)},function(){A.handleIndicator()})}function l(a){A.licenseModel=[],_.forEach(a,function(a){var b={},c="";b.productName=a.productName,b.status=a.installed?"Installed":"Not Installed",a.licenseCapacity&&(c+=a.licenseCapacity.permitted.unlimited?"Unlimited":"Limited",a.licenseCapacity.permitted.value&&(c+=" Capacity: "+f.getDisplaySize(a.licenseCapacity.permitted.value).size+" "+f.getDisplaySize(a.licenseCapacity.permitted.value).unit),c+=", Used Capacity: "+f.getDisplaySize(a.licenseCapacity.usedCapacity).size+" "+f.getDisplaySize(a.licenseCapacity.usedCapacity).unit,b.licenseCapacity=c),A.licenseModel.push(b)})}function m(a){A.selected=_.find(A.timeZones,function(b){return a.timeZone===b.key}),z(A.selected)||(A.selected={display:"",key:""}),A.currentSelected=_.cloneDeep(A.selected);var b=1e3*a.time+n(A.selected),c=new Date(b);A.dt=c;var d="";_.forEach(a.ntp.ntpServers,function(a){d+=""===d?"":",",d+=a}),A.ntpServers=d}function n(a){var b=1,c=0,d=new RegExp("([\\+\\-])(\\d{2}):(\\d{2})"),e=d.exec(a.display);return e&&4===e.length&&(void 0!==e[1]&&"-"===e[1]&&(b=-1),void 0!==e[2]&&(c+=parseInt(e[2])),void 0!==e[3]&&"30"===e[3]&&(c+=.5)),b*c*36e5}function o(){var a={};return a.storageSystemName=void 0!==A.commonSettings.storageSystemName?A.commonSettings.storageSystemName:"",a.contact=void 0!==A.commonSettings.contact?A.commonSettings.contact:"",a.location=void 0!==A.commonSettings.location?A.commonSettings.location:"",a}function p(){var a={};a.timeZone=A.selected.key,a.time=(A.dt.getTime()-n(A.selected))/1e3;var b={};return void 0===A.ntpServers||0===A.ntpServers.length?b.ntpServers=[]:b.ntpServers=A.ntpServers.split(","),0===b.ntpServers.length?b.enabled=!1:b.enabled=!0,a.ntp=b,a}function q(){var a={};return a.licenseKeys=[],""!==A.licenseKeys&&(a.licenseKeys=A.licenseKeys.split(",")),a}function r(){var a={};return a.email=A.email,a.email.recipients=A.email.recipients.split(";"),a.smtp=A.smtp,""===a.smtp.username&&""===a.smtp.password?a.smtp.enabled=!1:a.smtp.enabled=!0,t(),a.snmp=A.snmp,a}function s(){d.path("/storage-systems/"+a.storageSystemId)}function t(){var a=[];_.forEach(A.snmp.trapDestinations,function(b){if(!_.isEmpty(b.community)&&!_.isEmpty(b.ipAddress)){var c={community:b.community.toUpperCase(),ipAddress:b.ipAddress};a.push(c)}}),A.snmp.trapDestinations=a}function u(){return z(A.commonSettings)?y(A.commonSettings.storageSystemName,A.originalCommonSettings.storageSystemName)||y(A.commonSettings.contact,A.originalCommonSettings.contact)||y(A.commonSettings.location,A.originalCommonSettings.location):!1}function v(){return z(A.selected)&&z(A.dt)&&z(A.ntpServers)?y(A.selected.key,A.originalDateTime.selected.key)||y(A.dt.getTime(),A.originalDateTime.dt.getTime())||y(A.ntpServers,A.originalDateTime.ntpServers):!1}function w(){return!!A.licenseKeys}function x(){var a=!1,b=!1,c=!1;if(z(A.email)&&(a=y(A.email.recipients,A.originalEmail.recipients)||y(A.email.from,A.originalEmail.from)||y(A.email.mailServer,A.originalEmail.mailServer)),z(A.smtp)&&(b=y(A.smtp.username,A.originalSmtp.username)||y(A.smtp.password,A.originalSmtp.password)),z(A.snmp)&&z(A.snmp.trapDestinations)&&z(A.originalSnmp.trapDestinations))if(y(A.snmp.trapDestinations.length,A.originalSnmp.trapDestinations.length))c=!0;else for(var d=0;d<A.originalSnmp.trapDestinations.length;++d){var e=A.originalSnmp.trapDestinations[d],f=A.snmp.trapDestinations[d];e.community===f.community&&e.ipAddress===f.ipAddress||(c=!0);
}return a||b||c}function y(a,b){return z(a)?z(b)?a!==b:!0:!1}function z(a){return!_.isUndefined(a)&&!_.isNull(a)}var A=this;A.timeZones=[],A.licenseKeys="",A.showIndicator=!0,A.forceHideIndicator=!1,A.originalCommonSettings={},A.originalDateTime={},A.originalEmail={},A.originalSmtp={},A.originalSnmp={},A.originalLicenseModel={},A.selected={display:null,key:null},A.updateIndicator=function(){return!(A.commonData&&A.dateData&&A.alertData&&A.licenseData||A.forceHideIndicator)},A.handleIndicator=function(){A.forceHideIndicator=!0,A.showIndicator=A.updateIndicator()},g().then(i).then(h).then(j).then(k),A.sort={field:"productName",reverse:!1,setSort:function(a){b(function(){A.sort.field===a?A.sort.reverse=!A.sort.reverse:(A.sort.field=a,A.sort.reverse=!1)})}},A.currentStep=0,A.steps=[{id:"common",text:"Common",status:"active",iconStep:"icon-step-disabled",content:"in active"},{id:"time-zone",text:"Time-Zones",status:"",iconStep:"icon-step-disabled",content:""},{id:"licenses",text:"Licenses",status:"",iconStep:"icon-step-disabled",content:""},{id:"notification",text:"Notification",status:"",iconStep:"icon-step-disabled",content:""}],A.nextClass="enabled",A.prevClass="disabled",A.nextStep=function(a,b){A.steps[a].status="completed",A.steps[a].iconStep="icon-step-confirmed",A.steps[a].content="";var c=b?a+1:a-1;A.steps[c].status="active",A.steps[c].content="active in",A.steps[c].iconStep="icon-step-disabled",0===A.currentStep?A.prevClass="disabled":A.prevClass="enabled",3===A.currentStep?A.nextClass="disabled":A.nextClass="enabled"},A.activateStep=function(){A.nextStep(A.currentStep++,!0)},A.activateCertainStep=function(a){0===A.currentStep&&A.commonSettingsInvalid()||1===A.currentStep&&A.timeZoneSettingInvalid()||(A.steps[A.currentStep].status="completed",A.steps[A.currentStep].iconStep="icon-step-confirmed",A.steps[A.currentStep].content="",A.steps[a].status="active",A.steps[a].content="active in",A.steps[a].iconStep="icon-step-disabled",A.currentStep=a,0===A.currentStep?A.prevClass="disabled":A.prevClass="enabled",3===A.currentStep?A.nextClass="disabled":A.nextClass="enabled")},A.activatePrevStep=function(){A.nextStep(A.currentStep--,!1)},A.open=function(a){a.preventDefault(),a.stopPropagation(),A.opened=!0},A.updateDisplayTime=function(){if(void 0!==A.currentSelected&&void 0!==A.dt){var a=A.dt.getTime();A.currentSelected.display!==A.selected.display&&(a=a-n(A.currentSelected)+n(A.selected),A.currentSelected=_.cloneDeep(A.selected)),A.dt=new Date(a)}},A.sortItems=function(){A.licenseModel=c("orderBy")(A.licenseModel,A.sort.field,A.sort.reverse),A.snmp.trapDestinations=c("orderBy")(A.snmp.trapDestinations,A.sort.field,A.sort.reverse)},A.submit=function(){u()&&e.updateCommonSettings(a.storageSystemId,o()),v()&&e.updateDateTime(a.storageSystemId,p()),w()&&e.updateLicenses(a.storageSystemId,q()),x()&&e.updateAlertNotifications(a.storageSystemId,r()),s()},A.cancel=function(){s()},A.addNewTrapDest=function(){var a={community:"",ipAddress:""};A.snmp.trapDestinations.push(a)},A.checkCurrentPageInvalid=function(){return 0===A.currentStep&&A.commonSettingsInvalid()||1===A.currentStep&&A.timeZoneSettingInvalid()},A.commonSettingsInvalid=function(){return A.commonSettings&&_.isEmpty(A.commonSettings.storageSystemName)},A.timeZoneSettingInvalid=function(){return!(A.dt/1e3>0)||_.isEmpty(A.selected.display)||_.isEmpty(A.selected.key)}}]),angular.module("rainierApp").controller("StorageSystemVolumeAttachCtrl",["$scope","$timeout","orchestratorService","objectTransformService","paginationService","synchronousTranslateService","scrollDataSourceBuilderServiceNew","ShareDataService","$location","$routeParams","viewModelService",function(a,b,c,d,e,f,g,h,i,j,k){function l(a){d.transformHost(a),a.metaData[0].details.push(a.attachedVolumeCount+" volume(s)")}function m(a,b){return a.length>b?_.difference(a,b)[0]:_.difference(b,a)[0]}function n(b){a.dataModel.attachModel.selectedHostModeOption=b,x=a.dataModel.attachModel.selectedHostModeOption}function o(){var b=a.dataModel.attachModel.selectedHostModeOption;return _.where(b,function(a){return a>0})}var p=j.storageSystemId;a.canSubmit=!0;var q=f.translate("storage-volume-attach-valid-tooltip"),r=f.translate("storage-volume-attach-invalid-tooltip"),s="storage-ports",t="compute/servers",u=h.pop("selectedVolumes")||[];_.forEach(u,function(a){a.lun=null,a.decimalNumberRegexp=/^[^.]+$/,a.hasDuplicatedLun=!1,a.validationTooltip=q}),u&&0!==u.length||i.path("storage-systems/"+p+"/volumes"),a.operatingSystemType={},a.operatingSystems=c.osType(),e.get(null,t,l,!0).then(function(h){c.storageSystem(p).then(function(b){a.dataModel.storageSystemModel=b.model,e.getAll(null,s,!0,p,b.model,a.dataModel)});var i=h.resources,j=k.newWizardViewModel(["select","attach"]),m={storageSystemId:p};angular.extend(j,{selectedStorageSystem:m,storageSystems:[m],hosts:i,view:"tile",allItemsSelected:!1,nextToken:h.nextToken,total:h.total,displayList:h.resources,search:{freeText:""},sort:{field:"serverId",reverse:!1,setSort:function(c){b(function(){a.dataModel.sort.field===c?a.dataModel.sort.reverse=!a.dataModel.sort.reverse:(a.dataModel.sort.field=c,a.dataModel.sort.reverse=!1)})}},getSelectedHostCount:function(){var b=0;return _.forEach(a.dataModel.filteredList,function(a){a.selected===!0&&b++}),b}}),j.selectModel={confirmTitle:f.translate("host-attach-confirmation"),confirmMessage:f.translate("host-attach-zero-selected"),canGoNext:function(){return j.getSelectedHostCount()>0},next:function(){if(!j.selectModel.canGoNext||j.selectModel.canGoNext()){var a=_.where(j.filteredList,"selected");j.attachModel.serverPortMapperModel=k.newServerPortMapperModel(j.attachModel.storagePorts,a),j.goNext()}},validation:!0,itemSelected:!1},j.process=function(a){a=_.filter(a,function(a){return"FIBRE"===a.type}),_.forEach(a,function(a){a.storageSystemModel=j.storageSystemModel,d.transformPort(a)}),j.storagePorts=j.storagePorts.concat(a)},j.storagePorts=[],j.getResources=function(){return e.get(a.dataModel.nextToken,t,l,!1)},a.dataModel=j,g.setupDataLoader(a,i,"hostSearch")});var v=function(b){a.dataModel.nextToken=b.nextToken,a.dataModel.displayList=b.resources,a.dataModel.itemCounts={filtered:a.dataModel.displayList.length,total:a.dataModel.total}};a.filterModel={filterOperatingSystem:function(){var b=[],c=a.filterModel.operatingSystemType;for(var d in c)c[d]&&b.push(d);a.dataModel.search.osType=b},filterDpType:function(){var b=[];a.dataModel.snapshot&&b.push("SNAPSHOT"),a.dataModel.cloneNow&&b.push("CLONE"),a.dataModel.search.replicationTypes=b},filter:{freeText:"",status:"",osType:null,replicationType:null,snapshot:!1,clone:!1},arrayType:(new e.SearchType).ARRAY,filterQuery:function(a,b,c,d){var f=new e.QueryObject(a,c,b,d);e.setFilterSearch(f),e.getQuery(t,l).then(function(a){v(a)})},searchQuery:function(a){var b=[];b.push(new e.QueryObject("serverId",(new e.SearchType).INT,a)),b.push(new e.QueryObject("serverName",(new e.SearchType).STRING,a)),e.setTextSearch(b),e.getQuery(t,l).then(function(a){v(a)})}};var w="AUTO",x=[0];a.$watch("dataModel.storagePorts",function(b){if(b){var d=c.hostModeOptions(),e=c.osType();e.splice(0,0,w);var f=a.dataModel;f.attachModel={storageSystemSelectable:!1,selectedVolumes:u,selectedServers:_.where(f.filteredList,"selected"),storagePorts:b,hostModes:e,hostMode:e[0],hostModeOptions:d,selectedHostModeOption:[0],enableZoning:!1,enableLunUnification:!1,canSubmit:function(){return _.every(f.attachModel.selectedVolumes,function(a){return!a.lun||_.isFinite(a.lun)})},submit:function(){if(a.canSubmit){var b=k.buildLunResources(f.attachModel.selectedVolumes),d=f.attachModel.serverPortMapperModel.getPorts(),e={storageSystemId:p,hostModeOptions:o(),volumes:b,ports:d,enableZoning:f.attachModel.enableZoning,enableLunUnification:f.attachModel.enableLunUnification};f.attachModel.hostMode!==w&&(e.intendedImageType=f.attachModel.hostMode),c.attachVolume(e).then(function(){window.history.back()})}},previous:function(){f.goBack()}},f.checkSelectedHostModeOptions=function(){var b=a.dataModel.attachModel.selectedHostModeOption,c=m(x,b);n(0===b.length||0===c?[0]:_.without(b,0))}}}),a.$watch(function(a){return a.dataModel&&a.dataModel.filteredList?a.dataModel.filteredList.map(function(a){return a.selected}):void 0},function(b){if(b){for(var c=!1,d=0;d<a.dataModel.filteredList.length;++d)if(a.dataModel.filteredList[d].selected){c=!0;break}a.dataModel.selectModel.itemSelected=c}},!0),a.$watch("dataModel.attachModel.selectedVolumes",function(b,c){if(b&&c&&b!==c){var d={};_.forEach(a.dataModel.attachModel.selectedVolumes,function(a){a.lun?a.validationTooltip=q:a.validationTooltip=r,d[a.lun]||(d[a.lun]=[]),void 0!==a.lun&&(0===d[a.lun].length||null===a.lun?(a.hasDuplicatedLun=!1,a.validationTooltip=q,d[a.lun].push(a)):null!==a.lun&&(_.forEach(d[a.lun],function(a){a.hasDuplicatedLun=!0,a.validationTooltip=r}),a.hasDuplicatedLun=!0,a.validationTooltip=r,d[a.lun].push(a)))})}},!0),a.$watch("dataModel.attachModel.selectedVolumes",function(b,c){if(b&&c&&b!==c){var d=!0;_.forEach(a.dataModel.attachModel.selectedVolumes,function(a){a.validationTooltip&&a.validationTooltip===r&&(d=!1)}),a.canSubmit=d}},!0)}]),angular.module("rainierApp").controller("StorageSystemVolumeUpdateCtrl",["$scope","$routeParams","orchestratorService","diskSizeService",function(a,b,c,d){function e(a,b){var c={label:a.label===b.label?null:b.label},e=d.createDisplaySize(b.totalCapacity.intSize,b.totalCapacity.unit).value,f=d.createDisplaySize(a.totalCapacity.intSize,a.totalCapacity.unit).value;return e!==f&&(c.capacityInBytes=e),c}var f=b.storageSystemId;c.volume(f,b.volumeId).then(function(b){var f=b,g=angular.copy(b),h=/^[a-zA-Z0-9_][a-zA-Z0-9-_]*$/;g.submit=function(){var a=e(f,g);c.updateVolume(g.storageSystemId,g.volumeId,a).then(function(){window.history.back()})},g.canSubmit=function(){if(f.label&&f.label.length>0&&(null===g.label||0===g.label.length))return!1;var a=d.createDisplaySize(g.totalCapacity.intSize,g.totalCapacity.unit).value,b=d.createDisplaySize(f.totalCapacity.intSize,f.totalCapacity.unit).value;return a>b||f.label!==g.label},f.updateModel=g,f.labelIsValid=!0,f.validLabel=function(){f.label===g.label?f.labelIsValid=!0:f.labelIsValid=h.test(g.label)},a.dataModel=f})}]),angular.module("rainierApp").controller("StorageSystemVolumeCtrl",["$scope","$routeParams","$timeout","$window","$location","orchestratorService","synchronousTranslateService","objectTransformService","ShareDataService","scrollDataSourceBuilderService","dataProtectionSettingsService","replicationGroupsService","storageSystemVolumeService","paginationService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o=b.storageSystemId,p=b.volumeId;a.volumeId=p,a["protected"]=!1,a.noRgWithVolumeIdAsPvol=!1,a.noRgWithVolumeIdAsPvolAndClone=!1,a.noRgWithVolumeIdAsPvolAndSnaphot=!1,a.noRgWithVolumeIdAsPvolAndExternalSnaphot=!1,a.noRgWithVolumeIdAsSvol=!1,a.noDataVisualization=!1,a.numberOfVPWithVolumeIdAsPvol=0,a.volumePairsAsSvol=[],a.rgWithVolumeIdAsPvol=[],a.rgWithVolumeIdAsSvol={},f.volume(o,p).then(function(b){var c=h.transformToVolumeSummaryModel(b);c.title="Storage volume "+p,a.summaryModel=c,b.orchestratorService=f,a.alertModel=b,a.model=b;var d="healthy",j="error";a.alertCount=b.dataProtectionSummary.secondaryVolumeFailures,a.alertModel.alertCount=b.dataProtectionSummary.secondaryVolumeFailures,a.alertModel.alertLevel="0"!==a.alertModel.alertCount&&0!==a.alertModel.alertCount?j:d,_.contains(a.alertModel.dataProtectionSummary.volumeType,"P-VOL")?a["protected"]=!0:a["protected"]=!1,f.storagePool(o,b.poolId).then(function(b){b.displayType=g.translate(b.type),a.model.storagePool=b}),a.protectCurrentVolume=function(){i.volumesList=[b],e.path(["storage-systems",o,"volumes",b.volumeId,"protect"].join("/"))},a.unprotectCurrentVolume=function(){i.volumeListForUnprotect=[b],e.path(["storage-systems",o,"volumes",b.volumeId,"unprotect"].join("/"))},a.deleteConfirmOk=function(){f.deleteVolume(a.model.storageSystemId,a.model.volumeId),e.path("storage-systems/"+a.model.storageSystemId+"/volumes")},a.attachToHost=function(){i.push("selectedVolumes",[a.model]),e.path("storage-systems/"+a.model.storageSystemId+"/attach-volumes")}}),m.getVolumePairsAsSVol(p,o).then(function(b){if(b.total){a.volumePairsAsSvol=b.resources,a.noRgWithVolumeIdAsSvol=!1;var c=_.first(a.volumePairsAsSvol).replicationGroup;return"N/A"===c?(a.rgWithVolumeIdAsSvol=new l.ExternalReplicationGroup(_.first(a.volumePairsAsSvol).type),a.rgWithVolumeIdAsSvol.volumePairsAsSvol=a.volumePairsAsSvol,m.getVolumePairsAsPVolAndClone(p,o)):m.getReplicationGroupByName(c,o).then(function(b){return a.rgWithVolumeIdAsSvol=_.first(b.resources),a.rgWithVolumeIdAsSvol.volumePairsAsSvol=a.volumePairsAsSvol,m.getVolumePairsAsPVolAndClone(p,o)})}return a.noRgWithVolumeIdAsSvol=!0,m.getVolumePairsAsPVolAndClone(p,o)}).then(function(b){if(a.numberOfVPWithVolumeIdAsPvol+=b.total,b.total){a.noRgWithVolumeIdAsPvolAndClone=!1;var c=!1,d=[];return _.forEach(b.resources,function(a){"N/A"===a.replicationGroup?c=!0:d.push(a.replicationGroup)}),c?(a.rgWithVolumeIdAsPvol.push(new l.ExternalReplicationGroup("CLONE")),m.getVolumePairsAsPVolAndSnapshotAndRGNameExisting(p,o)):m.getMultipleReplicationGroupsByName(d,o).then(function(b){return a.rgWithVolumeIdAsPvol=a.rgWithVolumeIdAsPvol.concat(b.resources),m.getVolumePairsAsPVolAndSnapshotAndRGNameExisting(p,o)})}return a.noRgWithVolumeIdAsPvolAndClone=!0,m.getVolumePairsAsPVolAndSnapshotAndRGNameExisting(p,o)}).then(function(b){if(a.numberOfVPWithVolumeIdAsPvol+=b.total,b.total){a.noRgWithVolumeIdAsPvolAndSnaphot=!1;var c=_.first(b.resources).replicationGroup;return m.getReplicationGroupByName(c,o).then(function(b){return a.rgWithVolumeIdAsPvol.push(_.first(b.resources)),m.getVolumePairsAsPVolAndSnapshotAndRGNameMissing(p,o)})}return a.noRgWithVolumeIdAsPvolAndSnaphot=!0,m.getVolumePairsAsPVolAndSnapshotAndRGNameMissing(p,o)}).then(function(b){a.numberOfVPWithVolumeIdAsPvol+=b.total,b.total?(a.noRgWithVolumeIdAsPvolAndExternalSnaphot=!1,a.rgWithVolumeIdAsPvol.push(new l.ExternalReplicationGroup("SNAPSHOT"))):a.noRgWithVolumeIdAsPvolAndExternalSnaphot=!0,a.noRgWithVolumeIdAsPvol=a.noRgWithVolumeIdAsPvolAndClone&&a.noRgWithVolumeIdAsPvolAndSnaphot&&a.noRgWithVolumeIdAsPvolAndExternalSnaphot,a.rgWithVolumeIdAsPvol=_.sortBy(a.rgWithVolumeIdAsPvol,"id"),a.numberOfRgWithVolumeIdAsPvol=a.rgWithVolumeIdAsPvol.length.toString(),(a.noRgWithVolumeIdAsPvol&&a.noRgWithVolumeIdAsSvol||a.rgWithVolumeIdAsPvol.length>6)&&(a.noDataVisualization=!0);var d="#tile-",e="#tile-left-default-",f="#tile-left-long-";if(a.noRgWithVolumeIdAsPvol||a.noRgWithVolumeIdAsSvol){if(a.noRgWithVolumeIdAsSvol&&!a.noRgWithVolumeIdAsPvol)switch(a.numberOfRgWithVolumeIdAsPvol){case"1":d+="single-long-";break;case"2":d+="half-long-";break;case"3":d+="third-long-";break;case"4":d+="quarter-long-";break;case"5":d+="fifth-long-";break;case"6":d+="sixth-long-"}}else switch(a.numberOfRgWithVolumeIdAsPvol){case"1":d+="single-";break;case"2":d+="half-";break;case"3":d+="third-";break;case"4":d+="quarter-";break;case"5":d+="fifth-";break;case"6":d+="sixth-"}_.forEach(a.rgWithVolumeIdAsPvol,function(a){"Snapshot"===a.type?a.icon=d+"scheduled-active":a.icon=d+"not-scheduled-active"}),a.rgWithVolumeIdAsSvol&&"Snapshot"===a.rgWithVolumeIdAsSvol.type?(a.defaultLeftIconString=e+"scheduled-active",a.longLeftIconString=f+"scheduled-active"):a.rgWithVolumeIdAsSvol&&(a.defaultLeftIconString=e+"not-scheduled-active",a.longLeftIconString=f+"not-scheduled-active"),a.jumpToReplicationGroup=function(b){_.forEach(a.rgWithVolumeIdAsPvol,function(c){var d=c.icon.slice(0,c.icon.lastIndexOf("-")+1);if(c.id===b){var e=c.icon.slice(c.icon.lastIndexOf("-")+1,c.icon.length);c.volumePairs=[],"active"===e?(c.icon=d+"normal",c.opened=!0,a.dataModel.fetchFirstPageChildren(c),$("html, body").animate({scrollTop:$("#"+b).offset().top},1250)):"normal"===e&&(c.icon=d+"active",c.opened=!1)}else c.icon=d+"active",c.opened=!1,c.volumePairs=[]})},a.changeReplicationGroupBackground=function(b){b.opened?_.forEach(a.rgWithVolumeIdAsPvol,function(c){c.volumePairs=[],c.id===b.id?(c.icon=c.icon.slice(0,c.icon.lastIndexOf("-")+1)+"normal",a.dataModel.fetchFirstPageChildren(b)):(c.icon=c.icon.slice(0,c.icon.lastIndexOf("-")+1)+"active",c.opened=!1)}):_.forEach(a.rgWithVolumeIdAsPvol,function(a){a.id===b.id&&(a.icon=a.icon.slice(0,a.icon.lastIndexOf("-")+1)+"active",a.volumePairs=[])})},a.changeReplicationGroupIcon=function(b){_.forEach(a.rgWithVolumeIdAsPvol,function(a){if(a.id===b){var c=a.icon.slice(0,a.icon.lastIndexOf("-")+1),d=a.icon.slice(a.icon.lastIndexOf("-")+1,a.icon.length);"active"===d?a.icon=c+"normal":"normal"===d&&(a.icon=c+"active")}})};var g={storageSystemId:o,view:"list",replicationGroups:a.rgWithVolumeIdAsPvol,enableRestore:!1,noVolumePairSelected:!0,childrenToken:null,busyLoadingMoreChildren:!1,search:{freeText:"",type:""},sort:{field:"id",reverse:!1,setSort:function(b){c(function(){a.dataModel.sort.field===b?a.dataModel.sort.reverse=!a.dataModel.sort.reverse:(a.dataModel.sort.field=b,a.dataModel.sort.reverse=!1)})}},fetchFirstPageChildren:function(b){l.getVolumePairsForOneReplicationGroup(null,o,b,p).then(function(c){_.forEach(c.resources,function(a){h.transformVolumePairs(a)}),b.volumePairs=c.resources,a.dataModel.childrenToken=c.nextToken}),n.clearQuery()},loadMoreChildren:function(b){b.hasOwnProperty("volumePairs")&&b.volumePairs.length>=n.PAGE_SIZE&&null!==a.dataModel.childrenToken&&!a.dataModel.busyLoadingMoreChildren&&(a.dataModel.busyLoadingMoreChildren=!0,l.getVolumePairsForOneReplicationGroup(a.dataModel.childrenToken,o,b,p).then(function(c){b.volumePairs=b.volumePairs.concat(c.resources),a.dataModel.childrenToken=c.nextToken,a.dataModel.busyLoadingMoreChildren=!1}))}},i=[{icon:"icon-edit",tooltip:"action-tooltip-edit-replication-groups",type:"link",enabled:function(){return g.onlyOneSelected()&&g.noVolumePairSelected},onClick:function(){a.replicationGroupEdit(g.getSelectedItems())}},{icon:"icon-pause",tooltip:"action-tooltip-suspend-replication-groups",type:"link",enabled:function(){return g.onlyOneSelected()&&g.noVolumePairSelected},onClick:function(){a.replicationGroupSuspendResumeDelete("suspend",g.getSelectedItems())}},{icon:"icon-play",tooltip:"action-tooltip-resume-replication-groups",type:"link",enabled:function(){return g.onlyOneSelected()&&g.noVolumePairSelected},onClick:function(){a.replicationGroupSuspendResumeDelete("resume",g.getSelectedItems())}},{icon:"icon-delete-item",tooltip:"action-tooltip-delete-replication-groups",type:"link",enabled:function(){return g.onlyOneSelected()&&g.noVolumePairSelected},onClick:function(){a.replicationGroupSuspendResumeDelete("delete",g.getSelectedItems())}},{icon:"icon-refresh",tooltip:"action-tooltip-restore-replication-groups",type:"confirm",confirmTitle:"replication-group-actions-restore-confirmation-title",confirmMessage:"replication-group-actions-restore-confirmation-message",onClick:function(){a.replicationGroupRestore()},enabled:function(){return!g.anySelected()&&g.enableRestore}}];g.getActions=function(){return i},k.setReplicationGroupGridSettings(g),a.dataModel=g,$(".tooltip-inner").hide(),j.setupDataLoader(a,a.rgWithVolumeIdAsPvol,"replicationGroupsSearch"),k.setDataModelFunctions(a,a.rgWithVolumeIdAsPvol),k.setReplicationGroupActions(a,o)})}]),angular.module("rainierApp").controller("StorageSystemVolumesAddCtrl",["$scope","$routeParams","$timeout","$window","$filter","orchestratorService","diskSizeService","viewModelService","volumeService","synchronousTranslateService","paginationService","objectTransformService",function(a,b,c,d,e,f,g,h,i,j,k,l){var m=b.storageSystemId,n="storage-systems";k.getAllPromises(null,n,!0,null,l.transformStorageSystem).then(function(b){var c=b,d=_.isUndefined(m),e=_.find(c,function(a){return d||a.storageSystemId===m}),f={storageSystems:c,selectedStorageSystem:e,storageSystemSelectable:d};a.dataModel=f}),a.$watch("dataModel.selectedStorageSystem",function(b){b&&(k.getAllPromises(null,"storage-pools",!0,b.storageSystemId,l.transformPool).then(function(b){var c=_.filter(b,function(a){return a.type!==j.translate("HTI")});a.dataModel.storagePools=c}),a.dataModel.summaryModel=h.buildSummaryModel(b))}),a.$watch("dataModel.storagePools",function(b){if(b){var c=h.newCreateVolumeModel(b),d={storageSystemSelectable:!1,simpleNameRegexp:/^[a-zA-Z0-9_][a-zA-Z0-9-_]*$/,volumesGroupsModel:c,canSubmit:function(){return a.dataModel.createModel.volumesGroupsModel.isValid()},submit:function(){var a=c.mapToPayloads(c.getVolumeGroups()),b={storageSystemId:m,volumes:a};f.createVolumes(b).then(function(){window.history.back()})}};a.dataModel.createModel=d,a.dataModel.validLabel=function(a){a.labelIsValid=i.validateCombinedLabel(a.label,a.suffix,a.noOfVolumes)}}});var o=h.newSubscriptionUpdateModel();a.$watch("dataModel.createModel.volumesGroupsModel.volumes",function(b){var d=o.getUpdatedModel(a.dataModel.selectedStorageSystem,b);d&&c(function(){a.dataModel.summaryModel=h.buildSummaryModel(d)})},!0)}]),angular.module("rainierApp").controller("StorageSystemVolumesCtrl",["$scope","$routeParams","$timeout","$filter","$location","objectTransformService","orchestratorService","scrollDataSourceBuilderServiceNew","ShareDataService","inventorySettingsService","paginationService","queryService","storageSystemVolumeService",function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n,o=b.storageSystemId,p="volumes";a.dataModel={},g.storageSystem(o).then(function(a){return n=a,g.dataProtectionSummaryForStorageSystem(o)}).then(function(b){var c=f.transformToStorageSummaryModel(n,null,b);c.title="Volumes",c.protectedVolume=b.protectedVolumes,c.unprotectedVolume=b.unprotectedVolumes,c.secondaryVolume=b.secondaryVolumes,a.summaryModel=c});var q=function(a){i.volumeListForUnprotect=a,e.path(["storage-systems",o,"volumes","unprotect"].join("/"))},r=function(a,b){var c=0;b&&b.length>0&&(c=b[0].volumeId),m.getVolumePairsAsPVol(null,c,o).then(function(a){i.SVolsList=_.filter(a.resources,function(a){return a.primaryVolume&&a.secondaryVolume}),i.restorePrimaryVolumeId=c,i.restorePrimaryVolumeToken=a.nextToken,_.forEach(i.SVolsList,function(a){a.selected=!1}),e.path(["/storage-systems/",o,"/volumes/volume-actions-restore-selection"].join(""))})};k.get(null,p,f.transformVolume,!0,o).then(function(b){k.clearQuery();var d={view:"tile",storageSystemId:o,nextToken:b.nextToken,total:b.total,currentPageCount:0,displayList:b.resources,busy:!1,sort:{field:"volumeId",reverse:!1,setSort:function(b){c(function(){a.dataModel.sort.field===b?(l.setSort(b,!a.dataModel.sort.reverse),a.dataModel.sort.reverse=!a.dataModel.sort.reverse):(a.dataModel.sort.field=b,l.setSort(b,!1),a.dataModel.sort.reverse=!1),k.getQuery(p,f.transformVolume,o).then(function(a){s(a)})})}}};j.setVolumesGridSettings(d);var m=[{icon:"icon-delete",tooltip:"action-tooltip-delete",type:"confirm",confirmTitle:"storage-volume-delete-confirmation",confirmMessage:"storage-volume-delete-selected-content",enabled:function(){return d.anySelected()},onClick:function(){_.forEach(d.getSelectedItems(),function(a){a.actions["delete"].onClick(g,!1)})}},{icon:"icon-edit",tooltip:"action-tooltip-edit",type:"link",enabled:function(){return d.onlyOneSelected()},onClick:function(){var a=_.first(d.getSelectedItems());a.actions.edit.onClick()}},{icon:"icon-attach-volume",tooltip:"action-tooltip-attach-volumes",type:"link",onClick:function(){i.push("selectedVolumes",d.getSelectedItems()),e.path(["storage-systems",o,"attach-volumes"].join("/"))},enabled:function(){return d.anySelected()}},{icon:"icon-data-protection",tooltip:"action-tooltip-protect-volumes",type:"link",onClick:function(){i.volumesList=d.getSelectedItems(),e.path(["storage-systems",o,"volumes/protect"].join("/"))},enabled:function(){return d.anySelected()}},{icon:"icon-remove-volume",tooltip:"action-tooltip-unprotect-volumes",type:"link",onClick:function(){q(d.getSelectedItems())},enabled:function(){return d.onlyOneSelected()&&!_.some(d.getSelectedItems(),function(a){return a.isUnprotected()})}},{icon:"icon-refresh",tooltip:"action-tooltip-restore-volumes",type:"link",onClick:function(){r("restore",d.getSelectedItems())},enabled:function(){return d.onlyOneSelected()&&!_.some(d.getSelectedItems(),function(a){return a.isUnprotected()})}}];d.getActions=function(){return m},d.getResources=function(){return k.get(a.dataModel.nextToken,p,f.transformVolume,!1,o)},a.dataModel=d,h.setupDataLoader(a,b.resources,"storageSystemVolumesSearch")});var s=function(b){a.dataModel.nextToken=b.nextToken,a.dataModel.displayList=b.resources,a.dataModel.itemCounts={filtered:a.dataModel.displayList.length,total:a.dataModel.total}};a.filterModel={filter:{freeText:"",volumeType:"",replicationType:[],protectionStatusList:[],snapshot:!1,clone:!1,"protected":!1,unprotected:!1,secondary:!1,freeCapacity:{min:0,max:1e3,unit:"PB"},totalCapacity:{min:0,max:1e3,unit:"PB"},utilization:{min:0,max:100}},arrayType:(new k.SearchType).ARRAY,filterQuery:function(a,b,c,d){var e=new k.QueryObject(a,c,b,d);k.setFilterSearch(e),k.getQuery(p,f.transformVolume,o).then(function(a){s(a)})},sliderQuery:function(a,b,c,d){k.setSliderSearch(a,b,c,d),k.getQuery(p,f.transformVolume,o).then(function(a){s(a)})},searchQuery:function(a){var b=[];b.push(new k.QueryObject("volumeId",(new k.SearchType).INT,a)),b.push(new k.QueryObject("label",(new k.SearchType).STRING,a)),k.setTextSearch(b),k.getQuery(p,f.transformVolume,o).then(function(a){s(a)})}}}]),angular.module("rainierApp").controller("StorageSystemCtrl",["$scope","$routeParams","$window","orchestratorService","objectTransformService","diskSizeService","synchronousTranslateService","paginationService",function(a,b,c,d,e,f,g,h){function i(){d.cluster(o).then(function(b){a.clusterSummary=b}),d.filePools(o).then(function(b){var c=0;_.each(b.filePools,function(a){a.tiered&&(c+=1)}),a.filePoolSummary={total:b.filePools.length,tiered:c,untiered:b.filePools.length-c}}),d.fileSystems(o).then(function(b){var c=0;_.each(b.fileSystems,function(a){"Mounted"===a.status&&(c+=1)}),a.fileSystemsSummary={total:b.fileSystems.length,fileSystemsByType:[{type:g.translate("common-storage-system-mounted"),count:c},{type:g.translate("common-storage-system-unmounted"),count:b.fileSystems.length-c}]}}),d.enterpriseVirtualServers(o).then(function(b){var c=0;_.each(b.evses,function(a){a.enabled&&(c+=1)}),a.evsesSummary={total:b.evses.length,evsesByType:[{type:g.translate("common-storage-system-active"),count:c},{type:g.translate("common-storage-system-inactive"),count:b.evses.length-c}]},a.shares={total:0},a.sharesSummary=[],j(0,"windows"),j(0,"linux"),d.allShares(o).then(function(b){_.first(a.sharesSummary).count=b.shares.length,a.shares={total:b.shares.length+a.shares.total}}),d.allExports(o).then(function(b){_.last(a.sharesSummary).count=b.exports.length,a.shares={total:b.exports.length+a.shares.total}})})}function j(b,c){a.sharesSummary.push({type:g.translate(c),count:b})}var k,l,m,n,o=b.storageSystemId,p="parity-groups",q="storage-ports";d.tiers().then(function(a){return n=a,d.tierSummary(o)}).then(function(a){return m=a.tierSummaryItems,d.dataProtectionSummary()}).then(function(a){return l=a,d.storageSystem(o)}).then(function(b){b.orchestratorService=d,a.dataModel=b;var c="Storage System "+b.storageSystemId;if(b.unified&&b.accessible){d.filePoolSummary(o).then(function(b){k=b;var d=e.transformToStorageSummaryModel(a.dataModel,k,l);e.transformTierSummary(n,m,d),d.title=c,a.summaryModel=d});var f={href:["https://",b.gum1IpAddress,":20443/mgr/app/"].join(""),title:"storage-system-launch-smu",type:"hyperlink"};a.dataModel.actions.settings.items.push(f),i()}else{var g=e.transformToStorageSummaryModel(b,!1,l);g.title=c,a.summaryModel=g}}),d.replicationGroupSummary(o).then(function(b){var c=b.replicationGroupCountByType,d=0,e=[];_.isUndefined(c)||_.isEmpty(c)||_.forEach(c,function(a){var b={type:a.replicationType,count:a.count};e.push(b),d+=a.count}),a.replicationGroupSummary={total:d,replicationGroupsByType:e}}),d.storagePoolsSummary(o).then(function(b){a.poolsSummary={total:_.reduce(b.summariesByType,function(a,b){return a+b.poolCount},0),summariesByType:b.summariesByType}}),h.getAllPromises(null,q,!0,o,e.transformPort).then(function(b){b.storagePorts=_.filter(b,function(a){return"FIBRE"===a.type});var c=b;a.portsSummary={total:c.length,portsByType:_.map(_.groupBy(c,"type"),function(a){return{type:_.first(a).type,count:a.length}})}}),d.volumeSummary(o).then(function(b){a.volumesSummary={total:b.numberOfVolumes,volumesByType:[]};for(var c in b.volumeCountByType)if(b.volumeCountByType.hasOwnProperty(c)){var d={};d.type=c,d.count=b.volumeCountByType[c],a.volumesSummary.volumesByType.push(d)}}),h.getAllPromises(null,p,!0,o,e.transformParityGroup).then(function(b){var c=b;a.parityGroups=c,a.parityGroupsSummary={total:c.length,parityGroupsByType:_.map(_.groupBy(c,function(a){return a.diskSpec.type}),function(a){return{type:_.first(a).diskSpec.type,count:a.length}})}}),d.storageExternalParityGroups(o).then(function(b){a.externalParityGroups=b.externalParityGroups,a.externalParityGroupsSummary={count:a.externalParityGroups?a.externalParityGroups.length:0}}),d.externalParityGroupSummary(o).then(function(b){a.externalParityGroupsSummary={count:b.numberOfExternalParityGroups?b.numberOfExternalParityGroups:0}})}]),angular.module("rainierApp").controller("StorageSystemsAddCtrl",["$scope","orchestratorService",function(a,b){a.model={svpIpAddress:"",username:"",password:""},a.payload={submit:function(){b.addStorageSystem(a.model).then(function(){window.history.back()})},isInvalid:function(){return!a.model||_.isEmpty(a.model.svpIpAddress)||_.isEmpty(a.model.username)||_.isEmpty(a.model.password)}}}]),angular.module("rainierApp").controller("StorageSystemsUpdateCtrl",["$scope","$routeParams","orchestratorService",function(a,b,c){function d(){var b={username:a.dataModel.username,password:a.dataModel.password};return b}function e(a){return void 0!==a&&null!==a&&a.length>0}var f=b.storageSystemId,g={};c.storageSystem(f).then(function(b){g={storageSystemId:b.storageSystemId,svpIpAddress:b.svpIpAddress,gum1IpAddress:b.gum1IpAddress,gum2IpAddress:b.gum2IpAddress,username:"",password:""},a.dataModel=g}),a.isValid=function(){return e(a.dataModel.username)&&e(a.dataModel.password)},a.updateStorageSystem=function(){var b=d();c.updateStorageSystem(a.dataModel.storageSystemId,b),window.history.back()}}]),angular.module("rainierApp").controller("StorageSystemsCtrl",["$scope","$timeout","orchestratorService","objectTransformService","synchronousTranslateService","scrollDataSourceBuilderServiceNew","$location","diskSizeService","paginationService","queryService",function(a,b,c,d,e,f,g,h,i,j){function k(b){c.tiers().then(function(a){return n=a,c.storageSystemsSummary()}).then(function(c){b&&(c.unified=!0);var f=d.transformToStorageSummaryModel(c,b,m);d.transformTierSummary(n,c.tierSummaryItems,f),f.title=e.translate("common-storage-systems"),a.summaryModel=f})}function l(a){_.each(a,function(a){a.unified&&c.filePoolSummary(a.storageSystemId).then(function(b){a.bottomSize=h.getDisplaySize(b.usedCapacity),a.bottomTotal=h.getDisplaySize(b.overcommitCapacity);var c="0%";0!==a.bottomTotal.value&&(c=parseInt(a.bottomSize.value/a.bottomTotal.value*100).toString()+"%"),a.fileCapacity={usage:c,file:!0}})})}var m,n,o="storage-systems";i.get(null,o,d.transformStorageSystem,!0).then(function(e){var h=e.resources,n=!1;l(h),c.dataProtectionSummary().then(function(a){m=a,c.filePoolsSummary().then(function(a){k(a)},function(){k(null)})});var p={view:"tile",hasFileUsageBar:n,nextToken:e.nextToken,total:e.total,currentPageCount:0,displayList:e.resources,sort:{field:"storageSystemId",reverse:!1,setSort:function(c){b(function(){a.dataModel.sort.field===c?(j.setSort(c,!a.dataModel.sort.reverse),a.dataModel.sort.reverse=!a.dataModel.sort.reverse):(a.dataModel.sort.field=c,j.setSort(c,!1),a.dataModel.sort.reverse=!1),i.getQuery(o,d.transformStorageSystem).then(function(a){r(a)})})}}};a.filterModel={filter:{freeText:"",freeCapacity:{min:0,
max:1e3,unit:"PB"},totalCapacity:{min:0,max:1e3,unit:"PB"}},filterQuery:function(a,b,c,e){var f=new i.QueryObject(a,c,b,e);i.setFilterSearch(f),i.getQuery(o,d.transformStorageSystem).then(function(a){r(a)})},sliderQuery:function(a,b,c,e){i.setSliderSearch(a,b,c,e),i.getQuery(o,d.transformStorageSystem).then(function(a){r(a)})},searchQuery:function(a){var b=[];b.push(new i.QueryObject("storageSystemId",(new i.SearchType).INT,a)),i.setTextSearch(b),i.getQuery(o,d.transformStorageSystem).then(function(a){r(a)})}};var q=[{icon:"icon-delete",tooltip:"action-tooltip-delete",type:"confirm",confirmTitle:"storage-system-delete-confirmation",confirmMessage:"storage-system-delete-selected-content",enabled:function(){return p.anySelected()},onClick:function(){_.forEach(p.getSelectedItems(),function(a){a.actions["delete"].onClick(c)})}},{icon:"icon-edit",tooltip:"action-tooltip-edit",type:"link",enabled:function(){return p.onlyOneSelected()},onClick:function(){if(p.onlyOneSelected()){var a=_.first(p.getSelectedItems());a.actions.edit.onClick()}}}];p.getActions=function(){return q},p.addAction=function(){g.path(["storage-systems","add"].join("/"))},p.gridSettings=[{title:"storage-systems-serial-number",sizeClass:"sixth",sortField:"storageSystemId",getDisplayValue:function(a){return a.storageSystemId},type:"id"},{title:"storage-systems-model",sizeClass:"sixth",sortField:"model",getDisplayValue:function(a){return a.model}},{title:"common-label-total",sizeClass:"twelfth",sortField:"total.value",getDisplayValue:function(a){return a.total},type:"size"},{title:"common-label-free",sizeClass:"twelfth",sortField:"physicalUsed.value",getDisplayValue:function(a){return a.physicalFree},type:"size"},{title:"common-label-used",sizeClass:"twelfth",sortField:"physicalUsed.value",getDisplayValue:function(a){return a.physicalUsed},type:"size"}],p.getResources=function(){return i.get(a.dataModel.nextToken,o,d.transformStorageSystem,!1)};var r=function(b){a.dataModel.nextToken=b.nextToken,a.dataModel.displayList=b.resources,a.dataModel.itemCounts={filtered:a.dataModel.displayList.length,total:a.dataModel.total},l(b.resources)};p.displayList=h,a.dataModel=p,f.setupDataLoader(a,h,"storageSystemSearch")})}]),angular.module("rainierApp").controller("TierManagementCtrl",["$scope","orchestratorService","objectTransformService",function(a,b,c){function d(a){return{tierName:a}}b.tiers().then(function(b){c.transformTiers(b),a.model=b,a.updatedModel=angular.copy(b)}),a.disableButton=function(){for(var b=a.updatedModel.tiers,c=a.model.tiers,d=0;d<b.length;d++)if(b[d].tier!==c[d].tier)return!1;return!0},a.updateTierNames=function(){for(var c=a.updatedModel.tiers,e=a.model.tiers,f=0;f<c.length;f++)if(c[f].tier!==e[f].tier){var g=d(c[f].tier);b.updateTier(e[f].id,g)}}}]),angular.module("rainierApp").controller("UnprotectVolumesCtrl",["$scope","orchestratorService","objectTransformService","scrollDataSourceBuilderService","$routeParams","$q","$timeout","ShareDataService","synchronousTranslateService","paginationService","storageSystemVolumeService","queryService",function(a,b,c,d,e,f,g,h,i,j,k,l){var m=_.first(h.volumeListForUnprotect);m||window.history.back();var n=e.storageSystemId?e.storageSystemId:m.storageSystemId;a.title=i.translate("unprotect-volume")+" "+m.volumeId,j.clearQuery(),l.setQueryMapEntry("primaryVolumeIds",parseInt(m.volumeId)),j.get(null,k.REPLICATION_GROUPS_PATH,c.transformReplicationGroup,!1,n).then(function(b){var c=_.forEach(_.filter(b.resources,function(a){return!a.hasOwnProperty("isExternal")}),function(a){a.selected=!1});a.dataModel={replicationGroups:c,deleteSecondaryVolume:!0,enableSubmitButton:!1,view:"list",sort:{field:"name",reverse:!1,setSort:function(b){g(function(){a.dataModel.sort.field===b?a.dataModel.sort.reverse=!a.dataModel.sort.reverse:(a.dataModel.sort.field=b,a.dataModel.sort.reverse=!1)})}}},d.setupDataLoader(a,a.dataModel.replicationGroups)}),a.canSubmit=function(){a.dataModel.enableSubmitButton=void 0!==_.find(a.dataModel.displayList,function(a){return a.selected})},a.submitActions=function(){var c=[],d={primaryVolumeIds:[m.volumeId],deleteSecondaryVolume:a.dataModel.deleteSecondaryVolume};_.forEach(a.dataModel.displayList,function(a){a.selected&&c.push(b.unprotectReplicationGroup(n,a.id,d))}),f.all(c).then(function(){window.history.back()})}}]),angular.module("rainierApp").controller("volumeActionsRestoreSelectionCtrl",["$scope","orchestratorService","$location","$routeParams","ShareDataService","$filter","synchronousTranslateService","storageSystemVolumeService","paginationService","objectTransformService","$timeout","queryService",function(a,b,c,d,e,f,g,h,i,j,k,l){var m=d.storageSystemId;a.title=g.translate("restore-volume")+" "+e.restorePrimaryVolumeId,e.SVolsList||window.history.back();var n=function(b){a.restorePrimaryVolumeToken=b.nextToken,a.volumeRows=b.resources};a.selectedItem=null,a.orderByField="",a.reverseSort=!1,a.volumeRows=f("orderBy")(e.SVolsList,"originalSplitTime",!0),a.restorePrimaryVolumeToken=e.restorePrimaryVolumeToken,a.busy=!1,a.setSort=function(b){k(function(){a.orderByField===b?(l.setSort(b,!a.reverseSort),a.reverseSort=!a.reverseSort):(a.orderByField=b,l.setSort(b,!1),a.reverseSort=!1),i.getQuery(h.VOLUME_PAIRS_PATH,j.transformVolumePairs,m).then(function(a){n(a)})})},a.loadMore=function(){null===a.restorePrimaryVolumeToken||void 0===a.restorePrimaryVolumeToken||a.busy||(a.busy=!0,h.getVolumePairsAsPVol(a.restorePrimaryVolumeToken,e.restorePrimaryVolumeId,m).then(function(b){a.volumeRows=a.volumeRows.concat(b.resources),a.restorePrimaryVolumeToken=b.nextToken,a.busy=!1}))},m||(m=e.restoreStorageSystemId),a.submit=function(){var c=a.selectedItem,d={secondaryVolumeId:c.secondaryVolume.id.toString()};b.restoreReplicationGroup(c.primaryVolume.storageSystemId,c.primaryVolume.id,d).then(function(){window.history.back()})}}]),angular.module("rainierApp").directive("alertListItem",function(){return{scope:{model:"=ngModel"},templateUrl:"views/templates/alert-list-item.html",restrict:"E"}}),angular.module("rainierApp").directive("applicationStage",function(){return{templateUrl:"views/templates/application-stage.html",restrict:"E",transclude:!0,link:function(a,b,c){a.noPageFluid=c.noPageFluid}}}),angular.module("rainierApp").directive("arrayPolarDataVisualization",["d3service","synchronousTranslateService",function(a,b){var c=70,d=20,e=3,f=170,g=25,h=55,i=["#868686","#fcb663","#DADBDF","#D99027","#4A567F"],j=1e3,k=200,l=function(a,b){var c=null;b&&b.tooltip&&(c=b.tooltip,a.append("title").text(c))},m=function(a){var c;return _.isUndefined(a.percentage)||_.isNull(a.percentage)?c=a.capacity.size+" "+a.capacity.unit+" "+a.label:(c=_.isNumber(a.percentage)?a.percentage+"%":a.percentage.unlimited?b.translate("common-label-unlimited"):isNaN(a.percentage.value)?"0%":a.percentage.value+"%",c+=" "+a.label),c},n={_buildUsedDataGraphLayout:function(a,b){var c=b.data,d=b.container,e=b.height,f=b.width,g=b.cssClass,h=b.labelFunc,i=_.map(c,function(a){return{data:[{group:"value",value:a.value,item:a.item}],name:a.item.label}});i=i.map(function(a){return a.data.map(function(a){return{y:a.value,x:a.group,item:a.item}})}),a.layout.stack()(i),i=i.map(function(a){return a.map(function(a){return{x:a.y,y:a.x,x0:a.y0,item:a.item}})});var j=a.max(i,function(b){return a.max(b,function(a){return a.x+a.x0})}),k=a.scale.linear().domain([0,j]).range([0,f]),l=_.map(i[0],function(a){return a.y}),m=a.scale.ordinal().domain(l).rangeRoundBands([0,e],.1),n=d.selectAll("g").data(i).enter().append("g").attr("class",g);if(n.selectAll("rect").data(function(a){return a}).enter().append("rect").attr("x",function(a){return k(a.x0)}).attr("y",function(a){return m(a.y)}).attr("height",function(){return m.rangeBand()}).attr("width",function(a){return k(a.x)}).append("title").text(function(a){return a&&a.item?a.item.tooltip:""}),!_.isNull(h)&&!_.isUndefined(h)){var o=n.selectAll("text").data(function(a){return a}).enter().append("text").attr("x",function(a){var b=k(a.x);return k(a.x0)+b/2}).attr("y",function(a){var b=m.rangeBand();return m(a.y)+b/2}).attr("height",function(){return m.rangeBand()}).attr("width",function(a){return k(a.x)});h&&o.selectAll("tspan").data(function(a){var b=k(a.x),c=k(a.x0)+b/2;return h(a.item,c)}).enter().append("tspan").attr("x",function(a){return a.x}).attr("dy",function(a){return a.y}).text(function(a){return a.text})}},_buildDonutLayout:function(a,b){var c,f,g=b.container,h=b.used.percentage,i=b.radius,m=b.overflowWidth,n=2*Math.PI,o=null,p=null,q=null,r=!1;b.used.capacity?(c=b.used.capacity.value,f=b.free.capacity.value):(c=b.percentage,f=100);var s,t;b.subscribed&&_.isUndefined(h)||_.isNull(h)?(s=b.subscribed.percentageCapacity.value,c>-1&&f>-1&&c+f>0&&(o=c/(c+f+s)*n,o>n&&(o=n,r=!0)),f&&s>-1&&c>-1&&f+c+s>0&&(p=(f+c)/(f+c+s)*n,p>n&&(p=n,r=!0))):_.isUndefined(h)||_.isNull(h)?c&&f&&c+f>0&&(o=c/(c+f)*n,o>n&&(o=n,r=!0)):h.hasOwnProperty("unlimited")?h.unlimited||h.value>100?(o=n,r=!0):o=n*h.value/100:h>100?(o=n,r=!0):o=n*h/100;var u=a.svg.arc().innerRadius(i).outerRadius(i).startAngle(0),v=g.append("g"),w="#272727";b.subscribed||(w=b.free.color);var x=v.append("path").datum({endAngle:n}).attr("stroke",w).attr("d",u).attr("stroke-width",d),y=v.append("path").datum({endAngle:0}).attr("d",u).attr("stroke-width",d).attr("stroke",b.free.color).attr("stroke-linejoin","round"),z=v.append("path").datum({endAngle:0}).attr("d",u).attr("stroke-width",d).attr("stroke",b.used.color).attr("stroke-linejoin","round");if(b.unified){var A=b.unified.capacity.value;f&&A&&A+f>0&&(q=A/(A+f)*n,q>n&&(q=n,r=!0)),t=v.append("path").datum({endAngle:0}).attr("stroke",b.unified.color).attr("d",u).attr("stroke-width",d).attr("stroke-linejoin","round")}if(r){var B=v.append("g"),C=-1*(i+e/2+d/2),D=B.append("rect").attr("class","circle-fg-overflow").attr("rx",(d+e)/2).attr("ry",(d+e)/2).attr("x",-1*d/2).attr("y",C).attr("fill",b.free.color).attr("height",d+e).attr("width",0),E=B.append("text").attr("class","circle-fg-overflow-label").attr("y",C+d-2*e).attr("x",m+d+d).attr("height",d+e),F=Math.PI,G=a.svg.arc().innerRadius(i).outerRadius(i).startAngle(F),H=v.append("path").datum({endAngle:F}).attr("class","circle-fg").attr("d",G).attr("stroke-width",d).attr("stroke-linejoin","round");j-=k;var I=Math.round(F/n*j);t&&t.transition().ease("cubic-in-out").duration(I).call(function(b,c){b.attrTween("d",function(b){var d=a.interpolate(b.endAngle,c);return function(a){return b.endAngle=d(a),u(b)}})},F),z.transition().ease("cubic-in-out").duration(I).call(function(b,c){b.attrTween("d",function(b){var d=a.interpolate(b.endAngle,c);return function(a){return b.endAngle=d(a),u(b)}})},F),y.transition().ease("cubic-in-out").duration(I).call(function(b,c){b.attrTween("d",function(b){var d=a.interpolate(b.endAngle,c);return function(a){return b.endAngle=d(a),u(b)}})},F),H.transition().ease("cubic-in-out").duration(j-I).delay(I).call(function(b,c){b.attrTween("d",function(b){var d=a.interpolate(b.endAngle,c);return function(a){return b.endAngle=d(a),G(b)}})},n),D.transition().attr("width",m+d).duration(k).delay(j),E.transition().text((h.value||h)+"%").duration(0).delay(j+k)}else y.transition().ease("cubic-in-out").duration(j).call(function(b,c){b.attrTween("d",function(b){var d=a.interpolate(b.endAngle,c);return function(a){return b.endAngle=d(a),u(b)}})},p),z.transition().ease("cubic-in-out").duration(j).call(function(b,c){b.attrTween("d",function(b){var d=a.interpolate(b.endAngle,c);return function(a){return b.endAngle=d(a),u(b)}})},o),b.unified&&t.transition().ease("cubic-in-out").duration(j).call(function(b,c){b.attrTween("d",function(b){var d=a.interpolate(b.endAngle,c);return function(a){return b.endAngle=d(a),u(b)}})},q);l(z,b.used),b.subscribed?(l(x,b.subscribed),l(y,b.free)):l(x,b.free),l(t,b.unified)},_buildLegendLayout:function(a){var c,f=a.legendBoxWidth,g=a.legendBoxHeight,h=a.legendYOffset-10,i=a.circles,j=a.container.append("g").attr("class","polar-Viz-legend-container").attr("transform","translate(0,"+h+")"),k=12,n=0,o=2;_.forEach(i.reverse(),function(h,i){var p=2;c=0,h.subscribed?p=3:h.free.label||(c=2*k);var q=j.append("g").attr("class","legend-box legend-box-"+i);q.append("rect").attr("width",f).attr("height",g-c).attr("x",a.legendBoxX).attr("y",n).attr("rx",d/2).attr("ry",d/2).attr("class","bg");var r=g/2-e-k,s=n+r-k,t=s+k-o+e;q.append("rect").attr("width",k).attr("height",k).attr("x",k).attr("y",s+2*e).attr("rx",e/2).attr("ry",e/2).attr("fill",h.used.color);var u="";_.isUndefined(h.used.percentage)||_.isNull(h.used.percentage)?u=h.used.capacity.size+" "+h.used.capacity.unit+" "+h.used.label:(u=_.isNumber(h.used.percentage)?h.used.percentage+"%":h.used.percentage.unlimited?b.translate("common-label-unlimited"):isNaN(h.used.percentage.value)?"0%":h.used.percentage.value+"%",u+=" "+h.used.label);var v=q.append("text").attr("class","legend-value").attr("x",2*k+e).attr("y",t-o+e).text(u);if(l(v,h.used),!_.isUndefined(h.free)&&!_.isNull(h.free)){if(s=g/p+e+n,t=s+k-o+e,h.free.label){q.append("rect").attr("width",k).attr("height",k).attr("x",k).attr("y",g/p+e+n+2*e).attr("rx",e/2).attr("ry",e/2).attr("fill",h.free.color);var w=q.append("text").attr("class","legend-value").attr("x",2*k+e).attr("y",t-o+e).text(m(h.free));l(w,h.free)}if(r=r-k+e,h.subscribed){q.append("rect").attr("width",k).attr("height",k).attr("x",k).attr("y",g/p+e+n+r+e).attr("rx",e/2).attr("ry",e/2).attr("fill",h.subscribed.color),u=m(h.subscribed);var x=q.append("text").attr("class","legend-value").attr("x",2*k+e).attr("y",t+r-o).text(u);l(x,h.subscribed),n+=e+k}n+=g}})},_buildUnifiedLegendLayout:function(a,b,c){var f,g,h=a.legendBoxX+100,i=a.legendBoxWidth,j=a.legendBoxHeight,k=a.circles,n=9,o=17,p=45,q=a.container.append("g").attr("class","polar-viz-legend-container"),r=q.append("g").attr("transform","scale(2.8) translate("+a.legendBoxX+"10, "+o+")");r.append("text").attr("fill","unified"===b.view?"#A1E06E":"#444444").attr("font-size","3pt").attr("y",16).attr("x",a.legendBoxX+2).text("Unified"),r.append("path").attr("fill","unified"===b.view?"#A1E06E":"#444444").attr("d","M11.977,3.816c0.63,0,1.141-0.511,1.141-1.142V1.777c0-0.631-0.511-1.141-1.141-1.141h-8.77c-0.63,0-1.141,0.51-1.141,1.141v0.897c0,0.631,0.511,1.142,1.141,1.142h3.528v0.708H3.207c-0.63,0-1.141,0.511-1.141,1.141v0.898c0,0.63,0.511,1.141,1.141,1.141h3.528v0.707H3.207c-0.63,0-1.141,0.511-1.141,1.142v0.897c0,0.631,0.511,1.142,1.141,1.142h8.77c0.63,0,1.141-0.511,1.141-1.142V9.553c0-0.631-0.511-1.142-1.141-1.142H8.447V7.704h3.529c0.63,0,1.141-0.511,1.141-1.141V5.664c0-0.63-0.511-1.141-1.141-1.141H8.447V3.815L11.977,3.816L11.977,3.816z M8.263,10.452H3.601V9.551h4.662V10.452z M11.25,9.551c0.251,0,0.45,0.202,0.45,0.451s-0.199,0.45-0.45,0.45c-0.248,0-0.45-0.201-0.45-0.45S11.002,9.551,11.25,9.551z M9.602,9.551c0.248,0,0.45,0.202,0.45,0.451s-0.202,0.45-0.45,0.45s-0.45-0.201-0.45-0.45S9.354,9.551,9.602,9.551z M3.602,5.663h4.663v0.901H3.602V5.663z M11.25,5.663c0.251,0,0.45,0.201,0.45,0.45c0,0.25-0.199,0.451-0.45,0.451c-0.248,0-0.45-0.202-0.45-0.451C10.8,5.865,11.002,5.663,11.25,5.663z M9.602,5.663c0.248,0,0.45,0.202,0.45,0.45c0,0.249-0.202,0.451-0.45,0.451s-0.45-0.202-0.45-0.451C9.151,5.865,9.354,5.663,9.602,5.663z M11.25,1.774c0.251,0,0.45,0.202,0.45,0.451c0,0.249-0.199,0.45-0.45,0.45c-0.248,0-0.45-0.202-0.45-0.45C10.8,1.977,11.002,1.774,11.25,1.774z M9.602,1.774c0.248,0,0.45,0.202,0.45,0.451c0,0.249-0.202,0.45-0.45,0.45s-0.45-0.202-0.45-0.45C9.151,1.977,9.354,1.774,9.602,1.774zM3.602,1.774h4.663v0.901H3.602V1.774z"),q.append("g").append("rect").attr("y",p).attr("x",30).attr("width",47).attr("height",48).attr("fill","white").attr("fill-opacity",0).attr("opacity",0).on("click",function(){"unified"!==b.view&&(b.switchToUnified(),c.render(b))}).on("mouseover",function(){"unified"===b.view&&$(".legend-box").show()}).on("mouseout",function(){$(".legend-box").hide()}).attr("cursor","pointer");var s=q.append("g").attr("transform","scale(2.8) translate("+a.legendBoxX+"10, "+2*o+")");s.append("text").attr("fill","block"===b.view?"#A1E06E":"#444444").attr("font-size","3pt").attr("y",16).attr("x",a.legendBoxX+3).text("Block"),s.append("path").attr("fill","block"===b.view?"#A1E06E":"#444444").attr("d","M8.104,4.259c0,0.289-0.248,0.52-0.553,0.52c-0.309,0-0.556-0.231-0.556-0.52s0.248-0.522,0.556-0.522C7.855,3.737,8.104,3.97,8.104,4.259z M12.844,2.104V3.65h0.849v1.689h-0.849v1.548h0.849v1.687h-0.849v1.547h0.849v1.688H2.307V0.417h11.386v1.688L12.844,2.104L12.844,2.104z M10.41,8.975c-0.051-0.025-0.116-0.006-0.147,0.041c-0.481,0.777-1.547,1.281-2.712,1.281c-1.166,0-2.231-0.504-2.715-1.281C4.807,8.969,4.742,8.949,4.69,8.975c-0.052,0.027-0.075,0.086-0.05,0.135c0.52,1.068,1.661,1.762,2.91,1.762c1.245,0,2.389-0.693,2.908-1.762C10.484,9.061,10.462,9.002,10.41,8.975z M10.41,7.738c-0.051-0.025-0.116-0.005-0.147,0.041C9.781,8.557,8.716,9.061,7.551,9.061c-1.166,0-2.231-0.502-2.715-1.281C4.807,7.733,4.742,7.712,4.69,7.738c-0.052,0.026-0.075,0.086-0.05,0.137c0.52,1.068,1.661,1.759,2.91,1.759c1.245,0,2.389-0.691,2.908-1.759C10.484,7.825,10.462,7.765,10.41,7.738z M10.41,6.502c-0.051-0.025-0.116-0.007-0.147,0.04C9.781,7.32,8.716,7.823,7.551,7.823c-1.166,0-2.231-0.503-2.715-1.281C4.807,6.496,4.742,6.477,4.69,6.502c-0.052,0.026-0.075,0.084-0.05,0.136c0.52,1.068,1.661,1.761,2.91,1.761c1.245,0,2.389-0.691,2.908-1.761C10.484,6.587,10.462,6.529,10.41,6.502z M10.639,4.259c0-1.604-1.384-2.905-3.088-2.905c-1.707,0-3.09,1.3-3.09,2.905c0,1.604,1.383,2.903,3.09,2.903C9.256,7.162,10.639,5.862,10.639,4.259z"),q.append("g").append("rect").attr("y",2*p+e).attr("x",30).attr("width",47).attr("height",48).attr("fill","white").attr("fill-opacity",0).on("click",function(){"block"!==b.view&&(b.switchToBlock(),c.render(b))}).on("mouseover",function(){"block"===b.view&&$(".legend-box").show()}).on("mouseout",function(){$(".legend-box").hide()}).attr("cursor","pointer");var t=q.append("g").attr("transform","scale(2.8) translate("+a.legendBoxX+"10, "+3*o+")");t.append("path").attr("fill","file"===b.view?"#3D84F5":"#444444").attr("d","M13.249,8.768c-0.401,0-0.806,0-1.207,0V7.73c0-1.232-0.998-2.231-2.23-2.231H8.563V3.624c0.414,0,0.828,0,1.242,0c0.279,0,0.371-0.092,0.371-0.372c0-0.11,0-0.205,0-0.296c0-0.003,0-0.005,0-0.008V2.032c0-0.074,0-0.148,0-0.229V1.006c0-0.281-0.092-0.372-0.371-0.372c-0.622,0-1.244,0-1.867,0L7.431,0.136c-0.461,0-0.925-0.001-1.386,0c-0.278,0-0.37,0.093-0.37,0.37c0,0.109,0,0.206-0.001,0.297c0,0.002,0,0.005,0,0.008v0.916c0,0.074,0,0.148,0,0.228v1.297c0.001,0.281,0.092,0.372,0.373,0.372c0.414,0,0.828,0,1.243,0V5.5H6.041c-1.231,0-2.23,0.999-2.23,2.231V8.27c-0.402,0-0.804-0.002-1.206,0c-0.278,0-0.371,0.092-0.371,0.371c0,0.108,0,0.205,0,0.295c0,0.003,0,0.006,0,0.009V9.86c0,0.075,0,0.148,0,0.228v1.298c0,0.28,0.091,0.371,0.372,0.371c1.253,0.001,2.507,0.001,3.76,0c0.278,0,0.371-0.092,0.371-0.371c0-0.108,0-0.206,0-0.296c0-0.004,0-0.006,0-0.008v-0.916c0-0.074,0-0.148,0-0.229V9.139c0-0.28-0.091-0.37-0.372-0.37c-0.427,0-0.853,0-1.279,0V7.731c0-0.529,0.428-0.957,0.955-0.957h3.771c0.527,0,0.956,0.428,0.956,0.957V8.27c-0.428,0-0.854,0-1.279,0c-0.278,0-0.371,0.093-0.371,0.371c0,0.109,0,0.206,0,0.297c0,0.003,0,0.004,0,0.008v0.916c0,0.074,0,0.148,0,0.229v1.296c0,0.281,0.092,0.372,0.371,0.372c1.253,0.001,2.507,0.001,3.761,0c0.277,0,0.37-0.092,0.37-0.372c0-0.108,0-0.205,0-0.296c0-0.003,0-0.006,0-0.008v-0.915c0-0.075,0-0.148,0-0.229V9.14C13.618,8.859,13.526,8.769,13.249,8.768L13.249,8.768z"),t.append("text").attr("fill","file"===b.view?"#3D84F5":"#444444").attr("font-size","3pt").attr("y",16).attr("x",a.legendBoxX+e+1).text("File"),q.append("g").append("rect").attr("y",3*p+2*e).attr("x",30).attr("width",47).attr("height",48).attr("fill","white").attr("fill-opacity",0).on("click",function(){"file"!==b.view&&(b.switchToFile(),c.render(b))}).on("mouseover",function(){"file"===b.view&&$(".legend-box").show()}).on("mouseout",function(){$(".legend-box").hide()}).attr("cursor","pointer");var u=12,v=65,w=q.append("g").attr("class","legend-box legend-box-0").attr("display","none");w.append("rect").attr("width",i).attr("height",j).attr("stroke","white").attr("stroke-width","1").attr("x",h).attr("y",v+e).attr("rx",d/2).attr("ry",d/2).attr("class","bg"),_.forEach(k.reverse(),function(a){a.unified&&(w.append("rect").attr("width",u).attr("height",u).attr("x",h+u).attr("y",v+3*e).attr("rx",e/2).attr("ry",e/2).attr("fill",a.unified.color),f=m(a.unified),g=w.append("text").attr("class","legend-value").attr("fill","white").attr("x",2*u+e+h).attr("y",v+3*e+n).text(f),l(g,a.unified),v+=e+u),w.append("rect").attr("width",u).attr("height",u).attr("x",h+u).attr("y",v+3*e).attr("rx",e/2).attr("ry",e/2).attr("fill",a.used.color),f=m(a.used);var b=w.append("text").attr("class","legend-value").attr("fill","white").attr("x",2*u+e+h).attr("y",v+3*e+n).text(f);if(l(b,a.used),!_.isUndefined(a.free)&&!_.isNull(a.free)){v+=e+u,w.append("rect").attr("width",u).attr("height",u).attr("x",h+u).attr("y",v+3*e).attr("rx",e/2).attr("ry",e/2).attr("fill",a.free.color);var c=w.append("text").attr("class","legend-value").attr("fill","white").attr("x",2*u+e+h).attr("y",v+3*e+n).text(a.free.capacity.size+" "+a.free.capacity.unit+" "+a.free.label);l(c,a.free),v+=e+u,a.subscribed&&(w.append("rect").attr("width",u).attr("height",u).attr("x",h+u).attr("y",v+3*e).attr("rx",e/2).attr("ry",e/2).attr("fill",a.subscribed.color),f=m(a.subscribed),g=w.append("text").attr("class","legend-value").attr("fill","white").attr("x",2*u+e+h).attr("y",v+3*e+n).text(f),l(g,a.subscribed),v+=e+u)}})},_buildBreakdownDataLayout:function(a,b,c,f){var j=c.legendBoxWidth,k=c.legendYOffset,l=c.svgWidth,m=c.legendItemsHeight,o=c.finalRadius,p=c.onlyShowBreakDown,q=260,r=17,s=c.container.append("g").attr("class","polar-Viz-breakdown");p===!0?s.attr("transform","translate("+(j-(l/2.5+e))+","+k/3.5+")"):(s.attr("transform","translate("+(j-e)+","+k+")"),b.unified&&c.container.append("g").attr("class","polar-Viz-breakdown").attr("transform","translate(0,"+k+")").append("rect").attr("class","breakdown-bg").attr("width",j+e).attr("height",m).attr("rx",d/2).attr("ry",d/2)),p||s.append("rect").attr("class","breakdown-bg").attr("width",l-j+e).attr("height",m).attr("rx",d/2).attr("ry",d/2);var t,u=(m-5*e)/4;t=p===!0?c.breakdownViewWidth:c.breakdownViewWidth-2*d-4*e;var v=2*e+o,w=2*e+u/2;if(s.append("text").attr("y",w).attr("height",u).attr("x",v+e).attr("class","header").text(c.title),"file"===b.view||b.hideButtons||(s.append("rect").on("click",function(){b.tiers||(b.showTiersBreakDown(),f.render(b))}).attr("y",w-r).attr("cursor","pointer").attr("height",g).attr("width",h).attr("fill",b.tiers?"#a1e06e":"#E3E4E7").attr("stroke","white").attr("x",v+q),s.append("text").on("click",function(){b.tiers||(b.showTiersBreakDown(),f.render(b))}).attr("y",w).attr("cursor","pointer").attr("height",u).attr("x",v+q+5*e+2).attr("font-size",10).attr("class","header").text("Tiers"),s.append("rect").on("click",function(){b.tiers&&(b.showProtectionBreakDown(),f.render(b))}).attr("y",w-r).attr("cursor","pointer").attr("height",g).attr("width",h).attr("fill",b.tiers?"#E3E4E7":"#a1e06e").attr("stroke","white").attr("x",v+q+h),s.append("text").on("click",function(){b.tiers&&(b.showProtectionBreakDown(),f.render(b))}).attr("y",w).attr("cursor","pointer").attr("height",u).attr("x",v+q+h+e).attr("font-size",10).attr("class","header").text("Protection")),w+=4*e,"file"===b.view||b.tiers){var x=290,y=55,z=40,A=50,B=24,C=0;_.each(b.tierBreakdown,function(a){s.append("circle").attr("r",5).attr("cx",v+5).attr("cy",A).attr("fill","white").attr("stroke",i[C]).attr("stroke-width",4),s.append("text").attr("y",y).attr("height",u).attr("x",v+18).attr("font-size",12).text(a.name),s.append("rect").attr("y",z).attr("height",20).attr("width",x).attr("x",v+80).attr("fill",i[C]).attr("opacity",".6").append("title").text(a.toolTip),s.append("rect").attr("y",z).attr("title",a.toolTip).attr("height",20).attr("width",parseInt(x*a.percent/100)).attr("x",v+80).attr("fill",i[C]).append("title").text(a.toolTip),y+=B,z+=B,A+=B,C++})}else{p===!0?s.append("rect").attr("y",w).attr("class","separator-top").attr("height",2).attr("width",t).attr("x",v+e):s.append("rect").attr("y",w).attr("class","separator-top").attr("height",2).attr("width",l-j-e),w+=4*e;var D=s.append("g").attr("y",w).attr("height",u).attr("transform","translate("+v+","+w+")").attr("class","data-tips"),E={data:_.map(c.data,function(a){return{value:1,item:a}}),container:D,height:u,width:t,cssClass:"data-tip",labelFunc:function(a,b){return a?[{x:b,y:-2,text:a.capacity.size+" "+a.capacity.unit},{x:b,y:11,text:a.label}]:[]}};n._buildUsedDataGraphLayout(a,E),w+=e+u;var F=s.append("g").attr("y",w).attr("height",u).attr("transform","translate("+v+","+w+")").attr("class","used-data-pills");E={data:_.map(c.data,function(a){return{value:a.capacity.value,item:a}}),container:F,height:u,width:t,cssClass:"data-pill",labelFunc:null},n._buildUsedDataGraphLayout(a,E),w+=4*e+u,p===!0?s.append("rect").attr("y",w).attr("class","separator-bottom").attr("height",1).attr("width",t).attr("x",v+e):s.append("rect").attr("y",w).attr("class","separator-bottom").attr("height",1).attr("width",l-j-e),w+=2*e;var G=a.scale.linear().domain([0,100]).range([0,t]),H=a.svg.axis().scale(G).ticks(5).tickSize(0).orient("bottom");s.append("g").attr("y",w).attr("height",u).attr("transform","translate("+v+","+w+")").attr("class","used-data-axis").call(H).append("text").attr("class","axis-range-label").attr("y",11).attr("x",t+4*e).text("%")}},buildLayout:function(a,b,g,h,i,j,k){g.view&&(f=100),g.unified||(f=170);var m=400,o=0;h===!0&&(m=60),j===!0&&(m=500);var p=c,q=_.map(g.items,function(a,b){var c=_.cloneDeep(a);return c.index=a.index||b,c.radius=p,p+=d+e,c}),r=q.length,s=p+f+e,t=2*(p-d-2*r*e),u=(t-(r-1)*e)/r+e;"unified"===g.view&&(u+=30),1===r&&(t=u=85);var v=1.5*d+2*e;p-=d/2;var w,x=f+2*p+m;w=j===!0?210:2*p,_.forEach(g.items,function(c){if(!_.isUndefined(c.used.breakdown)&&!_.isNull(c.used.breakdown)){var d={container:b,data:c.used.breakdown,legendBoxWidth:s,legendBoxHeight:u,legendYOffset:v,svgWidth:x,legendItemsHeight:t,finalRadius:p,title:g.tiers?g.tiersBreakdownLabel:c.used.breakdownLabel,breakdownViewWidth:m,onlyShowBreakDown:j};n._buildBreakdownDataLayout(a,g,d,k)}});var y=f;i===!0&&(s=0,y=0,x=w+4*e);var z={legendBoxX:o,legendBoxWidth:s,legendBoxHeight:u,legendYOffset:v,container:b,circles:q};if(g.unified||i||n._buildLegendLayout(z,g,k),j===!0)b.attr("version","1.1").attr("viewBox","0 0 "+x+" "+(w+3*e)).attr("preserveAspectRatio","xMinYMin meet").attr("transform","scale(1,1)").attr("class","file"===g.view||g.file?"pdv file":"pdv default");else{var A=b.attr("version","1.1").attr("viewBox","0 0 "+x+" "+(w+3*e)).attr("preserveAspectRatio","xMinYMin meet").attr("transform","scale(1,1)").attr("class","file"===g.view||g.file?"pdv default file":"pdv default").append("g").attr("transform","translate("+(y+6+p)+","+(p+2*e)+")");A.append("circle").attr("r",p);var B=A.append("g").attr("class","pdv summary-group"),C=B.append("g").attr("class","label-container");C.append("text").attr("class","number").attr("y",-6).text(g.total.capacity.size),C.append("text").attr("class","unit").attr("y",14).text(g.total.capacity.unit);var D=C.append("text").attr("class","label").attr("dy",30).text(g.total.label);l(D,g.total);var E=B.append("g").attr("class","label-container").attr("title",g.total.capacity.size+" "+g.total.capacity.unit+" "+g.total.label);E.append("circle").attr("r",60),E.append("text").attr("class","number").attr("dy",-6).text(g.total.capacity.size),E.append("text").attr("class","unit").attr("dy",14).text(g.total.capacity.unit),E.append("text").attr("class","label").attr("dy",33).text(g.total.label),_.forEach(q,function(b){b.container=B,b.overflowWidth=p,n._buildDonutLayout(a,b)})}i===!0?s=0:g.unified&&n._buildUnifiedLegendLayout(z,g,k)}};return{scope:{data:"=ngModel",noBreakDown:"=",noLegendBox:"=",onlyBreakDown:"="},restrict:"E",link:function(b,c){a.d3().then(function(a){var d=c[0],e=a.select(d).append("svg");b.$watch(function(){return b.data},function(){b.render(b.data)},!0),b.render=function(c){e.selectAll("*").remove(),c&&n.buildLayout(a,e,c,b.noBreakDown,b.noLegendBox,b.onlyBreakDown,b)}})}}}]),angular.module("rainierApp").directive("attachVolumeList",function(){return{scope:{model:"=ngModel",data:"=data",select:"&"},templateUrl:"views/templates/attach-volume-list.html",restrict:"E"}}),angular.module("rainierApp").directive("backButton",function(){return{restrict:"A",link:function(a,b){b.on("click",function(){window.history.back()})}}}),angular.module("rainierApp").directive("barDataVisualization",function(){return{scope:{model:"=ngModel"},templateUrl:"views/templates/bar-data-visualization.html",restrict:"E",link:function(a,b){var c,d=parseInt(a.model.usedCapacityInBytes.value/a.model.capacityInBytes.value*100);c=a.model.physicalCapacityInBytes?parseInt(a.model.physicalCapacityInBytes.value/a.model.capacityInBytes.value*100):parseInt((a.model.usedCapacityInBytes.value+a.model.availableCapacityInBytes.value)/a.model.capacityInBytes.value*100),b.find(".file-used").popover({placement:"bottom",content:d+"% Used"}),7>d&&(d=7),a.model.onlyShowTwoBars&&(c=100),a.model.used=d+"%",a.model.allocated=c+"%"}}}),angular.module("rainierApp").directive("breadcrumbBar",["breadcrumbService","$timeout",function(a,b){return{templateUrl:"views/templates/breadcrumb-bar.html",restrict:"E",link:function(c){b(function(){c.breadcrumbs=a.get()})}}}]),angular.module("rainierApp").directive("capacityAlert",function(){return{scope:{alertCount:"=ngModel",alertLevel:"="},templateUrl:"views/templates/capacity-alert.html",restrict:"E",replace:!0,controller:["$scope","monitoringService",function(a,b){a.launchMonitoring=function(c){b.launchMonitoring(c,a.alertCount)},b.getSummaryStatus(function(b){var c="error",d="healthy";a.capacityAlertTotals=b.capacityAlertTotals,a.alertCount=b.capacityAlertTotals.totalComponentWiseCapacityAlerts,a.alertLevel=b.capacityAlertTotals&&"0"!==b.capacityAlertTotals.totalComponentWiseCapacityAlerts&&0!==b.capacityAlertTotals.totalComponentWiseCapacityAlerts?c:d})}]}}),angular.module("rainierApp").directive("capacitySlider",["$timeout",function(a){return{scope:{modelMin:"=ngModelMin",modelMax:"=ngModelMax",min:"=sliderMin",max:"=sliderMax"},restrict:"A",link:function(b,c){b.onSlide=function(){a(function(){$('[data-toggle="popover"]').popover()})},a(function(){$(c).slider({range:"min",min:b.min,max:b.max,slide:b.onSlide}),$('[data-toggle="popover"]').popover()})}}}]),angular.module("rainierApp").directive("commonPageHeader",function(){return{templateUrl:"views/templates/common-page-header.html",restrict:"E",replace:!0,link:function(a,b,c){a.noPageFluid=c.noPageFluid}}}),angular.module("rainierApp").directive("confirmationModal",function(){return{scope:{title:"@title",content:"@content",clickOk:"&",confirmClick:"&",modalId:"@",switchEnabled:"=",trueText:"@trueText",falseText:"@falseText",requireSelection:"&"},templateUrl:"views/templates/confirmation-modal.html",restrict:"E"}}),angular.module("rainierApp").directive("csvFileUpload",function(){return{scope:{model:"=ngModel",title:"@ngTitle"},templateUrl:"views/templates/csv-file-upload.html",restrict:"E",controller:["$scope","fileParserService",function(a,b){a.$watch("files",function(c){c&&0!==c.length&&b.parseCsv(c[0]).then(function(b){a.model=b})})}]}}),angular.module("rainierApp").directive("customPopover",["$popover",function(a){return{restrict:"A",link:function(b,c){var d=a(c,{title:"Job Id",contentTemplate:"views/templates/pop-over-template.html",html:!0,trigger:"manual",autoClose:!0,scope:b,container:"body"});b.showPopover=function(){d.show()}}}}]),angular.module("rainierApp").directive("datepickerPopup",["dateFilter","datepickerPopupConfig",function(a,b){return{restrict:"A",priority:1,require:"ngModel",link:function(c,d,e,f){var g=e.datepickerPopup||b.datepickerPopup;f.$formatters.push(function(b){return a(b,g)})}}}]),angular.module("rainierApp").directive("diskManageRightFilter",function(){return{scope:{model:"=ngModel",select:"&"
},templateUrl:"views/templates/disk-manage-right-filter.html",restrict:"E"}}),angular.module("rainierApp").directive("diskManageTiles",function(){return{scope:{model:"=ngModel",select:"&"},templateUrl:"views/templates/disk-manage-tiles.html",restrict:"E"}}),angular.module("rainierApp").directive("diskSize",["diskSizeService",function(a){function b(b,c,d){b.builder=function(e){e?_.isPlainObject(b.size)||(e=a.getDisplaySize(b.size)):e=a.createDisplaySize(0,"GB");var f=d.wrappedIn;f||(f="h1");var g=["<",f,">",e.size,"&nbsp;",e.unit," ",d.postFix,"</",f,">"].join("");c.html(g)},b.$watch(function(){return b.size},function(a){b.builder(a)})}return{scope:{size:"=ngModel"},replace:!0,restrict:"E",link:b}}]),angular.module("rainierApp").directive("donutChart",function(){function a(a,b){var c=760,d=280,e=Math.min(c,d),f=d3.select(b[0]).append("svg"),g=function(){var b=a.chartData||a.dataModel.chartData,g=d3.layout.pie().sort(null),h=d3.svg.arc().outerRadius(e/2*.9).innerRadius(e/2*.5),i=d3.scale.ordinal().range(["#7bc142","#bcda89","#2e464c"]);f.attr({width:c,height:d});var j=f.append("g").attr("transform","translate("+c/2+","+d/2+")");j.selectAll("path").data(g(b)).enter().append("path").attr("fill",function(a,b){return i(b)}).style("stroke","white").attr("d",h).transition().ease("exp").duration(1e3).attrTween("d",function(a){var b=d3.interpolate({startAngle:1.1*Math.PI,endAngle:1.1*Math.PI},a);return function(a){return h(b(a))}});var k=f.selectAll(".legend").data(i.domain()).enter().append("g").attr("class","legend").attr("transform",function(a,b){return"translate(0,"+20*b+")"});k.append("rect").attr("x",c-590).attr("y",30).attr("width",18).attr("height",18).style("fill",i),k.append("text").attr("x",c-600).attr("y",39).attr("dy",".35em").style("text-anchor","end").text(function(b){return b>=a.dataModel.chartNames.length?"":a.dataModel.chartValues[b]+"  "+a.dataModel.chartNames[b]})};a.$watch("chartData",function(){g()},!0)}return{link:a,restrict:"E"}}),angular.module("rainierApp").directive("donutDynamicChart",function(){function a(a,b){var c=800,d=290,e=Math.min(c,d),f=d3.select(b[0]).append("svg"),g=function(){var b=[];a.chartData?b=a.chartData:a.model&&a.model.chartData?b=a.model.chartData:a.dataModel&&a.dataModel.chartData&&(b=a.dataModel.chartData);for(var g=[],h=[],i=0;i<b.length;++i)g.push(b[i].value),h.push(b[i].name);for(var j=[],k=0;k<h.length;++k){var l={name:h[k],data:g[k]};j.push(l)}var m=d3.layout.pie().sort(null),n=d3.svg.arc().outerRadius(e/2*.9).innerRadius(e/2*.5),o=d3.scale.ordinal().range(["#7bc142","#bcda89","#2e464c","#5c8793","#1692ae","#29abc0","#7a9ea7","#47aa47","#c5d246","#307539","#42b766","#5cc1a3","#84b3c6","#0c4f12"]);f.attr({width:c,height:d});var p=f.append("g").attr("transform","translate("+c/2+","+d/2+")");p.selectAll("path").data(m(g)).enter().append("path").attr("fill",function(a,b){return o(b)}).style("stroke","white").attr("d",n).data(j).append("title").text(function(a){return a.data+"  "+a.name}).transition().ease("exp").duration(1e3).attrTween("d",function(a){var b=d3.interpolate({startAngle:1.1*Math.PI,endAngle:1.1*Math.PI},a);return function(a){return n(b(a))}});var q=f.selectAll(".legend").data(o.domain()).enter().append("g").attr("class","legend").attr("transform",function(a,b){return"translate(0,"+20*b+")"});q.append("rect").attr("x",c-590).attr("y",30).attr("width",18).attr("height",18).style("fill",o),q.append("text").attr("x",c-600).attr("y",39).attr("dy",".35em").style("text-anchor","end").text(function(a){return a>=h.length?"":g[a]+"  "+h[a]})};a.$watch("chartData",function(){g()},!0)}return{link:a,restrict:"E"}}),angular.module("rainierApp").directive("dpAlertSecondaryVolumes",function(){return{templateUrl:"views/templates/dp-alert-secondary-volumes.html",restrict:"E",replace:!0,controller:["$scope","monitoringService",function(a,b){a.alertModel.launchDpMonitoring=function(){b.launchDpMonitoring(a.alertModel.alertCount)}}]}}),angular.module("rainierApp").directive("dpAlert",function(){return{scope:!1,templateUrl:"views/templates/dp-alert.html",restrict:"E",replace:!0,controller:["$scope","monitoringService",function(a,b){a.launchDpMonitoring=function(){b.launchDpMonitoring(a.alertCount)},b.getDpAlerts(function(b){var c="healthy",d="error";a.alertCount=b.total,a.alertLevel="0"!==b.total&&0!==b.total?d:c})}]}}),angular.module("rainierApp").directive("dpMultiCarouselItem",function(){return{scope:{model:"=ngModel"},restrict:"E",templateUrl:"views/templates/dp-multi-carousel-item.html"}}),angular.module("rainierApp").directive("dpSummaryAlertPanel",function(){return{scope:!1,templateUrl:"views/templates/dp-summary-alert-panel.html",restrict:"E",controller:["$scope","monitoringService",function(a,b){function c(a){a.state=a.state===g?h:g,a.title=a.title===e?f:e,a.arrow=a.arrow===i?j:i}function d(){a.toggleAction(a.DP_ID)}var e="Expand",f="Collapse",g="collapsed",h="expanded",i="icon-right-arrow",j="icon-left-arrow";a.CAPACITY_ID="capacity",a.DP_ID="dp",a.HARDWARE_ID="hardware",a.capacityPanelState={state:g,title:e,arrow:i},a.dpPanelState={state:g,title:e,arrow:i},a.hardwarePanelState={state:g,title:e,arrow:i},a.launchMonitoringPage=function(a,c){b.launchMonitoring(a,c)},a.toggleAction=function(b){switch(b){case a.CAPACITY_ID:c(a.capacityPanelState),a.dpPanelState.state===h&&c(a.dpPanelState),a.hardwarePanelState.state===h&&c(a.hardwarePanelState);break;case a.DP_ID:c(a.dpPanelState),a.capacityPanelState.state===h&&c(a.capacityPanelState),a.hardwarePanelState.state===h&&c(a.hardwarePanelState);break;case a.HARDWARE_ID:c(a.hardwarePanelState),a.dpPanelState.state===h&&c(a.dpPanelState),a.capacityPanelState.state===h&&c(a.capacityPanelState)}},d()}]}}),angular.module("rainierApp").directive("dpSummaryHeader",function(){return{scope:{model:"=ngModel"},templateUrl:"views/templates/dp-summary-header.html",restrict:"E"}}),angular.module("rainierApp").directive("evsIconTile",function(){return{scope:{itemCount:"=ngModel"},templateUrl:"views/templates/evs-icon-tile.html",restrict:"E",replace:!0}}),angular.module("rainierApp").directive("fabricSwitchesIconTile",function(){return{scope:{itemCount:"=ngModel"},templateUrl:"views/templates/fabric-switches-icon-tile.html",restrict:"E",replace:!0}}),angular.module("rainierApp").directive("filePoolTierList",function(){return{scope:{model:"=ngModel",select:"&"},templateUrl:"views/templates/file-pool-tier-list.html",restrict:"E"}}),angular.module("rainierApp").directive("frequentActionsBar",function(){return{templateUrl:"views/templates/frequent-actions-bar.html",restrict:"E"}}),angular.module("rainierApp").directive("hardwareAlert",function(){return{scope:{alertCount:"=ngModel",alertLevel:"="},templateUrl:"views/templates/hardware-alert.html",controller:["$scope","monitoringService",function(a,b){a.launchMonitoring=function(c){b.launchMonitoring(c,a.alertCount)},b.getSummaryStatus(function(b){var c="error",d="healthy";a.hardwareAlertTotals=b.hardwareAlertTotals,a.alertCount=b.hardwareAlertTotals.totalComponentWiseHardwareAlerts,a.alertLevel=b.hardwareAlertTotals&&"0"!==b.hardwareAlertTotals.totalComponentWiseHardwareAlerts&&0!==b.hardwareAlertTotals.totalComponentWiseHardwareAlerts?c:d})}],restrict:"E",replace:!0}}),angular.module("rainierApp").directive("hitachiBrandLogo",function(){return{templateUrl:"views/templates/hitachi-brand-logo.html",restrict:"E"}}),angular.module("rainierApp").directive("hostDpAlert",function(){return{scope:{alertCount:"=ngModel",alertLevel:"="},templateUrl:"views/templates/host-dp-alert.html",restrict:"E",replace:!0}}),angular.module("rainierApp").directive("hostListItem",function(){return{scope:{model:"=ngModel",data:"=data",select:"&"},templateUrl:"views/templates/host-list-item.html",restrict:"E",link:function(a){a.model||(a.model={usage:"0%"})}}}),angular.module("rainierApp").directive("hostSummaryHeader",function(){return{scope:{model:"=ngModel"},templateUrl:"views/templates/host-summary-header.html",restrict:"E"}}),angular.module("rainierApp").directive("hostsIconTile",function(){return{scope:{itemCount:"=ngModel"},templateUrl:"views/templates/hosts-icon-tile.html",restrict:"E",replace:!0}}),angular.module("rainierApp").directive("inventoryActions",function(){return{scope:{dataModel:"=ngModel"},templateUrl:"views/templates/inventory-actions.html",restrict:"E"}}),angular.module("rainierApp").directive("inventoryPage",function(){var a=["$scope",function(a){a.toggleExpandButton=function(b){b.opened?$("#"+b.id).attr("aria-expanded","false"):($("#"+b.id).attr("aria-expanded","true"),_.forEach(a.dataModel.displayList,function(a){a.id!==b.id&&(a.opened=!1,$("#"+a.id).attr("aria-expanded","false"),a.hasOwnProperty("volumePairs")&&(a.volumePairs=[]))}))}}];return{scope:{dataModel:"=ngModel",listCountSummaryTitle:"@",listCountTooltip:"@",summaryModel:"=",filterModel:"=",summaryTemplate:"@",tileItemTemplate:"@",filterTemplate:"@",gridHeaderTemplate:"@",gridItemTemplate:"@",listDetailsTemplate:"@",pageActions:"=",selectedItemActions:"="},controller:a,templateUrl:"views/templates/inventory-page.html",restrict:"E"}}),angular.module("rainierApp").directive("jobSplash",["$rootScope","$timeout",function(a,b){return{scope:{},templateUrl:"views/templates/job-splash.html",replace:!0,restrict:"E",link:function(c,d){var e=$(d);e.hide(),a.$on("jobCreated",function(a,d){c.splashJob=d,e.slideDown("slow"),b(function(){e.slideUp("slow")},3e3)})}}}]),angular.module("rainierApp").directive("jobsAlert",function(){return{scope:{model:"=ngModel"},templateUrl:"views/templates/jobs-alert.html",controller:["$scope","orchestratorService",function(a,b){var c=new Date,d=new Date;d.setDate(d.getDate()-1),b.jobsTimeSlice(d.toISOString(),c.toISOString()).then(function(b){var c=0,d=0,e=0,f="error",g="healthy";_.forEach(b.jobs,function(a){a.parentJobId||("SUCCESS"===a.status?c+=1:"SUCCESS_WITH_ERRORS"===a.status?d+=1:"FAILED"===a.status&&(e+=1))}),a.model.successCount=c,a.model.successWithErrorCount=d,a.model.failedCount=e,a.model.totalErrors=e+d,a.model.level=a.model.totalErrors>0?f:g})}],restrict:"E",replace:!0}}),angular.module("rainierApp").directive("loadingIndicator",function(){var a=function(a,b,c,d,e,f){var g=d||20,h=f||"#fff",i=e||2,j=Math.min(b,c)||20,k=Math.max(b,c)||25,l=k+i,m=k+i,n=Raphael(a,2*k+2*i,2*k+2*i),o=[],p=[],q=2*Math.PI/g,r={stroke:h,"stroke-width":i,"stroke-linecap":"round"};Raphael.getColor.reset();for(var s=0;g>s;s++){var t=q*s-Math.PI/2,u=Math.cos(t),v=Math.sin(t);p[s]=1/g*s,o[s]=n.path([["M",l+j*u,m+j*v],["L",l+k*u,m+k*v]]).attr(r),"rainbow"===h&&o[s].attr("stroke",Raphael.getColor())}var w;return function x(){p.unshift(p.pop());for(var a=0;g>a;a++)o[a].attr("opacity",p[a]);n.safari(),w=setTimeout(x,1e3/g)}(),function(){clearTimeout(w),n.remove()}};return{restrict:"A",link:function(b,c,d){var e=c[0],f=d.color;a(e,22,16,24,1,f)}}}),angular.module("rainierApp").directive("multiCarouselItem",function(){return{scope:{model:"=ngModel"},restrict:"E",templateUrl:"views/templates/multi-carousel-item.html"}}),angular.module("rainierApp").directive("navBarHeader",["authService","$location","Restangular","$timeout","$window","$modal","$rootScope","orchestratorService","ShareDataService","synchronousTranslateService","helpuiService",function(a,b,c,d,e,f,g,h,i,j,k){return{templateUrl:"views/templates/nav-bar-header.html",restrict:"E",link:function(c){c.authModel={logout:function(){a.logout(),b.path("/login")}};var f=b.path(),l=0===f.indexOf("/jobs"),m=0===f.indexOf("/monitoring"),n=j.translate("product-name"),o=j.translate("product-copy-right");c.tabsModel={jobsSelected:l,dashboardSelected:!l&&!m,monitoringSelected:m},c.versionModel={productName:n,copyRight:o,versionInfo:e.sessionStorage.getItem("versionInfo"),helpOrAboutClicked:void 0!==i.helpOrAboutClicked&&null!==i.helpOrAboutClicked?i.helpOrAboutClicked:!1,toggleHelpContent:function(){k.toggleHelpPane()},closeHelpContent:function(){k.closeHelpPane()},dropDownRemove:function(){document.getElementById("about").removeAttribute("data-toggle")},dropDownAdd:function(){document.getElementById("about").setAttribute("data-toggle","dropdown")},clickOnHelpOrAbout:function(){c.versionModel.helpOrAboutClicked=!0,i.helpOrAboutClicked=c.versionModel.helpOrAboutClicked},clickOnIconPre:function(){c.versionModel.helpOrAboutClicked||c.versionModel.dropDownAdd()},clickOnIconPost:function(){c.versionModel.helpOrAboutClicked&&(c.versionModel.dropDownRemove(),c.versionModel.helpOrAboutClicked=!1,i.helpOrAboutClicked=c.versionModel.helpOrAboutClicked)},getCurrentYear:function(){return(new Date).getFullYear()}},void 0===e.sessionStorage.versionInfo&&h.productVersionInfo().then(function(a){e.sessionStorage.setItem("versionInfo",a.productVersionInfo),c.versionModel.versionInfo=e.sessionStorage.getItem("versionInfo")}),c.settingsModel={launchSnmpManager:function(){b.path("/snmp-managers")},security:function(){b.path("/security")},tierManagement:function(){b.path("/tier-management")},launchChangeLocalPassword:function(){b.path("/change-local-password")}},g.$on("pageErrorReceived",function(a,b){d(function(){c.pageErrors?c.pageErrors.push(b):c.pageErrors=[b]})}),g.$on("$routeChangeSuccess",function(){c.pageErrors=[]})}}}]),angular.module("rainierApp").directive("pageLoadingIndicator",function(){return{templateUrl:"views/templates/page-loading-indicator.html",restrict:"E"}}),angular.module("rainierApp").directive("pageTitle",function(){return{templateUrl:"views/templates/page-title.html",restrict:"E",transclude:!0,replace:!0}}),angular.module("rainierApp").directive("parityGroupAdvLeftFilter",function(){return{scope:{model:"=ngModel",select:"&"},templateUrl:"views/templates/parity-group-adv-left-filter.html",restrict:"E"}}),angular.module("rainierApp").directive("parityGroupAdvRightFilter",function(){return{scope:{model:"=ngModel",select:"&"},templateUrl:"views/templates/parity-group-adv-right-filter.html",restrict:"E"}}),angular.module("rainierApp").directive("parityGroupAdvTiles",function(){return{scope:{model:"=ngModel",select:"&"},templateUrl:"views/templates/parity-group-adv-tiles.html",restrict:"E"}}),angular.module("rainierApp").directive("parityGroupBasicListTile",function(){return{scope:{model:"=ngModel",select:"&"},templateUrl:"views/templates/parity-group-basic-list-tile.html",restrict:"E"}}),angular.module("rainierApp").directive("parityGroupBasicTile",function(){return{scope:{model:"=ngModel",select:"&"},templateUrl:"views/templates/parity-group-basic-tile.html",restrict:"E"}}),angular.module("rainierApp").directive("parityGroupListItem",function(){return{scope:{model:"=ngModel",data:"=data",select:"&"},templateUrl:"views/templates/parity-group-list-item.html",restrict:"E",link:function(a){a.model||(a.model={usage:"0%"})}}}),angular.module("rainierApp").directive("parityGroupTile",function(){return{scope:{model:"=ngModel",data:"=data",select:"&"},templateUrl:"views/templates/parity-group-tile.html",restrict:"E",link:function(a){a.model||(a.model={usage:"0%"})}}}),angular.module("rainierApp").directive("poolCapacityDataVisualization",["d3service",function(a){var b=50,c=3,d={buildLayout:function(a,d,e){var f=["#868686","#fcb663","#E3E4E7","#fbaf17"],g=250,h=g-b,i=2*(g+c),j=i/2,k=d.attr("version","1.1").attr("viewBox","0 0 "+i+" "+i).attr("class","polar-data-viz-concentric").attr("transform","scale(1)").attr("preserveAspectRatio","xMidYMid meet").append("g").attr("transform","translate("+j+", "+j+")");k.append("circle").attr("r",h-c);var l=k.append("g").attr("class","inner-rev");l.append("text").attr("class","number").attr("text-anchor","middle").attr("dy",0).text(e.total.capacity.size),l.append("text").attr("class","unit").attr("text-anchor","middle").attr("dy",70).text(e.total.capacity.unit);var m=a.svg.arc().innerRadius(h).outerRadius(g),n=a.layout.pie().value(function(a){return a.free.capacity.value});k.selectAll(".arc").data(n(e.items)).enter().append("g").attr("class","arc").append("path").attr("d",m).attr("fill",function(a){var b=_.indexOf(e.keys,a.data.key),c=f[b];return c}).append("title").text(function(a){return a.data.key+" "+a.data.free.capacity.size+" "+a.data.free.capacity.unit})}};return{scope:{data:"=ngModel"},restrict:"E",link:function(b,c){a.d3().then(function(a){var e=a.select(c[0]).append("svg");b.$watch(function(){return b.data},function(){b.render(b.data)}),b.render=function(b){e.selectAll("*").remove(),b&&d.buildLayout(a,e,b)}})}}}]),angular.module("rainierApp").directive("poolDataViz",function(){return{scope:{model:"=ngModel",data:"=",select:"&"},templateUrl:"views/templates/pool-data-viz.html",restrict:"E"}}),angular.module("rainierApp").directive("poolParityGroupList",function(){return{scope:{model:"=ngModel",data:"=data",select:"&"},templateUrl:"views/templates/pool-parity-group-list.html",restrict:"E"}}),angular.module("rainierApp").directive("poolParityGroupSearch",function(){return{scope:{model:"=ngModel",data:"=data",select:"&"},templateUrl:"views/templates/pool-parity-group-search.html",restrict:"E"}}),angular.module("rainierApp").directive("poolThresholds",function(){return{scope:{model:"=ngModel",select:"&"},templateUrl:"views/templates/pool-thresholds.html",restrict:"E"}}),angular.module("rainierApp").directive("poolTierList",function(){return{scope:{model:"=ngModel",select:"&"},templateUrl:"views/templates/pool-tier-list.html",restrict:"E"}}),angular.module("rainierApp").directive("poolsIconTile",function(){return{scope:{itemCount:"=ngModel"},templateUrl:"views/templates/pools-icon-tile.html",restrict:"E",replace:!0}}),angular.module("rainierApp").directive("rainierBrandLogo",function(){return{templateUrl:"views/templates/rainier-brand-logo.html",restrict:"E",replace:!0}}),angular.module("rainierApp").directive("select",["$timeout",function(a){return{priority:99,link:function(b,c,d){function e(){b.$applyAsync(function(){c.selectpicker("refresh")})}a(function(){c.selectpicker({size:"5"}),c.selectpicker("refresh")}),d.ngModel&&b.$watch(d.ngModel,e,!0),d.additionalWatch&&b.$watch(d.additionalWatch,e,!0),d.ngDisabled&&b.$watch(d.ngDisabled,e,!0),b.$on("$destroy",function(){a(function(){c.selectpicker("destroy")})})}}}]),angular.module("rainierApp").directive("singleStepWizardBody",function(){return{scope:{dataModel:"=ngModel",leftPanelTemplate:"@",rightPanelTemplate:"@",pageTitle:"@ngTitle",data:"="},templateUrl:"views/templates/single-step-wizard-body.html",restrict:"E",replace:!0}}),angular.module("rainierApp").directive("snmpManagerListItem",function(){return{scope:{model:"=ngModel",data:"=data",select:"&"},templateUrl:"views/templates/snmp-manager-list-item.html",restrict:"E"}}),angular.module("rainierApp").directive("sortColumnHeader",function(){return{scope:{sortModel:"=ngModel",field:"@",label:"@"},templateUrl:"views/templates/sort-column-header.html",restrict:"E",replace:!0}}),angular.module("rainierApp").directive("steppedSlider",["$timeout",function(a){return{scope:{model:"=ngModel",steps:"="},restrict:"A",link:function(b,c){b.onSlide=function(c,d){a(function(){0===d.value?b.model=null:b.model=b.steps[d.value-1]})},$(c).slider({min:0,max:_.size(b.steps),value:0,slide:b.onSlide})}}}]),angular.module("rainierApp").directive("storageArraysIconTile",function(){return{scope:{itemCount:"=ngModel"},templateUrl:"views/templates/storage-arrays-icon-tile.html",restrict:"E",replace:!0}}),angular.module("rainierApp").directive("storageSystemVolumeDataVisualization",function(){return{scope:!1,templateUrl:"views/templates/storage-system-volume-data-visualization.html",restrict:"E",link:function(){$("text.value, text.header").on("mouseover",function(a){var b=this.innerHTML;$(".tooltip-inner").show();var c=$("#svg-tooltip-block");c.css("position","absolute"),c.css("left",a.pageX),c.css("top",a.pageY),c.css("z-index",1e4),c.show();var d=$("#svg-tooltip-text");d.text(b)}),$("text.value, text.header").on("mouseleave",function(){var a=$("#svg-tooltip-block");a.hide(),$(".tooltip-inner").hide()})}}}),angular.module("rainierApp").directive("storageSystemVolumeListItem",function(){return{scope:{model:"=ngModel",data:"=data"},templateUrl:"views/templates/storage-system-volume-list-item.html",restrict:"E",controller:["$scope","monitoringService",function(a,b){a.launchDpMonitoringFromVolumeTile=function(){b.launchDpMonitoringFromVolumeTile()}}]}}),angular.module("rainierApp").directive("summaryAlertPanel",function(){return{scope:!1,templateUrl:"views/templates/summary-alert-panel.html",restrict:"E",controller:["$scope","monitoringService",function(a,b){function c(a){a.state=a.state===g?h:g,a.title=a.title===e?f:e,a.arrow=a.arrow===i?j:i}function d(){a.toggleAction(b.getCurrentCategory())}var e="Expand",f="Collapse",g="collapsed",h="expanded",i="icon-right-arrow",j="icon-left-arrow";a.CAPACITY_ID="capacity",a.DP_ID="dp",a.HARDWARE_ID="hardware",a.capacityPanelState={state:g,title:e,arrow:i},a.dpPanelState={state:g,title:e,arrow:i},a.hardwarePanelState={state:g,title:e,arrow:i},a.capacityComponents=b.getCapacityComponents(),a.components=b.getHardwareComponents(),a.launchMonitoringPage=function(a){b.launchDpMonitoring(a)},a.toggleAction=function(b){switch(b){case a.CAPACITY_ID:c(a.capacityPanelState),a.dpPanelState.state===h&&c(a.dpPanelState),a.hardwarePanelState.state===h&&c(a.hardwarePanelState);break;case a.DP_ID:c(a.dpPanelState),a.capacityPanelState.state===h&&c(a.capacityPanelState),a.hardwarePanelState.state===h&&c(a.hardwarePanelState);break;case a.HARDWARE_ID:c(a.hardwarePanelState),a.dpPanelState.state===h&&c(a.dpPanelState),a.capacityPanelState.state===h&&c(a.capacityPanelState)}},d()}]}}),angular.module("rainierApp").directive("templatesIconTile",function(){return{scope:{itemCount:"=ngModel"},templateUrl:"views/templates/templates-icon-tile.html",restrict:"E",replace:!0}}),angular.module("rainierApp").directive("tileViewAdd",function(){return{templateUrl:"views/templates/tile-view-add.html",restrict:"E"}}),angular.module("rainierApp").directive("twoKnobSlider",["$timeout",function(a){return{scope:{modelMin:"=ngModelMin",modelMax:"=ngModelMax",min:"=sliderMin",max:"=sliderMax",stopEventFn:"&"},restrict:"A",link:function(b,c){b.onSlide=function(c,d){a(function(){b.modelMin=d.values[0],b.modelMax=d.values[1]})},a(function(){$(c).slider({range:!0,min:b.min,max:b.max,values:[b.min,b.max],slide:b.onSlide,stop:function(){b.stopEventFn&&_.isFunction(b.stopEventFn)&&b.stopEventFn()}})})}}}]),angular.module("rainierApp").directive("usageIndicatorBar",function(){return{scope:{model:"=ngModel"},templateUrl:"views/templates/usage-indicator-bar.html",restrict:"E",replace:!1,link:function(a){if(a.tooltip||(a.tooltip={title:a.model.usage+" used"}),a.model&&a.model.usage){var b=parseInt(a.model.usage.toString().replace("%","")),c="normal";(a.model.compression||"YES"===a.model.compressed)&&(c="compressed-normal"),a.model.file&&(c="file"),b>80?(c="full",(a.model.compression||"YES"===a.model.compressed)&&(c="compressed-full")):b>=70&&(c="medium",(a.model.compression||"YES"===a.model.compressed)&&(c="compressed-medium")),a.model.usageClass=c}}}}),angular.module("rainierApp").directive("volumeActions",function(){return{scope:!1,templateUrl:"views/templates/volume-actions.html",restrict:"E"}}),angular.module("rainierApp").directive("volumeSearch",function(){var a=function(a,b){var c=[];a.snapshot&&c.push("SNAPSHOT"),a.cloneNow&&c.push("CLONE"),b.filter.replicationTypes=c},b=function(a,b){var c=[];a["protected"]&&c.push("P-VOL"),a.unprotected&&c.push("UNPROTECTED"),a.secondary&&c.push("S-VOL"),b.filter.protectionStatusList=c};return{scope:{model:"=ngModel",filterModel:"=",data:"=data",select:"&"},templateUrl:"views/templates/volume-search.html",restrict:"E",link:function(c){c.filterDpType=a,c.filterProtectionStatus=b}}}),angular.module("rainierApp").directive("welcomeUser",["authService",function(a){return{restrict:"E",replace:!0,link:function(){a.getUser()}}}]),angular.module("rainierApp").directive("wizardAdvancedStepperButton",function(){return{scope:{stepCompleted:"=",stepActive:"=",title:"=ngTitle"},templateUrl:"views/templates/wizard-advanced-stepper-button.html",restrict:"E",replace:!0,link:function(a){a.stepDisabled=!(a.stepCompleted||a.stepActive)}}}),angular.module("rainierApp").directive("wizardAdvancedStepper",function(){return{templateUrl:"views/templates/wizard-advanced-stepper.html",restrict:"E",transclude:!0}}),angular.module("rainierApp").directive("wizardBody",function(){return{templateUrl:"views/templates/wizard-body.html",restrict:"E",transclude:!0,replace:!0}}),angular.module("rainierApp").directive("wizardFooterLeftButtonGroup",function(){return{templateUrl:"views/templates/wizard-footer-left-button-group.html",restrict:"E",transclude:!0}}),angular.module("rainierApp").directive("wizardFooterRightButtonGroup",function(){return{templateUrl:"views/templates/wizard-footer-right-button-group.html",restrict:"E",transclude:!0}}),angular.module("rainierApp").directive("wizardFooter",function(){return{scope:{dataModel:"=ngModel",leftButtonTemplate:"@",rightButtonTemplate:"@"},templateUrl:"views/templates/wizard-footer.html",restrict:"E"}}),angular.module("rainierApp").directive("wizardHeader",function(){return{scope:{title:"=ngTitle",iconClass:"@"},templateUrl:"views/templates/wizard-header.html",replace:!0}}),angular.module("rainierApp").directive("wizardLeftRightContent",function(){return{scope:{dataModel:"=ngModel",leftPanelTemplate:"@",rightPanelTemplate:"@",pageTitle:"=ngTitle"},replace:!0,templateUrl:"views/templates/wizard-left-right-content.html"}}),angular.module("rainierApp").directive("wizardPage",function(){return{templateUrl:"views/templates/wizard-page.html",restrict:"E",transclude:!0}}),angular.module("rainierApp").directive("wizardSinglePanelContent",function(){return{scope:{dataModel:"=ngModel",filterModel:"=",panelTemplate:"@"},templateUrl:"views/templates/wizard-single-panel-content.html"}}),angular.module("rainierApp").filter("alertSearch",function(){return function(a,b){if(!b)return a;var c=_.filter(a,function(a){var c=_.isEmpty(b.freeText)||a.storageSerialNumber.toString().indexOf(b.freeText)>-1;return b.filterStorageSystem&&b.filterAlertLevel?c=c&&a.storageSerialNumber===b.filterStorageSystem&&a.alertLevel===b.filterAlertLevel.toLowerCase():b.filterStorageSystem?c=c&&a.storageSerialNumber===b.filterStorageSystem:b.filterAlertLevel&&(c=c&&a.alertLevel===b.filterAlertLevel.toLowerCase()),c});return c}}),angular.module("rainierApp").filter("createPoolParityGroupsFilter",["$filter",function(a){return function(b,c){if(!c)return b;var d=a("filter")(b,{parityGroupId:c.freeText},!1),e=a("filter")(b,{selected:!0},!1);b=_.union(d,e);var f=c.diskSpec.speed;"0"===c.diskSpec.speed&&(f="");var g=_.filter(b,function(a){var b=(_.isEmpty(c.diskSpec.type)||c.diskSpec.type===a.diskSpec.type)&&(_.isEmpty(c.diskSpec.speed)||f===a.diskSpec.speed)&&(_.isEmpty(c.raidLayout)||c.raidLayout===a.raidLayout)&&(_.isEmpty(c.raidLevel)||c.raidLevel===a.raidLevel);return b=a.selected||b});return g}}]),angular.module("rainierApp").filter("evsSearch",function(){return function(a,b){if(!b)return a;var c=_.filter(a,function(a){var c=_.isEmpty(b.freeText)||a.uuid.toString().indexOf(b.freeText)>-1||a.name.toLocaleLowerCase().indexOf(b.freeText.toLocaleLowerCase())>-1;return c=c&&(null===b.isOnline||a.isOnline===b.isOnline),c=c&&(null===b.isEnabled||a.enabled===b.isEnabled),c=c&&(null===b.blade||a.clusterNodeId===parseInt(b.blade)),c=c&&(!b.filterStorageSystem||a.storageSystemId===b.filterStorageSystem),c=a.selected||c});return c}}),angular.module("rainierApp").filter("externalParityGroupsSearch",["$filter","diskSizeService",function(a,b){return function(c,d){if(!d)return c;var e=a("filter")(c,{externalParityGroupId:d.freeText},!1),f=a("filter")(c,{selected:!0},!1);c=_.union(e,f);var g=b.createDisplaySize(d.totalCapacity.min,d.totalCapacity.unit),h=b.createDisplaySize(d.totalCapacity.max,d.totalCapacity.unit);return _.filter(c,function(a){var b=a.total.value>=g.value&&a.total.value<=h.value;return b=a.selected||b})}}]),angular.module("rainierApp").filter("fabricSwitchSearch",["$filter",function(a){return function(b,c){if(!c)return b;var d=a("filter")(b,{sanFabricId:c.freeText},!1),e=a("filter")(b,{selected:!0},!1);b=_.union(d,e);var f=c.switchType;return _.filter(b,function(a){var b=a.switchType===f||!f;return b=a.selected||b})}}]),angular.module("rainierApp").filter("failureVolumesSearch",["$filter",function(a){return function(b,c){if(!c)return b;var d=a("filter")(b,{$:c.freeText},!1),e=a("filter")(b,{selected:!0},!1);b=_.union(d,e);var f=_.filter(b,function(a){var b=!0,d=function(a){return _.isArray(a)&&_.size(a)>0};return d(c.replicationTypes)&&(b=b&&_.size(_.intersection(a.dataProtectionSummary.replicationType,c.replicationTypes))>0),b=a.selected||b});return f}}]),angular.module("rainierApp").filter("filePoolSearch",["$filter","diskSizeService",function(a,b){return function(a,c){if(!c)return a;var d=b.createDisplaySize(c.freeCapacity.min,c.freeCapacity.unit),e=b.createDisplaySize(c.freeCapacity.max,c.freeCapacity.unit),f=b.createDisplaySize(c.totalCapacity.min,c.totalCapacity.unit),g=b.createDisplaySize(c.totalCapacity.max,c.totalCapacity.unit),h=_.filter(a,function(a){var b=_.isEmpty(c.freeText)||a.id.toString().indexOf(c.freeText)>-1||a.label.toLocaleLowerCase().indexOf(c.freeText.toLocaleLowerCase())>-1;return b=b&&a.availableCapacityInBytes.value>=d.value&&a.availableCapacityInBytes.value<=e.value&&a.capacityInBytes.value>=f.value&&a.capacityInBytes.value<=g.value,b=b&&(null===c.healthy||a.healthy===c.healthy),b=a.selected||b});return h}}]),angular.module("rainierApp").filter("fileSystemSearch",function(){return function(a,b){if(!b)return a;var c=_.filter(a,function(a){var c=_.isEmpty(b.freeText)||a.id.toString().indexOf(b.freeText)>-1||a.label.toLocaleLowerCase().indexOf(b.freeText.toLocaleLowerCase())>-1;return c=c&&(null===b.type||a.type===b.type),c=a.selected||c});return c}}),angular.module("rainierApp").filter("fileSystemsSearch",["$filter","diskSizeService",function(a,b){return function(a,c){if(!c)return a;var d=b.createDisplaySize(c.freeCapacity.min,c.freeCapacity.unit),e=b.createDisplaySize(c.freeCapacity.max,c.freeCapacity.unit),f=b.createDisplaySize(c.totalCapacity.min,c.totalCapacity.unit),g=b.createDisplaySize(c.totalCapacity.max,c.totalCapacity.unit),h=_.filter(a,function(a){var b=_.isEmpty(c.freeText)||a.id.toString().indexOf(c.freeText)>-1||a.label.toLocaleLowerCase().indexOf(c.freeText.toLocaleLowerCase())>-1;return b=b&&a.availableCapacityInBytes.value>=d.value&&a.availableCapacityInBytes.value<=e.value&&a.capacityInBytes.value>=f.value&&a.capacityInBytes.value<=g.value,b=b&&(null===c.fileServer||a.evsId===c.fileServer.id),b=a.selected||b});return h}}]),angular.module("rainierApp").filter("hostSearch",["$filter",function(a){function b(a,b){if(null===a||void 0===a||0===a.length)return!0;for(var c=b.osType===a[0],d=1;d<a.length;++d)c=c||b.osType===a[d];return c}return function(c,d){if(!d)return c;var e=a("filter")(c,{$:d.freeText},!1),f=a("filter")(c,{selected:!0},!1);c=_.union(e,f);var g=_.filter(c,function(a){var c=!(d.status&&a.status!==d.status);c=c&&b(d.osType,a);var e=function(a){return _.isArray(a)&&_.size(a)>0};return e(d.replicationTypes)&&(c=c&&_.isArray(a.dpType)&&_.size(_.intersection(a.dpType,d.replicationTypes))>0),c=a.selected||c});return g}}]),angular.module("rainierApp").filter("jobsSearch",["$filter",function(a){var b=function(a,b,c){if(a&&_.isDate(b)&&_.isDate(c)){var d=b.getFullYear(),e=b.getMonth(),f=b.getDate(),g=c.getHours(),h=c.getMinutes(),i=new Date(d,e,f,g,h);return i.getTime()}return null},c=function(a){if(a){var b=new Date(a);return b.setSeconds(0),b.setMilliseconds(0),b.getTime()}return null};return function(d,e){if(!e)return d;if(d=a("filter")(d,{title:{text:e.freeText}},!1),e.filterStatus&&(d=_.filter(d,function(a){var b=a.status===e.status||!e.status;return b})),e.filterStartTime){var f=b(e.filterStartTime,e.startDateStart,e.startTimeStart),g=b(e.filterStartTime,e.startDateEnd,e.startTimeEnd);d=_.filter(d,function(a){
var b=c(a.startDate),d=f&&b>=f,h=g&&g>=b,i=e.filterStartTime&&d&&h;return i})}if(e.filterEndTime){var h=b(e.filterEndTime,e.endDateStart,e.endTimeStart),i=b(e.filterEndTime,e.endDateEnd,e.endTimeEnd);d=_.filter(d,function(a){var b=c(a.endDate),d=h&&b&&b>=h,f=i&&b&&i>=b,g=e.filterEndTime&&d&&f;return g})}return d}}]),angular.module("rainierApp").filter("parityGroupsDisksSearch",["$filter","diskSizeService",function(a,b){return function(a,c){if(!c)return a;var d=b.createDisplaySize(c.totalCapacity.min,c.totalCapacity.unit),e=b.createDisplaySize(c.totalCapacity.max,c.totalCapacity.unit),f=_.filter(a,function(a){var b=a.capacityInBytes>=d.value&&a.capacityInBytes<=e.value&&(_.isEmpty(c.type)||c.type===a.type)&&(_.isEmpty(c.speed)||c.speed===a.speed.toString())&&(_.isEmpty(c.purpose)||c.purpose===a.purpose)&&(_.isEmpty(c.freeText)||a.diskId.indexOf(c.freeText)>-1);return b=a.selected||b});return f}}]),angular.module("rainierApp").filter("parityGroupsSearch",["$filter","diskSizeService",function(a,b){return function(c,d){if(!d)return c;var e=a("filter")(c,{parityGroupId:d.freeText},!1),f=a("filter")(c,{selected:!0},!1);c=_.union(e,f);var g=b.createDisplaySize(d.totalCapacity.min,d.totalCapacity.unit),h=b.createDisplaySize(d.totalCapacity.max,d.totalCapacity.unit);return _.filter(c,function(a){var c,e=a.diskSpec.type,f=a.diskSpec.speed,i=b.getDisplaySize(a.diskSpec.capacityInBytes);c="0k"!==f?e+" "+f+" "+i.size+i.unit:e+" "+i.size+i.unit,a.disk=c;var j=a.raidLevel+" "+a.raidLayout;a.raid=j;var k=!(!(a.totalCapacityInBytes>=g.value&&a.totalCapacityInBytes<=h.value)||a.disk!==d.disk&&d.disk||a.raid!==d.raid&&d.raid||a.status!==d.status&&d.status);return k=a.selected||k})}}]),angular.module("rainierApp").filter("permissionsSearch",function(){return function(a,b){if(!b)return a;var c=_.filter(a,function(a){var c=_.isEmpty(b.freeText)||a.id.toString().indexOf(b.freeText)>-1||a.label.toLocaleLowerCase().indexOf(b.freeText.toLocaleLowerCase())>-1;return c=c&&(null===b.permission||b.permission===_.first(a.metaData).detailsNoSlash[1]),c=a.selected||c});return c}}),angular.module("rainierApp").filter("replicationGroupsSearch",function(){return function(a,b){return b?_.filter(a,function(a){var c=(_.isEmpty(b.freeText)||a.name.toString().toLocaleLowerCase()===b.freeText.toString().toLocaleLowerCase())&&(!b.type||a.type.toString().toLocaleLowerCase()===b.type.toString().toLocaleLowerCase());return c=a.selected||c}):a}}),angular.module("rainierApp").filter("sharesExportsSearch",function(){return function(a,b){if(!b)return a;var c=_.filter(a,function(a){var c=_.isEmpty(b.freeText)||a.id.toString().indexOf(b.freeText)>-1||a.name.toLocaleLowerCase().indexOf(b.freeText.toLocaleLowerCase())>-1;return c=c&&(null===b.type||a.type===b.type),c=c&&(!b.evsId||a.evsId===b.filterEvs),c=a.selected||c});return c}}),angular.module("rainierApp").filter("snmpManagerSearch",function(){return function(a,b){if(!b)return a;var c=_.filter(a,function(a){var c=(!b.authProtocol||a.authProtocol===b.authProtocol)&&(!b.privacyProtocol||a.privacyProtocol===b.privacyProtocol)&&(_.isEmpty(b.freeText)||a.name.indexOf(b.freeText)>-1);return c=a.selected||c});return c}}),angular.module("rainierApp").filter("storagePoolSearch",["$filter","diskSizeService",function(a,b){return function(a,c){if(!c)return a;var d=b.createDisplaySize(c.freeCapacity.min,c.freeCapacity.unit),e=b.createDisplaySize(c.freeCapacity.max,c.freeCapacity.unit),f=b.createDisplaySize(c.totalCapacity.min,c.totalCapacity.unit),g=b.createDisplaySize(c.totalCapacity.max,c.totalCapacity.unit),h=_.filter(a,function(a){var b=_.isEmpty(c.freeText)||a.storagePoolId.toString().indexOf(c.freeText)>-1||a.label.toLocaleLowerCase().indexOf(c.freeText.toLocaleLowerCase())>-1;return b=b&&a.availableCapacityInBytes.value>=d.value&&a.availableCapacityInBytes.value<=e.value&&a.capacityInBytes.value>=f.value&&a.capacityInBytes.value<=g.value&&(a.type===c.poolType||!c.poolType)&&(a.activeFlashEnabled===c.activeFlashEnabled||!c.activeFlashEnabled),b=b&&(!c.poolTier||_.some(a.tiers,function(a){return!c.poolTier||a.tier===c.poolTier})),b=a.selected||b});return h}}]),angular.module("rainierApp").filter("storagePortSearch",function(){return function(a,b){if(!b)return a;var c=_.filter(a,function(a){var c=(!b.portSpeed||a.speed===b.portSpeed)&&(null===b.securitySwitchEnabled||void 0===b.securitySwitchEnabled||a.securitySwitchEnabled===b.securitySwitchEnabled)&&(_.isEmpty(b.freeText)||a.storagePortId.toString().indexOf(b.freeText)>-1)&&($.inArray(b.portAttribute,a.attributes)>-1||!b.portAttribute);return c=a.selected||c});return c}}),angular.module("rainierApp").filter("storageSystemSearch",["$filter","diskSizeService",function(a,b){return function(a,c){if(!c)return a;var d=b.createDisplaySize(c.freeCapacity.min,c.freeCapacity.unit),e=b.createDisplaySize(c.freeCapacity.max,c.freeCapacity.unit),f=b.createDisplaySize(c.totalCapacity.min,c.totalCapacity.unit),g=b.createDisplaySize(c.totalCapacity.max,c.totalCapacity.unit),h=_.filter(a,function(a){var b=a.physicalFree.value>=d.value&&a.physicalFree.value<=e.value&&a.total.value>=f.value&&a.total.value<=g.value&&a.storageSystemId.toString().indexOf(c.freeText)>-1;return b=a.selected||b});return h}}]),angular.module("rainierApp").filter("storageSystemVolumesSearch",["$filter","diskSizeService",function(a,b){return function(a,c){if(!c)return a;var d=b.createDisplaySize(c.freeCapacity.min,c.freeCapacity.unit),e=b.createDisplaySize(c.freeCapacity.max,c.freeCapacity.unit),f=b.createDisplaySize(c.totalCapacity.min,c.totalCapacity.unit),g=b.createDisplaySize(c.totalCapacity.max,c.totalCapacity.unit),h=_.filter(a,function(a){var b=_.isEmpty(c.freeText)||a.volumeId.toString().indexOf(c.freeText)>-1||a.label.toLocaleLowerCase().indexOf(c.freeText.toLocaleLowerCase())>-1;b=b&&!(c.type&&a.type!==c.type)&&a.availableCapacity.value>=d.value&&a.availableCapacity.value<=e.value&&a.totalCapacity.value>=f.value&&a.totalCapacity.value<=g.value&&a.usePercentage>=c.utilization.min&&a.usePercentage<=c.utilization.max;var h=function(a){return _.isArray(a)&&_.size(a)>0};return h(c.replicationTypes)&&(b=b&&_.size(_.intersection(a.dataProtectionSummary.replicationType,c.replicationTypes))>0),h(c.protectionStatusList)&&(b=b&&_.size(_.intersection(a.dataProtectionSummary.volumeType,c.protectionStatusList))>0),b=a.selected||b});return h}}]),angular.module("rainierApp").factory("apiResponseHandlerService",["$q","$modal","$rootScope","$timeout","synchronousTranslateService",function(a,b,c,d,e){var f=this,g=function(b){var f=a.defer();return b.then(function(a){f.resolve(a)},function(a){d(function(){var b=a.data;b&&b.message||(b={message:function(a){return e.translate(a)}("common-api-get-message")}),b.received=new Date,c.$broadcast("pageErrorReceived",b)},1e3),f.reject(a)}),f.promise},h=function(e){var g=a.defer();return e.then(function(a){d(function(){c.$broadcast("jobCreated",a)},1e3),g.resolve(a)},function(a){if(f.errorDialogOpend)return console.log(a),void g.reject(a);var c=b.open({templateUrl:"views/templates/error-modal.html",windowClass:"modal fade confirmation",backdrop:!0,backdropClass:"modal-backdrop",controller:["$scope",function(b){b.error=a.data,b.cancel=function(){c.dismiss("cancel"),f.errorDialogOpend=!1,g.reject()}}]});f.errorDialogOpend=!0}),g.promise};return{_apiGetResponseHandler:g,_apiResponseHandler:h}}]),angular.module("rainierApp").factory("breadcrumbService",["$rootScope","$location","$route",function(a,b,c){function d(a,b){this.label=b,this.path=a,this.peers=[]}d.prototype.addPeer=function(a,b){this.peers.push({label:b,path:a})},d.prototype.isDropdown=function(){return this.peers.length>0};var e={breadcrumbs:[],paramLabel:"",pathForParamLabel:"",get:function(){return this.breadcrumbs},setParamLabel:function(a){this.paramLabel=a,this.pathForParamLabel=b.path(),this.generate()},generate:function(){var a=c.routes,e=b.path().split("/"),f="",g=this,h=function(a){if(c.current){var b;return angular.forEach(c.current.params,function(c,d){-1!==a.indexOf(c)&&(b=c,-1!==a.indexOf("export")?b="Export "+b:-1!==a.indexOf("share")&&(b="Share "+b)),b&&(a=a.replace(c,":"+d))}),{path:a,param:b}}};""===e[1]&&delete e[1],this.breadcrumbs=[],angular.forEach(e,function(b){var c=f+("/"===f?b:"/"+b),e=h(c);if(e&&a[e.path]){var i,j=a[e.path].breadcrumbOptions;j&&j.labelKey?(i=new d(c,j.labelKey),j.peers&&angular.forEach(j.peers,function(b){var c=f+("/"===f?b:"/"+b),d=h(c);if(d&&a[d.path]){var e=a[d.path].breadcrumbOptions;e&&e.labelKey&&i.addPeer(c,e.labelKey)}})):i=""!==g.paramLabel&&g.pathForParamLabel===c?new d(c,g.paramLabel):new d(c,e.param),g.breadcrumbs.push(i)}f=c})}};return a.$on("$routeChangeSuccess",function(){var a=b.path();a!==e.pathForParamLabel&&e.setParamLabel(""),e.generate()}),e.generate(),e}]),angular.module("rainierApp").factory("cronStringConverterService",function(){function a(a){switch(a%100){case 11:case 12:case 13:return a+"th"}switch(a%10){case 1:return a+"st";case 2:return a+"nd";case 3:return a+"rd";default:return a+"th"}}function b(a){return 10>a&&(a="0"+a),a}function c(a,c){var d="AM";return a>=12&&(a-=12,d="PM"),0===a&&(a=12),a+":"+b(c)+" "+d}function d(a){return void 0!==a&&null!==a}return{fromDatePickerToObjectModel:function(a,b,c,d,e,f){var g={};"HOURLY"===a||"hour"===a||"Hourly"===a?(g.hour=null,g.minute=parseInt(f)):b?(g.hour=parseInt(b.getHours()),g.minute=parseInt(b.getMinutes())):(g.hour=null,g.minute=null),a===a.toLowerCase()?"day"===a?g.recurringUnit="DAILY":g.recurringUnit=a.toUpperCase()+"LY":g.recurringUnit=a.toUpperCase(),g.recurringUnitInterval=null,g.dayOfWeek=null,g.dayOfMonth=null;var h=function(a){var b;switch(a){case"Sunday":b="SUN";break;case"Monday":b="MON";break;case"Tuesday":b="TUE";break;case"Wednesday":b="WED";break;case"Thursday":b="THU";break;case"Friday":b="FRI";break;case"Saturday":b="SAT"}return b};switch(a){case"HOURLY":case"hour":case"Hourly":g.recurringUnitInterval=parseInt(e);break;case"DAILY":case"day":case"Daily":break;case"WEEKLY":if(g.dayOfWeek=[],"string"==typeof d){d=d.replace(/\s+/g,"");var i=d.split(",");_.forEach(i,function(a){g.dayOfWeek.push(h(a))})}else if("object"==typeof d)for(var j in d)d.hasOwnProperty(j)&&d[j]===!0&&g.dayOfWeek.push(j.toString().toUpperCase());break;case"week":g.dayOfWeek=[],_.forEach(d,function(a){g.dayOfWeek.push(h(a))});break;case"MONTHLY":case"month":case"Monthly":g.dayOfMonth=c}return g},isEqualForObjectModel:function(a,b){if(a.recurringUnit!==b.recurringUnit)return!1;var c=!0;switch(a.recurringUnit){case"HOURLY":c=parseInt(a.minute)===parseInt(b.minute)&&parseInt(a.recurringUnitInterval)===parseInt(b.recurringUnitInterval);break;case"DAILY":c=parseInt(a.minute)===parseInt(b.minute)&&parseInt(a.hour)===parseInt(b.hour);break;case"WEEKLY":c=parseInt(a.minute)===parseInt(b.minute)&&parseInt(a.hour)===parseInt(b.hour)&&_.isEqual(_.sortBy(a.dayOfWeek),_.sortBy(b.dayOfWeek));break;case"MONTHLY":c=parseInt(a.minute)===parseInt(b.minute)&&parseInt(a.hour)===parseInt(b.hour)&&parseInt(a.dayOfMonth)===parseInt(b.dayOfMonth)}return c},fromObjectModelToDatePicker:function(a){if(!a||_.isEmpty(a)||!a.recurringUnit)return null;var b={};switch(b.type=a.recurringUnit,"HOURLY"!==a.recurringUnit?(b.hourInterval=null,b.hourStartMinute=null,b.time=new Date,b.time.setHours(a.hour,a.minute)):(b.hourInterval=a.recurringUnitInterval,b.hourStartMinute=a.minute,b.time=null),a.recurringUnit){case"HOURLY":b.days=null,b.date=null;break;case"DAILY":b.days=null,b.date=null;break;case"WEEKLY":b.days={Mon:!1,Tue:!1,Wed:!1,Thu:!1,Fri:!1,Sat:!1,Sun:!1};var c=function(a){return a.substr(0,1).toUpperCase()+a.slice(1).toLowerCase()};_.forEach(a.dayOfWeek,function(a){b.days[c(a)]=!0}),b.date=null;break;case"MONTHLY":b.days=null,b.date=a.dayOfMonth;break;default:b={}}return b},fromObjectModelToNaturalLanguage:function(b){if(!b||_.isEmpty(b)||!b.recurringUnit)return"N/A";var e="";switch(b.recurringUnit){case"HOURLY":e=d(b.minute)&&d(b.recurringUnitInterval)?0===b.minute?"Every "+b.recurringUnitInterval+(1===b.recurringUnitInterval?" hour on the hour":"hours on the hour"):"At "+b.minute+(1===b.minute?" minute past the hour every ":" minutes past the hour every ")+b.recurringUnitInterval+(1===b.recurringUnitInterval?" hour":" hours"):"N/A";break;case"DAILY":e=d(b.hour)&&d(b.minute)?"At "+c(b.hour,b.minute)+" every day":"N/A";break;case"WEEKLY":e=d(b.hour)&&d(b.minute)&&d(b.dayOfWeek)?"At "+c(b.hour,b.minute)+" every week on "+b.dayOfWeek.join(", "):"N/A";break;case"MONTHLY":e=d(b.hour)&&d(b.minute)&&d(b.dayOfMonth)?"At "+c(b.hour,b.minute)+" every month on "+a(b.dayOfMonth)+" day of the month":"N/A";break;default:e="N/A"}return e}}}),angular.module("rainierApp").factory("d3service",["$q","$window",function(a,b){var c=a.defer();return c.resolve(b.d3),{d3:function(){return c.promise}}}]),angular.module("rainierApp").factory("dataProtectionSettingsService",["ShareDataService","orchestratorService","$location","$q",function(a,b,c,d){var e=function(a){a.gridSettings=[{title:"replication-group-label-policy-name",sizeClass:"sixth",sortField:"name",getDisplayValue:function(a){return a.name}},{title:"replication-group-label-technology",sizeClass:"twelfth",sortField:"type",getDisplayValue:function(a){return a.type}},{title:"replication-group-label-consistency",sizeClass:"twelfth",sortField:"consistent",getDisplayValue:function(a){return a.consistent}},{title:"replication-group-label-backups",sizeClass:"twelfth",sortField:"numberOfCopies",getDisplayValue:function(a){return a.numberOfCopies}},{title:"replication-group-label-status",sizeClass:"twelfth",sortField:"scheduleEnabled",getDisplayValue:function(a){return a.status}},{title:"replication-group-label-schedule",sizeClass:"sixth",sortField:"schedule.recurringUnit",getDisplayValue:function(a){return a.naturalLanguageSchedule}},{title:"replication-group-label-comments",sizeClass:"sixth",sortField:"comments",getDisplayValue:function(a){return a.comments}}]},f=function(e,f){e.replicationGroupSuspendResumeDelete=function(b,d){a.replicationGroupAction=b,a.selectedReplicationGroup=d,c.path(["/storage-systems/",f,"/replication-groups/replication-group-actions-confirmation"].join(""))},e.replicationGroupRestore=function(){var a=[];_.forEach(e.dataModel.displayList,function(b){b.volumePairs&&_.forEach(b.volumePairs,function(b){b.selected&&a.push(b)})});var c=[];_.forEach(a,function(a){var d={secondaryVolumeId:a.secondaryVolume.id.toString()};c.push(b.restoreReplicationGroup(a.primaryVolume.storageSystemId,a.primaryVolume.id,d))}),d.all(c)},e.replicationGroupEdit=function(b){a.selectedReplicationGroup=b,c.path(["/storage-systems/",f,"/replication-groups/edit"].join(""))}},g=function(a){a.dataModel.restoreCheck=function(){var b=!0,c=!1,d=!0,e=[];if(a.dataModel.displayList){for(var f=0;f<a.dataModel.displayList.length;++f)if(a.dataModel.displayList[f].selected&&(c=!0,b=!1),a.dataModel.displayList[f].volumePairs)for(var g=0;g<a.dataModel.displayList[f].volumePairs.length;++g)if(a.dataModel.displayList[f].volumePairs[g].selected){if(d=!1,e.indexOf(a.dataModel.displayList[f].volumePairs[g].primaryVolume.id)>-1||"N/A"===a.dataModel.displayList[f].volumePairs[g].secondaryVolume.id){b=!1;break}e.push(a.dataModel.displayList[f].volumePairs[g].primaryVolume.id)}a.dataModel.noVolumePairSelected=!(c&&!d),a.dataModel.enableRestore=b&&!d}}};return{setReplicationGroupGridSettings:e,setReplicationGroupActions:f,setDataModelFunctions:g}}]),angular.module("rainierApp").factory("diskSizeService",function(){var a=["Bytes","KB","MB","GB","TB","PB"],b=0;return{getDisplaySize:function(b){if(b=parseInt(b),isNaN(b)||0===b)return{size:0,value:0,unit:"GB"};var c=parseInt(Math.floor(Math.log(b)/Math.log(1024))),d=(b/Math.pow(1024,c)).toFixed(2),e=a[c];return{value:b,size:d,unit:e}},createDisplaySize:function(b,c){var d=_.findIndex(a,function(a){return a===c}),e=b*Math.pow(1024,d);return this.getDisplaySize(e)},getDisplaySpeed:function(a){var c="k";return b=parseInt(a),b=isNaN(b)||0===b?"":b/1e3+c},getDisplaySpeedOnly:function(a){return b=parseInt(a),isNaN(b)||0===b?b="":b/=1e3,b},getDisplaySpeedUnitOnly:function(a){var c="k";return b=parseInt(a),(isNaN(b)||0===b)&&(c=""),c}}}),angular.module("rainierApp").factory("fileParserService",["$q","$window",function(a,b){return{parseCsv:function(c){var d=a.defer();return b.Papa.parse(c,{header:!0,worker:!1,complete:function(a){d.resolve(a.data)},error:function(a){d.reject(a)}}),d.promise}}}]),angular.module("rainierApp").factory("filePoolService",["rainerColorRange","tiersColorRange","diskSizeService",function(a,b,c){function d(a,b,c,d){var e=_.first(c.diskSizesByTier).name,f=b.checked;if(a.name===e){var g=_.first(c.diskSizesByTier);_.forEach(g.diskSizes,function(a){a.checked=!1}),f?(b.checked=!1,g.selectedSize="",c.selectedPlatinumCapacity=null):(c.selectedPlatinumCapacity=b,d.selectedSize=b.requestedCapacity,b.checked=!0)}else _.forEach(c.diskSizesByTier,function(a){a.name!==e&&(a.selectedSize=""),_.forEach(a.diskSizes,function(b){a.name!==e&&(b.checked=!1)})}),f?(b.checked=!1,c.selectedCapacity=null):(c.selectedCapacity=b,d.selectedSize=b.requestedCapacity,b.checked=!0)}function e(a){return Math.ceil(Math.log(a)/Math.log(2))}function f(a,b){return Math.ceil(a/b)}function g(a,b,c,d){for(var f,g=-1,h=-1,i=8796093022208;70368744177665>i;){if(a=e(b/i),4>a?a=4:a>32&&(a=32),h===a)return g;if(f=a*c,d>=f)return f;(-1===g||g>f)&&(h=a,g=f),i+=2199023255552}return g}function h(a,b){return a.indexOf("FMD")>-1?64:a.indexOf("SSD")>-1?16:"10000"===b||"15000"===b?8:4}function i(a){return a.indexOf("FMD")>-1?256:a.indexOf("SSD")>-1?256:32}function j(a,b){var c=[],e={},f=null;_.forEach(a.templateSubTiers,function(d){_.forEach(d.availableSizesInBytes,function(f){if(!e[f]){var g={};g.capacity=b.getDisplaySize(d.capacity),g.diskType=d.diskType,g.raidLevel=d.raidLevel,g.raidLayout=d.raidLayout,g.speed=d.speed,g.requestedCapacity=b.getDisplaySize(f),g.name=a.name,g.checked=!1,e[f]=!0,c.push(g)}})});var g=_.max(c,function(a){return a.requestedCapacity.value});f&&(g=b.getDisplaySize(g.value-f.capacity));var h={name:a.name,disabled:!1,expanded:!1,currentCapacity:f?f.capacity:null,selectedSize:f?_.last(c):null,diskSizes:c,maxAvailableSize:g.requestedCapacity,onOptionSelected:function(b,c,e){d(a,b,c,e)},toggleExpanded:function(a,b){var c=angular.element(b.target);a.expanded=!a.expanded,a.expanded?c.parent().parent().addClass("expanded"):c.parent().parent().removeClass("expanded")}};return h}return{watchTemplateTypeWizard:function(a,b,c){b&&(a.diskSizesByTier=_.map(b.tiers,function(a){return j(a,c)}))},calculateIops:function(a,b,c){var d,e,j,k,l,m,n,o,p,q=[0,0];return _.each(a,function(a){a&&(j=a.raidLayout.split("D+"),e=_.last(j).replace("P",""),d=_.first(j),l=f(a.capacity.value,a.requestedCapacity.value),m=l*h(a.diskType,a.speed),n=e*a.capacity.value*(b/100),o=i(a.diskType),p=g(k,n,o,m),a.name===c?q[1]=p:q[0]=p)}),q},getKeyAndColors:function(a){var b=c.getDisplaySize(a.used.capacity.value),d=c.getDisplaySize(a.free.capacity.value);return[{key:Math.round(b.size)+" "+b.unit+" Physical Block Pool Capacity",color:"#3D84F5"},{key:Math.round(d.size)+" "+d.unit+" Estimated File Over Commit Capacity",color:"#1A2B45"}]},uncheckSelection:function(a){_.forEach(a.diskSizesByTier,function(a){a.selectedSize="",_.forEach(a.diskSizes,function(a){a.checked=!1})}),a.selectedCapacity="",a.selectedPlatinumCapacity=""}}}]),angular.module("rainierApp").factory("fileSystemService",["synchronousTranslateService","diskSizeService","orchestratorService",function(a,b,c){return{getFormats:function(){return[a.translate("file-systems-virtual-machine"),a.translate("file-systems-database")]},getUnits:function(){return[a.translate("common-gb"),a.translate("common-tb")]},getFormatInKiloBytes:function(b){return b===a.translate("file-systems-database")?32:4},getFormatLabel:function(b){return 32768===b?a.translate("file-systems-database"):a.translate("file-systems-virtual-machine")},getVirtualFileServerPorts:function(){return["ag1","ag2","ag3","ag4"]},getKeyAndColors:function(a,c,d){c||(c=0);var e=b.getDisplaySize(a.freeCapacity);return[{key:c+" "+d+" Selected",color:"#3D84F5"},{key:Math.round(e.size)+" "+e.unit+" Free",color:"#1A2B45"}]},autoSelectFilePool:function(a){var b=_.first(a);return _.each(a,function(a){b.freeCapacity<a.freeCapacity&&(b=a)}),b},getStoragePool:function(a,b){c.storagePool(a,b).then(function(a){return a})},getStoragePoolMapping:function(a,b){var c={};return _.each(b,function(a){_.each(a.links,function(b){if(b.href.indexOf("storage-pools/")>-1){var d=_.last(b.href.split("storage-pools/"));c[d]=_.union(c[d],[a])}})}),c},getFilePoolTierMapping:function(a,b){var c={},d=[];return _.each(b,function(b){var e=[];_.each(b.links,function(b){if(b.href.indexOf("storage-pools/")>-1){var c=_.last(b.href.split("storage-pools/")),d=this.getStoragePool(a,c);e=_.union(e,[d.tier])}}),c[b]=e,d=_.union(d,e)}),[c,d]},getVirtualFileServerLink:function(a){return _.find(a,function(a){return-1!==a.rel.indexOf("evs")})}}}]),angular.module("rainierApp").factory("replicationGroupsService",["$log","Restangular","queryService","objectTransformService","apiResponseHandlerService","paginationService",function(a,b,c,d,e,f){return{ExternalReplicationGroup:function(a){this.id=a,this.storageSystemId="N/A",this.name="External",this.comments="N/A",this.type=a,this.consistent="N/A",this.numberOfCopies="N/A",this.schedule="N/A",this.scheduleEnabled="N/A",this.primaryVolumeIds=[],this.failures="N/A",this.status="N/A",this.isExternal=!0,this.noSelection=!0,this.volumePairs=[],this.naturalLanguageSchedule="N/A"},getVolumePairsForOneReplicationGroup:function(a,c,d,f){var g={q:["type:"+d.type.toString().toUpperCase()]};return void 0!==f&&(g.q[0]=g.q[0]+" AND primaryVolume.id:"+parseInt(f)),d.hasOwnProperty("isExternal")?(g.q[0]=g.q[0]+" AND _missing_:replicationGroup",void 0!==a&&(g.nextToken=a),e._apiGetResponseHandler(b.one("storage-systems",c).one("volume-pairs").get(g).then(function(a){return a}))):(g.q[0]=g.q[0]+" AND replicationGroup:"+d.name.toString(),void 0!==a&&(g.nextToken=a),e._apiGetResponseHandler(b.one("storage-systems",c).one("volume-pairs").get(g).then(function(a){return a})))},cloneExternalVolumePairExists:function(a){return f.clearQuery(),c.setQueryMapEntry("_missing_","replicationGroup"),c.setQueryMapEntry("type","CLONE"),e._apiGetResponseHandler(b.one("storage-systems",a).one("volume-pairs").get(c.getQueryParameters(!0)).then(function(a){return a.total}))},snapshotExternalVolumePairExists:function(a){return f.clearQuery(),c.setQueryMapEntry("_missing_","replicationGroup"),c.setQueryMapEntry("type","SNAPSHOT"),e._apiGetResponseHandler(b.one("storage-systems",a).one("volume-pairs").get(c.getQueryParameters(!0)).then(function(a){return a.total}))},getReplicationGroups:function(g,h,i){void 0!==i&&f.clearQuery(),a.debug("token: ",g);var j=c.getQueryParameters(!0);return void 0!==g&&(j.nextToken=g),e._apiGetResponseHandler(b.one("storage-systems",h).one("replication-groups").get(j).then(function(a){return _.forEach(a.resources,function(a){d.transformReplicationGroup(a)}),a}))},getSortedAndFilteredReplicationGroups:function(a){var f=c.getQueryParameters(!0);return f.nextToken=null,e._apiGetResponseHandler(b.one("storage-systems",a).one("replication-groups").get(f).then(function(a){return _.forEach(a.resources,function(a){d.transformReplicationGroup(a)}),a}))},setTypeSearch:function(a){if(_.isEmpty(a)||_.isEmpty(a.type))c.removeQueryMapEntry("type");else{var b=c.getQueryObjectInstance("type",a.type);c.setQueryObject(b)}},setTextSearch:function(a){if(_.isEmpty(a.freeText))c.removeQueryMapEntry("textSearch");else{var b=c.getQueryObjectInstance("textSearch",a);b.queryStringFunction=function(){return"name:"+a.freeText},c.setQueryObject(b)}}}}]),angular.module("rainierApp").factory("storageSystemVolumeService",["$log","Restangular","queryService","objectTransformService","apiResponseHandlerService","paginationService",function(a,b,c,d,e,f){var g="volume-pairs",h="replication-groups";return{VOLUME_PAIRS_PATH:g,REPLICATION_GROUPS_PATH:h,getVolumePairsAsPVol:function(a,b,e){return f.clearQuery(),c.setQueryMapEntry("primaryVolume.id",parseInt(b)),f.get(a,g,d.transformVolumePairs,!1,e)},getVolumePairsAsSVol:function(a,b){return f.clearQuery(),c.setQueryMapEntry("secondaryVolume.id",parseInt(a)),f.getQuery(g,d.transformVolumePairs,b)},getVolumePairsAsPVolAndClone:function(a,b){return f.clearQuery(),c.setQueryMapEntry("primaryVolume.id",parseInt(a)),c.setQueryMapEntry("type","CLONE"),f.getQuery(g,d.transformVolumePairs,b)},getVolumePairsAsPVolAndSnapshotAndRGNameExisting:function(a,b){return f.clearQuery(),c.setQueryMapEntry("primaryVolume.id",parseInt(a)),c.setQueryMapEntry("type","SNAPSHOT"),c.setQueryMapEntry("_exists_","replicationGroup"),f.getQuery(g,d.transformVolumePairs,b)},getVolumePairsAsPVolAndSnapshotAndRGNameMissing:function(a,b){return f.clearQuery(),c.setQueryMapEntry("primaryVolume.id",parseInt(a)),c.setQueryMapEntry("type","SNAPSHOT"),c.setQueryMapEntry("_missing_","replicationGroup"),f.getQuery(g,d.transformVolumePairs,b)},getReplicationGroupByName:function(a,b){return f.clearQuery(),c.setQueryMapEntry("name",a.toString()),f.getQuery(h,d.transformReplicationGroup,b)},getMultipleReplicationGroupsByName:function(a,b){f.clearQuery();var e=c.getQueryObjectInstance("getMultipleRGsByName",_.first(a));return e.queryStringFunction=function(){var b=[];return _.each(a,function(a){b.push("name:"+a)}),b.join(" OR ")},c.setQueryObject(e),f.getQuery(h,d.transformReplicationGroup,b)}}}]),angular.module("rainierApp").factory("inventorySettingsService",["$timeout","diskSizeService","orchestratorService","ShareDataService","$location",function(a,b,c,d,e){var f=function(a,b){b=angular.extend({canAdd:!0},b),a.gridSettings=[{title:"ID",sizeClass:"twelfth",sortField:"volumeId",getDisplayValue:function(a){return a.volumeId},type:"id"},{title:"storage-systems-serial-number",sizeClass:"twelfth",sortField:"storageSystemId",getDisplayValue:function(a){return a.storageSystemId}},{title:"Name",sizeClass:"twelfth",sortField:"label",getDisplayValue:function(a){return a.label}},{title:"data-protection-type",sizeClass:"sixth",sortField:"dataProtectionSummary.replicationType",getDisplayValue:function(a){return a.displayedDpType},getToolTipValue:function(a){return a.toolTipDpType},type:"dpType"},{title:"data-protection-status",sizeClass:"sixth",sortField:"dataProtectionSummary.hasFailures",getDisplayValue:function(a){return a.dpMonitoringStatus}},{title:"common-label-total",sizeClass:"twelfth",sortField:"size",getDisplayValue:function(a){return a.totalCapacity},type:"size"},{title:"common-label-free",sizeClass:"twelfth",sortField:"availableCapacity",getDisplayValue:function(a){return a.availableCapacity},type:"size"},{title:"common-label-used",sizeClass:"twelfth",sortField:"usedCapacity",getDisplayValue:function(a){return a.usedCapacity},type:"size"}],b.canAdd&&(a.addAction=function(){e.path(["storage-systems",a.storageSystemId,"volumes","add"].join("/"))})},g=function(a){a.gridSettings=[{title:"hosts-id",sizeClass:"twelfth",sortField:"serverId",getDisplayValue:function(a){return a.serverId},type:"id"},{title:"hosts-label",sizeClass:"sixth",sortField:"serverName",getDisplayValue:function(a){return a.serverName}},{title:"hosts-ip-address",sizeClass:"sixth",sortField:"ipAddress",getDisplayValue:function(a){return a.ipAddress}},{title:"hosts-volume-count",sizeClass:"sixth",sortField:"attachedVolumeCount",getDisplayValue:function(a){return a.attachedVolumeCount}},{title:"hosts-data-protection-type",sizeClass:"sixth",sortField:"displayedDpType",getDisplayValue:function(a){return a.displayedDpType},getToolTipValue:function(a){return a.toolTipDpType},type:"dpType"}]};return{setVolumesGridSettings:function(a,b){f(a,b)},setHostGridSettings:function(a){g(a)}}}]),angular.module("rainierApp").factory("monitoringService",["orchestratorService","objectTransformService","ShareDataService","$routeParams","$location",function(a,b,c,d,e){function f(){var a=[{display:"Disk",pathVar:"disk"},{display:"Fan",pathVar:"fan"},{display:"Processor",pathVar:"processor"}];return a}function g(){return[{display:"Pools",key:"pools"}]}function h(a,b){if(b&&0!==b){var c="/monitoring";d.storageSystemId&&(c="/storage-systems/"+d.storageSystemId+c),e.path(c),w=a,x="hardware"===w?"disk":"pool"}}function i(){return w}function j(){return x}function k(a){x=a}function l(){return y}function m(b){var c="hardware",e="capacity";d.storageSystemId?a.statusByStorageSystem(c,d.storageSystemId).then(function(c){y.hardwareAlertTotals=c,a.statusByStorageSystem(e,d.storageSystemId).then(function(a){y.capacityAlertTotals=a,b(y)})}):a.status(c).then(function(c){y.hardwareAlertTotals=c,a.status(e).then(function(a){y.capacityAlertTotals=a,b(y)})})}function n(a){if(a&&0!==a){var b="/data-protection-monitoring";c.fromStorageSystem=!1,d.storageSystemId&&(b="/storage-systems/"+d.storageSystemId+b,c.fromStorageSystem=!0),e.path(b)}}function o(){var a="/data-protection-monitoring";d.storageSystemId&&(a="/storage-systems/"+d.storageSystemId+a),e.path(a)}function p(c){d.storageSystemId?a.dataProtectionFailuresForStorageSystem(d.storageSystemId).then(function(a){_.forEach(a.volumes,function(a){b.transformVolume(a)}),_.forEach(a.servers,function(a){b.transformHost(a)}),y.total=a.total,y.totalHostAlertCount=a.totalHostAlertCount,y.totalVolumeAlertCount=a.totalVolumeAlertCount,y.volumes=a.volumes,y.servers=a.servers,c(y)}):a.dataProtectionFailures().then(function(a){_.forEach(a.volumes,function(a){b.transformVolume(a)}),_.forEach(a.servers,function(a){b.transformHost(a)}),y.total=a.total,y.totalHostAlertCount=a.totalHostAlertCount,y.totalVolumeAlertCount=a.totalVolumeAlertCount,y.volumes=a.volumes,y.servers=a.servers,c(y)})}function q(b,c){"pool"===b?d.storageSystemId?a.capacityAlertsByStorageSystem(b,d.storageSystemId).then(function(a){var b=a.capacityAlertInformationList;c(b?b:[])}):a.capacityAlerts(b).then(function(a){var b=a.capacityAlertInformationList;c(b?b:[])}):d.storageSystemId?a.hardwareAlertsByStorageSystem(b,d.storageSystemId).then(function(a){var d="disk"===b?a.diskAlertInformationList:a.alertInformationList;c(d?d:[])}):a.hardwareAlerts(b).then(function(a){var d="disk"===b?a.diskAlertInformationList:a.alertInformationList;c(d?d:[])}),x=b}function r(a){return a.replace(/(?:^|\s)\S/g,function(a){return a.toUpperCase()})}function s(a,b){return _.map(_.uniq(a,function(a){return a[b]}),function(a){return r(a[b])})}function t(a){return s(a,"storageSerialNumber")}function u(a){return s(a,"alertLevel")}function v(){return!!d.storageSystemId}var w="capacity",x="pool",y={};return{getHardwareComponents:f,getCapacityComponents:g,launchMonitoring:h,getCurrentCategory:i,getSelectedComponent:j,setSelectedComponent:k,getSummaryStatus:m,launchDpMonitoring:n,launchDpMonitoringFromVolumeTile:o,getDpAlerts:p,getComponentAlerts:q,getUniqueStorageSerialNumbers:t,getUniqueAlertLevels:u,isStorageArrayId:v,getModel:l}}]),angular.module("rainierApp").factory("objectTransformService",["diskSizeService","synchronousTranslateService","$location","ShareDataService","cronStringConverterService",function(a,b,c,d,e){function f(b){var c=0,d=0,e=parseInt(b.totalUsableCapacity);e>0&&(d=Math.round(100*parseInt(b.usedCapacity)/e),c=Math.round(100*parseInt(b.subscribedCapacity)/e)),b.usePercentage=d,b.usage=d+"%",b.physicalUsed=a.getDisplaySize(b.usedCapacity),b.physicalFree=a.getDisplaySize(b.allocatedToPool-b.usedCapacity),b.poolCapacity=a.getDisplaySize(b.allocatedToPool),b.unallocatedToPoolsCapacity=a.getDisplaySize(b.totalUsableCapacity-b.allocatedToPool),b.subscribedCapacityPercentage=c,b.total=a.getDisplaySize(b.totalUsableCapacity)}var g="white",h="#595B5B",i="#66A2FF",j="#D0E384",k="#265CB3",l="#7BC242",m="#599628",n="#272727",o=function(a,c){return{used:{label:function(a){return b.translate(a)}("common-label-used"),capacity:a,color:l},free:{label:function(a){return b.translate(a)}("common-label-free"),capacity:c,color:m}}},p=function(a,c,d){return{used:{percentage:a||Math.round(100*parseInt(c)/parseInt(d)),
label:function(a){return b.translate(a)}("common-label-subscription")}}},q={CLONE:"Clone",SNAPSHOT:"Snapshot"},r=function(a){var b=q[a];return b?b:a},s=function(a){var b={};if(_.isArray(a)){a.sort();var c=[];_.forEach(a,function(a){c.push(r(a))}),b.displayedDpType=0===c.length?null:1===c.length?c[0]:c[0]+"...",b.toolTipDpType=c.join(",")}else b.displayedDpType=null,b.toolTipDpType=null;return b},t=function(a){return 10>a&&(a="0"+a),a},u={transformStorageSystem:function(a){f(a),a.metaData=[{left:!0,title:a.storageSystemId,details:[a.svpIpAddress]},{left:!1,title:a.model,details:[]}],a.getIcons=function(){return[]},a.topTotal=a.total,a.topSize=a.physicalUsed,a.unified?a.itemIcon="icon-cluster":a.itemIcon="icon-storage-system",a.topPostFix="common-label-total",a.bottomPostFix="common-label-used",a.onClick=function(){c.path(["storage-systems",a.storageSystemId].join("/"))},a.actions={"delete":{icon:"icon-delete",tooltip:"action-tooltip-delete",type:"confirm",confirmTitle:"storage-system-delete-confirmation",confirmMessage:"storage-system-delete-selected-content",enabled:function(){return!0},onClick:function(b){return b.deleteStorageSystem(a.storageSystemId)}},edit:{icon:"icon-edit",tooltip:"action-tooltip-edit",type:"link",onClick:function(){c.path(["storage-systems",a.storageSystemId,"update"].join("/"))},enabled:function(){return!0}},settings:{icon:"icon-settings",tooltip:"action-tooltip-settings",type:"dropdown",items:[{type:"hyperlink",title:"storage-system-launch-hdvm",href:["http://",a.svpIpAddress].join("")}],enabled:function(){return!0}}},a.getActions=function(){return _.map(a.actions)},a.alerts=0},transformReplicationGroup:function(a){"CLONE"===a.type?(a.type="Clone",a.schedule="N/A",a.status="N/A"):"SNAPSHOT"===a.type&&(a.type="Snapshot",a.scheduleEnabled===!1?a.status="Suspended":a.hasOwnProperty("isExternal")||(a.status="Active")),a.consistent===!0?a.consistent="On":a.hasOwnProperty("isExternal")||(a.consistent="Off"),a.hasOwnProperty("isExternal")&&(a.noSelection=!0),a.volumePairs=[];for(var b in a)a.hasOwnProperty(b)&&null===a[b]&&(a[b]="N/A");""===a.comments&&(a.comments="N/A"),a.naturalLanguageSchedule=e.fromObjectModelToNaturalLanguage(a.schedule)},transformVolumePairs:function(a){if(a.primaryVolume?a.launchPvol=function(){var b=["storage-systems",a.primaryVolume.storageSystemId,"volumes",a.primaryVolume.id].join("/");c.path(b)}:a.primaryVolume={id:"N/A",status:"N/A",storageSystemId:"N/A"},a.secondaryVolume?a.launchSvol=function(){var b=["storage-systems",a.secondaryVolume.storageSystemId,"volumes",a.secondaryVolume.id].join("/");c.path(b)}:a.secondaryVolume={id:"N/A",status:"N/A",storageSystemId:"N/A"},void 0!==a.splitTime&&null!==a.splitTime){a.originalSplitTime=a.splitTime;var b=new Date(a.splitTime);a.splitTime=t(b.getUTCMonth()+1)+"/"+t(b.getUTCDate())+" "+t(b.getUTCHours())+":"+t(b.getUTCMinutes())}for(var d in a)a.hasOwnProperty(d)&&"primaryVolume"!==d&&"secondaryVolume"!==d&&null===a[d]&&(a[d]="N/A")},transformVolume:function(b){var e=Math.round(100*parseInt(b.usedCapacity)/parseInt(b.size));b.usePercentage=e,b.usage=e+"%",b.totalCapacity=a.getDisplaySize(b.size),b.totalCapacity.intSize=parseInt(b.totalCapacity.size),b.usedCapacity=a.getDisplaySize(b.usedCapacity),b.availableCapacity=a.getDisplaySize(b.availableCapacity),b.alerts=0,b.open=!1,0===b.label.indexOf("HSA-reserved-")&&(b.disabledCheckBox=!0),b.poolLabel="pool"+b.poolId,b.volumeLabel="Volume"+b.volumeId;var f=s(b.dataProtectionSummary.replicationType);b.displayedDpType=f.displayedDpType,b.toolTipDpType=f.dpTypeInfo,b.dpStatus=b.dataProtectionSummary.hasFailures,b.dpMonitoringStatus=b.dataProtectionSummary.hasFailures?"Failed":"Success",b.dpStatus&&(b.alertType="alert-link",b.alertLink={icon:"icon-small-diamond",title:"Data Protection Failed.",onClick:function(){var a=["storage-systems",b.storageSystemId,"data-protection-monitoring"].join("/");c.path(a)}},b.getIcons=function(){return[this.alertLink]}),b.metaData=[{left:!0,title:b.volumeId,details:[b.label]},{left:!1,title:b.storageSystemId,details:[b.displayedDpType],detailsToolTips:[b.toolTipDpType]}];var g=[];switch(-1!==b.dataProtectionSummary.volumeType.indexOf("UNPROTECTED")?g.push("Unprotected"):(-1!==b.dataProtectionSummary.volumeType.indexOf("P-VOL")&&g.push("Protected"),-1!==b.dataProtectionSummary.volumeType.indexOf("S-VOL")&&g.push("Secondary")),_.size(g)){case 1:b.dataProtectionStatus=_.first(g);break;case 2:_.contains(g,"Protected")?b.dataProtectionStatus="Protected":_.contains(g,"Secondary")?b.dataProtectionStatus="Secondary":b.dataProtectionStatus="Unprotected";break;default:b.dataProtectionStatus="Unprotected"}switch(b.dataProtectionStatus){case"Protected":b.itemIcon="icon-primary-volume";break;case"Secondary":b.itemIcon="icon-secondary-volume";break;case"Unprotected":b.itemIcon="icon-volume";break;default:b.itemIcon="icon-volume"}b.topTotal=b.totalCapacity,b.topSize=b.usedCapacity,b.topPostFix="common-label-total",b.bottomPostFix="common-label-used",b.onClick=function(){c.path(["storage-systems",b.storageSystemId,"volumes",b.volumeId].join("/"))},b.isUnprotected=function(){return-1===this.dataProtectionSummary.volumeType.indexOf("P-VOL")},b.actions={"delete":{icon:"icon-delete",tooltip:"action-tooltip-delete",type:"confirm",confirmTitle:"storage-volume-delete-one-confirmation",confirmMessage:"storage-volume-delete-current-content",enabled:function(){return!0},onClick:function(a,c){a.deleteVolume(b.storageSystemId,b.volumeId).then(function(){c&&window.history.back()})}},edit:{icon:"icon-edit",tooltip:"action-tooltip-update",type:"link",onClick:function(){c.path(["storage-systems",b.storageSystemId,"volumes",b.volumeId,"update"].join("/"))},enabled:function(){return!0}},attach:{icon:"icon-attach-volume",tooltip:"action-tooltip-attach-volumes",type:"link",onClick:function(){d.push("selectedVolumes",[b]),c.path(["storage-systems",b.storageSystemId,"attach-volumes"].join("/"))},enabled:function(){return!0}},protect:{icon:"icon-data-protection",tooltip:"action-tooltip-protect-volumes",type:"link",onClick:function(){d.volumesList=[b]},enabled:function(){return!0}}},b.getActions=function(){return _.map(b.actions)}},transformPool:function(d){d.usage=Math.round(100*d.usedCapacityInBytes/d.capacityInBytes)+"%",d.capacityInBytes=a.getDisplaySize(d.capacityInBytes),d.availableCapacityInBytes=a.getDisplaySize(d.availableCapacityInBytes),d.usedCapacityInBytes=a.getDisplaySize(d.usedCapacityInBytes),d.alerts=0,d.tierNames=_.pluck(d.tiers,"tier").join(", "),d.isUsingExternalStorage=function(){return this.externalParityGroupIds&&this.externalParityGroupIds.length>0},0===d.label.indexOf("HSA-reserved-")&&(d.disabledCheckBox=!0),d.metaData=[{left:!0,title:d.storagePoolId,details:[d.label]},{left:!1,title:"AFE: "+d.activeFlashEnabled,details:[]},{left:!1,title:b.translate(d.type),details:[d.tierNames]}],d.getIcons=function(){return[]},d.topTotal=d.capacityInBytes,d.topSize=d.usedCapacityInBytes,"YES"===d.encrypted?d.itemIcon="icon-encrypted-pools":d.itemIcon="icon-pools",d.topPostFix="common-label-total",d.bottomPostFix="common-label-used",d.onClick=function(){c.path(["storage-systems",d.storageSystemId,"storage-pools",d.storagePoolId].join("/"))},d.actions={"delete":{icon:"icon-delete",type:"confirm",confirmTitle:"storage-pool-delete-one-confirmation",confirmMessage:"storage-pool-delete-current-content",enabled:function(){return!d.disabledCheckBox},onClick:function(a,b){a.deleteStoragePool(d.storageSystemId,d.storagePoolId).then(function(){b&&window.history.back()})}},edit:{icon:"icon-edit",type:"link",enabled:function(){return!d.disabledCheckBox},onClick:function(){c.path(["storage-systems",d.storageSystemId,"storage-pools",d.storagePoolId,"update"].join("/"))}}},d.getActions=function(){return _.map(d.actions)},d.alerts=0},transformExternalParityGroup:function(b){var c=b.capacity-b.availableCapacity,d=Math.round(100*c/b.capacity);b.usageValue=d,b.free=a.getDisplaySize(b.availableCapacity),b.total=a.getDisplaySize(b.capacity),b.used=a.getDisplaySize(c),b.usage=d+"%",b.capacity=a.getDisplaySize(b.capacity),b.selected=!1,b.noSelection=!0,null===b.externalStorageVendor&&(b.externalStorageVendor=""),null===b.externalStorageProduct&&(b.externalStorageProduct=""),b.metaData=[{left:!0,title:b.externalParityGroupId,details:[b.externalStorageVendor+" "+b.externalStorageProduct]}],b.getIcons=function(){return[]},b.actions={},b.getActions=function(){return _.map(b.actions)},b.itemIcon="icon-external-parity-group",b.topTotal=b.total,b.topSize=b.used,b.topPostFix="common-label-total",b.bottomPostFix="common-label-used"},transformPort:function(a){var b=[];a.securitySwitchEnabled&&b.push({icon:"icon-password",title:"Security Enabled"}),a.getIcons=function(){return b},a.metaData=[{left:!0,title:a.storagePortId,details:[a.speed,a.fabric,a.connectionType]},{left:!1,title:a.type,details:[]}],"VSP G1000"===a.storageSystemModel&&a.metaData[0].details.unshift(a.attributes[0]),a.itemIcon="icon-ports",a.alerts=0},transformParityGroup:function(b){var c=b.totalCapacityInBytes-b.availableCapacityInBytes,d=Math.round(100*c/b.totalCapacityInBytes);b.usageValue=d,b.free=a.getDisplaySize(b.availableCapacityInBytes),b.total=a.getDisplaySize(b.totalCapacityInBytes),b.totalVirtualCapacity=a.getDisplaySize(b.virtualizedCapacityInBytes),b.used=a.getDisplaySize(c),b.usage=d+"%",b.capacity=a.getDisplaySize(b.capacity),b.diskSpec.speed=a.getDisplaySpeed(b.diskSpec.speed),b.diskType=[b.diskSpec.type,b.diskSpec.speed].join(" "),b.raidType=[b.raidLevel,b.raidLayout].join(" "),b.actions={"delete":{icon:"icon-delete",tooltip:"action-tooltip-delete",type:"confirm",confirmTitle:"parity-group-delete-confirmation",confirmMessage:"parity-group-delete-current-content",enabled:function(){return!0},onClick:function(a,c){a.deleteParityGroup(b.storageSystemId,b.parityGroupId).then(function(){c&&window.history.back()})}},initialize:{icon:"icon-initialize-pg",tooltip:"one-parity-group-initialize-tooltip",type:"confirm",confirmTitle:"parity-group-initialize-confirmation",confirmMessage:"parity-group-initialize-current-content",enabled:function(){return!0},onClick:function(a,c){a.initializeParityGroup(b.storageSystemId,b.parityGroupId).then(function(){c&&window.history.back()})}},compress:{icon:"icon-initialize-pg",tooltip:"one-parity-group-initialize-tooltip",type:"confirm",confirmTitle:"parity-group-initialize-confirmation",confirmMessage:"parity-group-initialize-current-content",enabled:function(){return!0},onClick:function(a,c){a.compressParityGroup(b.storageSystemId,b.parityGroupId).then(function(){c&&window.history.back()})}}},b.getActions=function(){return _.map(b.actions)},b.getIcons=function(){return[]},b.metaData=[{left:!0,title:b.parityGroupId,details:[b.status]},{left:!1,title:b.diskType,details:[b.raidType]}],b.encryption===!0?b.itemIcon="icon-encrypted-parity-group":b.itemIcon="icon-parity-group",b.topTotal=b.total,b.topSize=b.used,b.topPostFix="common-label-total",b.bottomPostFix="common-label-used",b.totalVirtual=b.totalVirtualCapacity,b.alerts=0},transformTiers:function(a){a.tiers.forEach(function(a){var b=[];a.subTiers.forEach(function(a){var c=a.diskType;0!==a.speed&&(c+=" "+a.speed),b[b.length]=c}),a.subTierNames=b.join(", ")})},transformFabricSwitch:function(a){a.getIcons=function(){return[]};var c=" ";a.virtualFabricId&&a.virtualFabricId.length>0&&(c=b.translate("fabric-tile-virtual-fabric")+" "+a.virtualFabricId),a.virtualFabricIdDisplay=c,a.metaData=[{left:!0,title:a.sanFabricId,details:[c]},{left:!1,title:a.switchType,details:[]}],a.detailMetaData=[{title:"fabric-tile-switch-ip",detailData:a.principalSwitchAddress},{title:"fabric-tile-switch-username",detailData:a.principalSwitchUsername}],a.itemIcon="icon-fabric-switch",a.alerts=0},transformTierSummary:function(b,c,d){_.each(b.tiers,function(b){var e=_.find(c,function(a){return a.tierName===b.tier});if(e){var f=e.totalCapacity-e.freeCapacity,g=f/e.totalCapacity*100,h=a.getDisplaySize(e.totalCapacity),i=a.getDisplaySize(f);d.arrayDataVisualizationModel.tierBreakdown.push({name:b.tier,percent:parseInt(g),toolTip:i.size+" "+i.unit+" / "+h.size+" "+h.unit})}else d.arrayDataVisualizationModel.tierBreakdown.push({name:b.tier,percent:0,toolTip:"0 GB / 0 GB"})})},transformStorageSystemsSummary:function(a){f(a)},transformToStorageSummaryModel:function(c,d,e){var f=[];if(e&&(f=[{capacity:a.getDisplaySize(e.protectedCapacity),tooltip:function(a){return b.translate(a)}("protected-capacity-tooltip"),label:function(a){return b.translate(a)}("common-label-protected")},{capacity:a.getDisplaySize(e.unprotectedCapacity),tooltip:function(a){return b.translate(a)}("unprotected-capacity-tooltip"),label:function(a){return b.translate(a)}("common-label-unprotected")},{capacity:a.getDisplaySize(e.secondaryCapacity),tooltip:function(a){return b.translate(a)}("secondary-capacity-tooltip"),label:function(a){return b.translate(a)}("common-label-secondary")}]),d)var o=[{used:{label:function(a){return b.translate(a)}("common-label-allocated"),tooltip:function(a){return b.translate(a)}("allocated-capacity-tooltip"),capacity:c.poolCapacity,color:g},free:{label:function(a){return b.translate(a)}("common-label-unallocated"),tooltip:function(a){return b.translate(a)}("unallocated-capacity-tooltip"),capacity:c.unallocatedToPoolsCapacity,color:h},unified:{capacity:a.getDisplaySize(d.physicalCapacity),tooltip:function(a){return b.translate(a)}("file-physical-capacity-tooltip"),label:function(a){return b.translate(a)}("common-label-physical-capacity"),color:i}},{used:{label:function(a){return b.translate(a)}("common-label-used"),tooltip:function(a){return b.translate(a)}("used-capacity-tooltip"),capacity:c.physicalUsed,breakdownLabel:function(a){return b.translate(a)}("common-label-used-breakdown"),color:l,breakdown:[{capacity:a.getDisplaySize(e.protectedCapacity),tooltip:function(a){return b.translate(a)}("protected-capacity-tooltip"),label:function(a){return b.translate(a)}("common-label-protected")},{capacity:a.getDisplaySize(e.unprotectedCapacity),tooltip:function(a){return b.translate(a)}("unprotected-capacity-tooltip"),label:function(a){return b.translate(a)}("common-label-unprotected")},{capacity:a.getDisplaySize(e.secondaryCapacity),tooltip:function(a){return b.translate(a)}("secondary-capacity-tooltip"),label:function(a){return b.translate(a)}("common-label-secondary")}]},free:{label:function(a){return b.translate(a)}("common-label-free"),tooltip:function(a){return b.translate(a)}("free-capacity-tooltip"),capacity:c.physicalFree,color:m},subscribed:{percentage:c.subscribedCapacityPercentage,percentageCapacity:a.getDisplaySize(c.subscribedCapacity),tooltip:function(a){return b.translate(a)}("overcommit-capacity-tooltip"),label:function(a){return b.translate(a)}("common-label-overcommit"),color:n},unified:{label:function(a){return b.translate(a)}("common-label-file-pool-used"),tooltip:function(a){return b.translate(a)}("file-used-capacity-tooltip"),capacity:a.getDisplaySize(d.usedCapacity),color:j}}];var p=[{used:{label:function(a){return b.translate(a)}("common-label-allocated"),tooltip:function(a){return b.translate(a)}("allocated-capacity-tooltip"),capacity:c.poolCapacity,color:g},free:{label:function(a){return b.translate(a)}("common-label-unallocated"),tooltip:function(a){return b.translate(a)}("unallocated-capacity-tooltip"),capacity:c.unallocatedToPoolsCapacity,color:h}},{used:{label:function(a){return b.translate(a)}("common-label-used"),tooltip:function(a){return b.translate(a)}("used-capacity-tooltip"),capacity:c.physicalUsed,breakdownLabel:function(a){return b.translate(a)}("common-label-used-breakdown"),breakdown:f,color:l},free:{label:function(a){return b.translate(a)}("common-label-free"),tooltip:function(a){return b.translate(a)}("free-capacity-tooltip"),capacity:c.physicalFree,color:m},subscribed:{percentage:c.subscribedCapacityPercentage,percentageCapacity:a.getDisplaySize(c.subscribedCapacity),tooltip:function(a){return b.translate(a)}("subscription-capacity-tooltip"),label:function(a){return b.translate(a)}("common-label-subscription"),color:n}}];if(d)var q=[{used:{label:function(a){return b.translate(a)}("common-label-allocated"),tooltip:function(a){return b.translate(a)}("allocated-capacity-tooltip"),capacity:c.poolCapacity,color:g},free:{label:function(a){return b.translate(a)}("common-label-unallocated"),tooltip:function(a){return b.translate(a)}("unallocated-capacity-tooltip"),capacity:c.unallocatedToPoolsCapacity,color:h}},{used:{label:function(a){return b.translate(a)}("common-label-file-pool-used"),tooltip:function(a){return b.translate(a)}("file-used-capacity-tooltip"),capacity:a.getDisplaySize(d.usedCapacity),breakdown:"none",color:i},free:{label:function(a){return b.translate(a)}("common-label-physical-capacity"),tooltip:function(a){return b.translate(a)}("file-physical-capacity-tooltip"),capacity:a.getDisplaySize(d.physicalCapacity),color:k},subscribed:{percentage:c.subscribedCapacityPercentage,percentageCapacity:a.getDisplaySize(d.overcommitCapacity),tooltip:function(a){return b.translate(a)}("overcommit-capacity-tooltip"),label:function(a){return b.translate(a)}("common-label-overcommit"),color:n}}];return{arrayDataVisualizationModel:{tiersBreakdownLabel:function(a){return b.translate(a)}("common-label-tier-breakdown"),showTiersBreakDown:function(){this.tiers=!0},showProtectionBreakDown:function(){this.tiers=!1},switchToUnified:function(){this.view="unified",this.items=o},switchToBlock:function(){this.view="block",this.items=p},switchToFile:function(){this.view="file",this.tiers=!0,this.items=q},tiers:!0,view:"block",unified:c.unified,total:{label:function(a){return b.translate(a)}("common-label-total"),tooltip:function(a){return b.translate(a)}("total-usable-capacity-tooltip"),capacity:c.total},tierBreakdown:[],items:p},alerts:{capacity:{count:0,level:"healthy"},dp:{count:0,level:"healthy"},hardware:{count:0,level:"healthy"},jobs:{successCount:0,successWithErrorCount:0,failedCount:0,level:"healthy"}},summary:{storageArraysCount:c.storageSystemCount,hostsCount:0,templatesCount:0}}},transformHost:function(a){var e=s(a.dpType);a.displayedDpType=e.displayedDpType,a.toolTipDpType=e.toolTipDpType,a.getIcons=function(){return[]},a.serverLabel="Host"+a.serverId,a.attachedVolumeCount="",a.onClick=function(){c.path(["hosts",a.serverId].join("/"))},_.isEmpty(a.attachedVolumeCount)&&(a.attachedVolumeCount=0),a.status=a.attachedVolumeCount>0?"Provisioned":"Not Provisioned",a.actions={"delete":{icon:"icon-delete",type:"confirm",confirmTitle:"host-delete-confirmation",confirmMessage:"host-delete-currect-content",enabled:function(){return!0},onClick:function(b,c){b.deleteHost(a.serverId).then(function(){c&&window.history.back()})}},edit:{icon:"icon-edit",type:"link",onClick:function(){c.path(["hosts",a.serverId,"update"].join("/"))},enabled:function(){return!0}},attach:{icon:"icon-attach-volume",type:"dropdown",enabled:function(){return!0},items:[{type:"link",title:"storage-attach-volumes",onClick:function(){d.push("selectedServers",[a]),c.path("/hosts/attach-volumes")}},{type:"link",title:"host-create-attach-volumes",onClick:function(){d.push("selectedServers",[a]),c.path("hosts/create-and-attach-volumes")}}]}},a.getActions=function(){return _.map(a.actions)},"Failed"===a.dpStatus&&(a.alertType="alert-link",a.alertLink={icon:"icon-small-diamond",title:"Data Protection Failed.",onClick:function(){var a=["data-protection-monitoring"].join("/");c.path(a)}}),a.getIcons=function(){return[this.alertLink]},a.osTypeDisplayValue=b.translate("host-mode-"+a.osType),a.metaData=[{left:!0,title:a.serverId,details:[a.serverName,a.ipAddress]},{left:!1,title:a.osTypeDisplayValue,details:[a.displayedDpType],detailsToolTips:[a.toolTipDpType]}],a.itemIcon="icon-host",a.alerts=0},transformToHostSummaryModel:function(c,d,e){var f=[],g=a.getDisplaySize(c),h=a.getDisplaySize(d),i=a.getDisplaySize(e);return f.push(o(h,i)),{arrayDataVisualizationModel:{total:{label:function(a){return b.translate(a)}("common-label-total"),capacity:g},items:f},alerts:{capacity:{count:0,level:"healthy"},dp:{count:0,level:"healthy"},hardware:{count:0,level:"healthy"},jobs:{successCount:0,successWithErrorCount:0,failedCount:0,level:"healthy"}}}},transformToDpSummaryModel:function(){return{alerts:{capacity:{count:0,level:"healthy"},dp:{count:0,hostCount:0,volumeCount:0,level:"healthy"},hardware:{count:0,level:"healthy"},jobs:{successCount:0,successWithErrorCount:0,failedCount:0,level:"healthy"}}}},transformToBreakdownSummary:function(c){return{arrayDataVisualizationModel:{items:[{used:{breakdownLabel:function(a){return b.translate(a)}("common-label-used-breakdown"),breakdown:[{capacity:a.getDisplaySize(c.protectedCapacity),tooltip:function(a){return b.translate(a)}("protected-capacity-tooltip"),label:function(a){return b.translate(a)}("common-label-protected")},{capacity:a.getDisplaySize(c.unprotectedCapacity),tooltip:function(a){return b.translate(a)}("unprotected-capacity-tooltip"),label:function(a){return b.translate(a)}("common-label-unprotected")},{capacity:a.getDisplaySize(c.secondaryCapacity),tooltip:function(a){return b.translate(a)}("secondary-capacity-tooltip"),label:function(a){return b.translate(a)}("common-label-secondary")}]}},{used:{label:function(a){return b.translate(a)}("common-label-allocated"),tooltip:function(a){return b.translate(a)}("allocated-capacity-tooltip"),capacity:c.poolCapacity},free:{label:function(a){return b.translate(a)}("common-label-unallocated"),tooltip:function(a){return b.translate(a)}("unallocated-capacity-tooltip"),capacity:c.unallocatedToPoolsCapacity}},{used:{percentage:c.subscribedCapacityPercentage,percentageCapacity:a.getDisplaySize(c.subscribedCapacity),tooltip:function(a){return b.translate(a)}("subscription-capacity-tooltip"),label:function(a){return b.translate(a)}("common-label-subscription")}}]}}},transformToSummaryByTypeModel:function(c){c.totalCapacity=a.getDisplaySize(c.totalCapacity),c.usedCapacity=a.getDisplaySize(c.usedCapacity),c.availableCapacity=a.getDisplaySize(c.availableCapacity);var d=[];return d.push(o(c.usedCapacity,c.availableCapacity)),"HTI"!==c.type&&d.push({used:{percentage:0===c.totalCapacity.value?0:Math.round(100*c.usedSubscribedCapacity/c.totalCapacity.value),label:function(a){return b.translate(a)}("common-label-subscription"),color:g},free:{percentage:100,color:h}}),{total:{label:b.translate(c.poolType),capacity:c.totalCapacity},items:d}},transformToPoolSummaryModel:function(a){var c=[];return c.push(o(a.usedCapacityInBytes,a.availableCapacityInBytes)),"HTI"!==a.type&&c.push(p(a.usedSubscription,a.usedSubscribedCapacityInBytes,a.capacityInBytes.value)),{arrayDataVisualizationModel:{total:{label:function(a){return b.translate(a)}("common-label-total"),capacity:a.capacityInBytes},items:c},alerts:{capacity:{count:0,level:"healthy"},dp:{count:0,level:"healthy"},hardware:{count:0,level:"healthy"},jobs:{successCount:0,successWithErrorCount:0,failedCount:0,level:"healthy"}}}},transformToParityGroupSummaryModel:function(){return{alerts:{capacity:{count:0,level:"healthy"},dp:{count:0,level:"healthy"},hardware:{count:0,level:"healthy"},jobs:{successCount:0,successWithErrorCount:0,failedCount:0,level:"healthy"}}}},transformToVolumeSummaryModel:function(a){return{arrayDataVisualizationModel:{total:{label:function(a){return b.translate(a)}("common-label-total"),capacity:a.totalCapacity},items:[{used:{label:function(a){return b.translate(a)}("common-label-used"),capacity:a.usedCapacity,color:l},free:{label:function(a){return b.translate(a)}("common-label-free"),capacity:a.availableCapacity,color:m}}]},alerts:{capacity:{count:0,level:"healthy"},dp:{count:0,level:"healthy"},hardware:{count:0,level:"healthy"},jobs:{successCount:0,successWithErrorCount:0,failedCount:0,level:"healthy"}}}},transformFilePools:function(d,e){d.file=!0,d.displayLinks=[],d.usageBare=Math.round(100*d.usedCapacity/d.totalCapacity),d.usage=d.usageBare.toString()+"%",d.capacityInBytes=a.getDisplaySize(d.totalCapacity),d.availableCapacityInBytes=a.getDisplaySize(d.freeCapacity),d.usedCapacityInBytes=a.getDisplaySize(d.usedCapacity),d.physicalCapacityInBytes=a.getDisplaySize(d.physicalCapacity),d.chunkSize=a.getDisplaySize(d.chunkSize);var f=[];if(!d.healthy){var g=b.translate("file-pool-unhealthy-warning");f.push({icon:"icon-small-diamond",title:g})}var h=b.translate(d.tiered?"tiered":"untiered");_.each(d.links,function(a){if(-1!==a.rel.indexOf("poolId")){var c=_.last(a.href.split("/"));d.displayLinks.push({href:a.href.replace("/file","").replace("v1","#"),icon:"icon-pools",label:b.translate("hdp-pool")+" "+c})}}),d.metaData=[{left:!0,title:d.label},{left:!1,title:h}],d.getIcons=function(){return f},d.topTotal=d.totalCapacity,d.topSize=d.usedCapacity,d.itemIcon="icon-pools",d.topPostFix="file-pool-total",d.bottomPostFix="common-file-used",d.onClick=function(){c.path(["storage-systems",e,"file-pools",d.id].join("/"))},d.actions={},d.getActions=function(){return _.map(d.actions)}},transformEVS:function(a){a.displayLinks=[],a.file=!0;var d="";a.links&&_.each(a.links,function(b){-1!==b.rel.indexOf("filesystem")&&(d=_.first(b.href.split("/vfs")).replace("/file","").replace("v1","#"),a.storageSystemId=b.href.split("/")[4])}),a.listOfIps="",_.each(a.interfaceAddresses,function(b){a.listOfIps+=b.ip+"-"+b.prefixLength+"\n"}),a.listOfIps=a.listOfIps.replace(/\n$/,""),a.actions={},a.getActions=function(){return _.map(a.actions)},a.itemIcon="icon-virtual-file-server",a.displayLinks.push({href:d,icon:"icon-storage-system",label:b.translate("common-storage-system")+" "+a.storageSystemId});var e=[];if("Disabled"===a.status){var f=b.translate("file-server-offline-warning");e.push({icon:"icon-small-diamond",title:f})}a.getIcons=function(){return e},a.enabledText=a.enabled?"Enabled":"Disabled",a.isEnabled=a.enabled?"Yes":"No",a.isOnline="Online"===a.status,a.metaData=[{left:!0,title:a.name,detailsNoSlash:[a.enabledText,b.translate("big-blade")+" "+a.clusterNodeId]}],a.detailMetaData=[{detailData:a.interfaceAddresses[0].ip}],a.onClickStorageArray=function(){c.path(["storage-systems",a.storageSystemId].join("/"))},a.onClick=function(){c.path(["storage-systems",a.storageSystemId,"vfs",a.uuid].join("/"))}},transformFileSystems:function(d,e){d.file=!0,d.capacityInBytes=a.getDisplaySize(d.fileSystemCapacityDetails.capacity),d.availableCapacityInBytes=a.getDisplaySize(d.fileSystemCapacityDetails.freeCapacity),d.usedCapacityInBytes=a.getDisplaySize(d.fileSystemCapacityDetails.usedCapacity),d.blockSize=a.getDisplaySize(d.blockSize),d.expansionLimitInBytes=a.getDisplaySize(d.fileSystemCapacityDetails.expansionLimit),d.expansionLimitInBytes.size=parseInt(d.expansionLimitInBytes.size),d.onlyShowTwoBars=!0,d.usedLegend=d.usedCapacityInBytes.size+" "+d.usedCapacityInBytes.unit+" "+b.translate("file-systems-used-capacity"),d.allocatedLegend=d.capacityInBytes.size+" "+d.capacityInBytes.unit+" "+b.translate("file-systems-total-capacity"),d.storageSystemId=e,d.displayLinks=[],d.usageBare=0,0!==d.availableCapacityInBytes.size&&(d.usageBare=Math.round(100*d.usedCapacityInBytes.size/d.capacityInBytes.size)),d.usage=d.usageBare+"%";var f=[];4===d.blockSize.size?d.blockSizeDisplay="Virtual Machines (4K)":d.blockSizeDisplay="Database (32K)",d.getIcons=function(){return f},d.metaData=[{left:!0,title:d.label,detailsNoSlash:[d.status]}],d.links&&_.each(d.links,function(a){if(-1!==a.rel.indexOf("vfs")){var c=_.last(a.href.split("/"));d.displayLinks.push({href:a.href.replace("/file","").replace("v1","#"),icon:"icon-virtual-file-server",label:b.translate("vfs")+" "+c})}else-1!==a.rel.indexOf("file")&&d.displayLinks.push({href:a.href.replace("/file/","/").replace("v1","#"),icon:"icon-pools",label:b.translate("file-pool")+" "+_.last(a.href.split("/"))})}),d.topTotal=d.capacityInBytes,d.topSize=d.usedCapacityInBytes,d.itemIcon="icon-filesystem",d.topPostFix="file-pool-total",d.bottomPostFix="common-file-used",d.onClick=function(){c.path(["storage-systems",e,"file-systems",d.id].join("/"))},d.actions={},d.getActions=function(){return _.map(d.actions)}},transformFilePoolSummaryModel:function(a){a.usedLegend=a.usedCapacityInBytes.size+" "+a.usedCapacityInBytes.unit+" "+b.translate("file-pool-used-capacity"),a.allocatedLegend=a.physicalCapacityInBytes.size+" "+a.physicalCapacityInBytes.unit+" "+b.translate("file-pool-allocated-capacity"),a.overCommitLegend=a.capacityInBytes.size+" "+a.capacityInBytes.unit+" "+b.translate("file-pool-over-commit-capacity")},transformFilePoolsSummaryModel:function(c){c.capacityInBytes=a.getDisplaySize(c.filePoolSummary.overcommitCapacity),c.usedCapacityInBytes=a.getDisplaySize(c.filePoolSummary.usedCapacity),c.physicalCapacityInBytes=a.getDisplaySize(c.filePoolSummary.physicalCapacity),c.usedLegend=c.usedCapacityInBytes.size+" "+c.usedCapacityInBytes.unit+" "+b.translate("file-pool-used-capacity"),c.allocatedLegend=c.physicalCapacityInBytes.size+" "+c.physicalCapacityInBytes.unit+" "+b.translate("file-pool-allocated-capacity"),c.overCommitLegend=c.capacityInBytes.size+" "+c.capacityInBytes.unit+" "+b.translate("file-pool-over-commit-capacity")},transformFilePoolCapacitySummaryModel:function(c,d,e){d||(d=0);var f=a.createDisplaySize(d,e),g=parseInt(c.freeCapacity)-f.value;return 1>g&&(g=1),{arrayDataVisualizationModel:{file:!0,total:{label:function(a){return b.translate(a)}("common-label-total"),capacity:a.getDisplaySize(c.totalCapacity)},items:[{used:{capacity:a.getDisplaySize(parseInt(c.usedCapacity)+parseInt(f.value)),color:"#3D84F5"},free:{capacity:a.getDisplaySize(g),color:"#1A2B45"}}]}}},transformCreateTieredFilePoolCapacitySummaryModel:function(c,d){var e=[],f=0;_.each(c,function(a){a&&a.requestedCapacity&&(f+=a.requestedCapacity.value)});var g=f*(d/100);return e.push(o(a.getDisplaySize(f),a.getDisplaySize(f))),{arrayDataVisualizationModel:{file:!0,total:{label:function(a){return b.translate(a)}("common-label-total"),capacity:a.getDisplaySize(g)},items:[{used:{capacity:a.getDisplaySize(f),color:"#3D84F5"},free:{capacity:a.getDisplaySize(g-f),color:"#1A2B45"}}]}}},transformPermission:function(a){var c=[];a.getIcons=function(){return c};var d;d=a.permissionType.fullControl?b.translate("share-full-control"):a.permissionType.changeAndRead?b.translate("share-change-read"):a.permissionType.readOnly?b.translate("share-read-only"):b.translate("share-none"),a.metaData=[{left:!0,title:a.groupName,detailsNoSlash:[b.translate("share-type"),d]}],a.itemIcon="icon-share"},transformAccessConfiguration:function(a){var b=[];a.getIcons=function(){return b},a.metaData=[{left:!0,title:a.groupName,detailsNoSlash:[a.NISNetgroup,a.hostName,a.ipAddress]}],a.itemIcon="icon-share"},transformCluster:function(a){var b=["Invalid","Unknown","Up","Online","Not Up","Dead","Dormant"];_.each(a.clusterNodes,function(a){a.displayStatus=b[a.status]})},transformShare:function(a,d){var e,f=[];a.displayLinks=[],a.getIcons=function(){return f},a.type="Share",a.urlType="shares",a.metaData=[{left:!0,title:a.name,detailsNoSlash:[b.translate("share-path")+" "+a.fileSystemPath]}],a.links&&_.each(a.links,function(c){-1!==c.rel.indexOf("filesystem")?(e=_.first(c.href.split("storage-systems/")[1].split("/")),a.displayLinks.push({href:c.href.replace("/file/","/").replace("v1","#"),icon:"icon-filesystem",label:b.translate("common-storage-system-file-system")+" "+a.fileSystemId})):-1!==c.rel.indexOf("vfs")&&(a.evsUuid=_.last(c.href.split("/")),a.displayLinks.push({href:c.href.replace("/file","").replace("v1","#"),icon:"icon-virtual-file-server",label:b.translate("vfs")+" "+a.evsUuid}))}),_.each(a.permissions,function(a){var c=[];a.getIcons=function(){return c};var e;e=a.permissionType.allowFullControl?b.translate("share-full-control"):a.permissionType.allowChange?b.translate("share-change-read"):a.permissionType.allowRead?b.translate("share-read-only"):b.translate("share-none"),a.permissionDisplay=e,a.noSelection=!d,a.metaData=[{left:!0,title:a.groupName,detailsNoSlash:[b.translate("share-type"),e]}],a.itemIcon="icon-user-group"}),a.itemIcon="icon-share",
a.onClick=function(){c.path(["storage-systems",e,"file-systems",a.fileSystemId,"shares",a.id].join("/"))},a.actions={},a.getActions=function(){return _.map(a.actions)}},transformExport:function(a){var d,e=[];a.displayLinks=[],a.getIcons=function(){return e},a.type="Export",a.urlType="exports",a.metaData=[{left:!0,title:a.name,detailsNoSlash:[b.translate("export-path")+" "+a.fileSystemPath]}],a.links&&_.each(a.links,function(c){-1!==c.rel.indexOf("filesystem")?(d=_.first(c.href.split("storage-systems/")[1].split("/")),a.displayLinks.push({href:c.href.replace("/file/","/").replace("v1","#"),icon:"icon-filesystem",label:b.translate("common-storage-system-file-system")+" "+a.fileSystemId})):-1!==c.rel.indexOf("vfs")&&(a.evsUuid=_.last(c.href.split("/")),a.displayLinks.push({href:c.href.replace("/file","").replace("v1","#"),icon:"icon-virtual-file-server",label:b.translate("vfs")+" "+a.evsUuid}))}),a.itemIcon="icon-export",a.onClick=function(){c.path(["storage-systems",d,"file-systems",a.fileSystemId,"exports",a.id].join("/"))},a.actions={},a.getActions=function(){return _.map(a.actions)}}};return u}]),angular.module("rainierApp").factory("orchestratorService",["Restangular","objectTransformService","apiResponseHandlerService",function(a,b,c){var d={osType:function(){return["HP_UX","SOLARIS","AIX","WIN","LINUX","TRU64","OVMS","NETWARE","HI_UX","VMWARE","VMWARE_EX","WIN_EX"]},switchTypes:function(){return["BROCADE","CISCO"]},defaultPrincipalSwitchPortNumber:function(){return"22"},authProtocols:function(){return["NO_AUTH","MD5","SHA"]},privacyProtocols:function(){return["NO_PRIV","DES","TRIPLE_DES","AES_128"]},storageSystemDisks:function(b){return c._apiGetResponseHandler(a.one("storage-systems",b).one("disks").get())},storageSystemDisksUpdate:function(b,d,e){return c._apiGetResponseHandler(a.one("storage-systems",b).all("disks/"+d).post(e))},hostModeOptions:function(){return[0,2,6,7,12,13,14,15,22,23,33,39,40,41,49,50,51,54,60,63,67,68,71,72,73,78,80,82,83]},replicationGroups:function(d){return c._apiGetResponseHandler(a.one("storage-systems",d).one("replication-groups").get().then(function(a){var c=function(a){return{id:a,storageSystemId:"N/A",name:"External",comments:"N/A",type:a,consistent:"N/A",numberOfCopies:"N/A",schedule:"N/A",scheduleEnabled:"N/A",primaryVolumeIds:[],failures:"N/A",status:"N/A",isExternal:!0}};return a.replicationGroups.push(c("CLONE")),a.replicationGroups.push(c("SNAPSHOT")),_.forEach(a.replicationGroups,function(a){b.transformReplicationGroup(a)}),a}))},replicationGroupSummary:function(b){return c._apiGetResponseHandler(a.one("storage-systems",b).one("replication-groups/summary").get().then(function(a){return a}))},volumePairs:function(b){return c._apiGetResponseHandler(a.one("storage-systems",b).one("volume-pairs").get().then(function(a){return a}))},affectedVolumePairsByReplicationGroup:function(b,d){return c._apiGetResponseHandler(a.one("storage-systems",b).one("replication-groups",d).one("affected-volume-pairs").get())},volumePairsByPrimaryVolumeId:function(b,d){return c._apiGetResponseHandler(a.one("storage-systems",b).one("volume-pairs?primaryVolumeId="+d).get())},suspendReplicationGroup:function(b,d){return c._apiResponseHandler(a.one("storage-systems",b).all("replication-groups/"+d+"/suspend").post())},resumeReplicationGroup:function(b,d){return c._apiResponseHandler(a.one("storage-systems",b).all("replication-groups/"+d+"/resume").post())},deleteReplicationGroup:function(b,d){return c._apiResponseHandler(a.one("storage-systems",b).one("replication-groups",d).remove())},restoreReplicationGroup:function(b,d,e){return c._apiResponseHandler(a.all("storage-systems/"+b+"/volumes/"+d+"/restore").post(e))},editReplicationGroup:function(b,d,e){return c._apiResponseHandler(a.one("storage-systems",b).all("replication-groups/"+d).patch(e))},unprotectReplicationGroup:function(b,d,e){return c._apiResponseHandler(a.all("storage-systems/"+b+"/replication-groups/"+d+"/remove-volumes").post(e))},protectVolumes:function(b,d,e){return c._apiResponseHandler(a.all("storage-systems/"+b+"/replication-groups/"+d+"/add-volumes").post(e))},createReplicationGroup:function(b,d){return c._apiResponseHandler(a.all("storage-systems/"+b+"/replication-groups").post(d))},productVersionInfo:function(){return a.one("product-version").get().then(function(a){return a})},dataProtectionSummaryForStorageSystem:function(b){return c._apiGetResponseHandler(a.one("data-protection/storage-systems",b).one("summary").get())},dataProtectionSummary:function(){return a.one("data-protection/summary").get().then(function(a){return a})},hosts:function(){return c._apiGetResponseHandler(a.one("compute/servers").get().then(function(a){return _.forEach(a.servers,function(a){b.transformHost(a)}),a}))},host:function(d){return c._apiGetResponseHandler(a.one("compute/servers",d).get().then(function(a){return b.transformHost(a),a}))},hostVolumes:function(d){return c._apiGetResponseHandler(a.one("server",d).one("volumes").get().then(function(a){return _.forEach(a.dpVolResouce,function(a){b.transformVolume(a)}),a}))},dpAlertsCountForHost:function(b){return c._apiGetResponseHandler(a.one("data-protection/server",b).one("alert").get().then(function(a){return a}))},hostsSummary:function(){return c._apiGetResponseHandler(a.one("compute/servers/summary").get().then(function(a){return a}))},deleteHost:function(b){return c._apiResponseHandler(a.one("compute/servers",b).remove())},updateHost:function(b,d){return c._apiResponseHandler(a.all("compute/servers/"+b).post(d))},addHostWwn:function(b,d){return c._apiResponseHandler(a.one("compute/servers",b).all("add-wwpn").post(d))},removeHostWwn:function(b,d){return c._apiResponseHandler(a.one("compute/servers",b).all("remove-wwpn").post(d))},dataProtectionFailures:function(){return a.one("data-protection/failed-servers").get().then(function(b){var c={};c.totalHostAlertCount=_.size(b.servers),c.servers=b.servers;var d=_.size(b.servers);return a.one("data-protection/failed-volumes").get().then(function(a){var b=_.size(a.volumes),e=d+b;return c.totalVolumeAlertCount=b,c.volumes=a.volumes,c.total=e,c})})},dataProtectionFailuresForStorageSystem:function(b){return c._apiGetResponseHandler(a.one("data-protection/storage-systems",b).one("failed-volumes").get().then(function(d){var e={},f=_.size(d.volumes);return e.totalVolumeAlertCount=f,e.volumes=d.volumes,c._apiGetResponseHandler(a.one("data-protection/storage-systems",b).one("servers/failed-servers").get().then(function(a){var b=f+_.size(a.servers);return e.totalHostAlertCount=_.size(a.servers),e.servers=a.servers,e.total=b,e}))}))},storageSystemsSummary:function(){return c._apiGetResponseHandler(a.one("storage-systems/summary").get().then(function(a){return b.transformStorageSystemsSummary(a),a}))},storageSystems:function(){return c._apiGetResponseHandler(a.one("storage-systems").get().then(function(a){return _.forEach(a.storageSystems,function(a){b.transformStorageSystem(a)}),a}))},storageSystem:function(d){return c._apiGetResponseHandler(a.one("storage-systems",d).get().then(function(a){return b.transformStorageSystem(a),a}))},deleteStorageSystem:function(b){return c._apiResponseHandler(a.one("storage-systems",b).remove())},volumes:function(d){return c._apiGetResponseHandler(a.one("storage-systems",d).one("volumes").get().then(function(a){return _.forEach(a.volumes,function(a){b.transformVolume(a)}),a}))},volume:function(d,e){return c._apiGetResponseHandler(a.one("storage-systems",d).one("volumes",e).get().then(function(a){return b.transformVolume(a),a}))},volumeSummary:function(b){return c._apiGetResponseHandler(a.one("storage-systems",b).one("volumes/summary").get())},updateVolume:function(b,d,e){return c._apiResponseHandler(a.one("storage-systems",b).all("volumes/"+d).post(e))},storagePools:function(d){return c._apiGetResponseHandler(a.one("storage-systems",d).one("storage-pools").get().then(function(a){return _.forEach(a.storagePools,function(a){b.transformPool(a)}),a}))},externalParityGroupSummary:function(b){return c._apiGetResponseHandler(a.one("storage-systems",b).one("external-parity-groups/summary").get())},storageExternalParityGroups:function(d){return c._apiGetResponseHandler(a.one("storage-systems",d).one("external-parity-groups").get().then(function(a){return a.externalParityGroups&&_.forEach(a.externalParityGroups,function(a){b.transformExternalParityGroup(a)}),a}))},storagePool:function(d,e){return c._apiGetResponseHandler(a.one("storage-systems",d).one("storage-pools",e).get().then(function(a){return b.transformPool(a),a}))},storagePoolsSummary:function(b){return c._apiGetResponseHandler(a.one("storage-systems",b).one("storage-pools/summary").get())},updateStoragePool:function(b,d,e){return c._apiResponseHandler(a.one("storage-systems",b).all("storage-pools/"+d).post(e))},deleteStoragePool:function(b,d){return c._apiResponseHandler(a.one("storage-systems",b).one("storage-pools",d).remove())},createStoragePool:function(b,d){return c._apiResponseHandler(a.one("storage-systems",b).all("storage-pools").post(d))},storagePorts:function(d){return c._apiGetResponseHandler(a.one("storage-systems",d).one("storage-ports").get()).then(function(e){return c._apiGetResponseHandler(a.one("storage-systems",d).get().then(function(a){b.transformStorageSystem(a);var c=a.model;_.forEach(e.storagePorts,function(a){a.storageSystemModel=c,b.transformPort(a)})})),e})},storagePort:function(b,d){return c._apiGetResponseHandler(a.one("storage-systems",b).one("storage-ports",d).get())},updateStoragePort:function(b,d,e){return c._apiResponseHandler(a.one("storage-systems",b).all("storage-ports/"+d).post(e))},parityGroups:function(d){return c._apiGetResponseHandler(a.one("storage-systems",d).one("parity-groups").get().then(function(a){return _.forEach(a.parityGroups,function(a){b.transformParityGroup(a)}),a}))},parityGroupSummary:function(b){return c._apiGetResponseHandler(a.one("storage-systems",b).one("parity-groups/summary").get())},parityGroup:function(d,e){return c._apiGetResponseHandler(a.one("storage-systems",d).one("parity-groups",e).get().then(function(a){return b.transformParityGroup(a),a}))},initializeParityGroup:function(b,d){return c._apiResponseHandler(a.one("storage-systems",b).all("parity-groups/"+d+"/initialize").post())},compressParityGroup:function(b,d){return c._apiResponseHandler(a.one("storage-systems",b).all("parity-groups/"+d+"/compress").post())},deleteParityGroup:function(b,d){return c._apiResponseHandler(a.one("storage-systems",b).one("parity-groups",d).remove())},poolTemplate:function(b){return c._apiGetResponseHandler(a.one("storage-systems",b).one("templates").one("pool").get())},getUpdatePoolTemplate:function(b,d){return c._apiGetResponseHandler(a.one("storage-systems",b).one("templates").one("pool",d).get())},tiers:function(){return c._apiGetResponseHandler(a.one("templates").one("tiers").get())},tierSummary:function(b){return c._apiGetResponseHandler(a.one("storage-systems",b).one("tiers/summary").get())},updateTier:function(b,d){return c._apiResponseHandler(a.all("templates/tiers/"+b).post(d))},createServers:function(b){return c._apiResponseHandler(a.all("compute/servers").post(b))},parityGroupTemplate:function(b){return c._apiGetResponseHandler(a.one("storage-systems",b).one("templates").one("parity-group").get())},createParityGroup:function(b,d){return c._apiResponseHandler(a.one("storage-systems",b).all("parity-groups").post(d))},createParityGroups:function(b,d){return c._apiResponseHandler(a.one("storage-systems",b).all("templates/parity-group").post(d))},createVolumes:function(b){return c._apiResponseHandler(a.all("volume-manager/create").post(b))},attachVolume:function(b){return c._apiResponseHandler(a.all("volume-manager/attach").post(b))},detachVolume:function(b){return c._apiResponseHandler(a.all("volume-manager/detach").post(b))},createAndAttachVolumes:function(b){return c._apiResponseHandler(a.all("volume-manager/create-attach").post(b))},createAttachProtectVolumes:function(b){return c._apiResponseHandler(a.all("volume-manager/create-attach-protect").post(b))},deleteVolume:function(b,d){return c._apiResponseHandler(a.one("storage-systems",b).one("volumes",d).remove())},deployPoolTemplate:function(b,d){return c._apiResponseHandler(a.one("storage-systems",b).all("templates/pool").post(d))},updatePoolTemplate:function(b,d,e){return c._apiResponseHandler(a.one("storage-systems",b).all("templates/pool/"+d).post(e))},addStorageSystem:function(b){return c._apiResponseHandler(a.all("storage-systems").post(b))},updateStorageSystem:function(b,d){return c._apiResponseHandler(a.all("storage-systems/"+b).post(d))},jobsTimeSlice:function(b,d){return c._apiGetResponseHandler(a.one("jobs").get({fromStartDate:b.replace("Z","+0000"),toStartDate:d.replace("Z","+0000")}))},accountDomains:function(){return c._apiGetResponseHandler(a.one("security/account-domains").get())},addAccountDomain:function(b){return c._apiResponseHandler(a.all("security/account-domains").post(b))},updateAccountDomain:function(b,d){return c._apiResponseHandler(a.all("security/account-domains/"+b).post(d))},deleteAccountDomain:function(b){return c._apiGetResponseHandler(a.one("security/account-domains",b).remove())},userGroups:function(b,d){return c._apiGetResponseHandler(a.one("security/account-domains",b).one("groups?filter="+d).get())},groupMappings:function(b){return c._apiGetResponseHandler(a.one("security/account-domains",b).one("group-mappings").get())},addGroupMapping:function(b,d){return c._apiResponseHandler(a.one("security/account-domains",b).all("group-mappings").post(d))},deleteGroupMapping:function(b,d){return c._apiResponseHandler(a.one("security/account-domains",b).one("group-mappings",d).remove())},getSystemAccountsDomain:function(b){return c._apiGetResponseHandler(a.one("security/account-domains/",b).one("users").get())},updateSystemAccountDomain:function(b,d,e){return c._apiResponseHandler(a.all("security/account-domains/"+b+"/users/"+d).post(e))},addFabrics:function(b){return c._apiResponseHandler(a.all("san-fabrics").post(b))},fabrics:function(){return c._apiGetResponseHandler(a.one("san-fabrics").get()).then(function(a){return _.forEach(a.fabrics,function(a){b.transformFabricSwitch(a)}),a})},fabric:function(b){return c._apiGetResponseHandler(a.one("san-fabrics",b).get())},deleteFabric:function(b){return c._apiResponseHandler(a.one("san-fabrics",b).remove())},updateFabric:function(b,d){return c._apiResponseHandler(a.all("san-fabrics/"+b).post(d))},snmpManagers:function(){return c._apiGetResponseHandler(a.one("snmp-managers").get())},snmpManager:function(b){return c._apiGetResponseHandler(a.one("snmp-managers",b).get())},deleteSnmpManager:function(b){return c._apiResponseHandler(a.one("snmp-managers",b).remove())},updateSnmpManager:function(b,d){return c._apiResponseHandler(a.all("snmp-managers/"+b).post(d))},addSnmpManager:function(b){return c._apiResponseHandler(a.all("snmp-managers").post(b))},commonSettings:function(b){return c._apiGetResponseHandler(a.one("storage-systems",b).one("settings/common").withHttpConfig({timeout:9e5}).get())},updateCommonSettings:function(b,d){return c._apiResponseHandler(a.all("storage-systems/"+b+"/settings/common").post(d))},timeZones:function(b){return c._apiGetResponseHandler(a.one("storage-systems",b).one("settings/time-zones").withHttpConfig({timeout:9e5}).get())},dateTime:function(b){return c._apiGetResponseHandler(a.one("storage-systems",b).one("settings/date-time").withHttpConfig({timeout:9e5}).get())},updateDateTime:function(b,d){return c._apiResponseHandler(a.all("storage-systems/"+b+"/settings/date-time").post(d))},alertNotifications:function(b){return c._apiGetResponseHandler(a.one("storage-systems",b).one("settings/alert-notifications").withHttpConfig({timeout:9e5}).get())},updateAlertNotifications:function(b,d){return c._apiResponseHandler(a.all("storage-systems/"+b+"/settings/alert-notifications").post(d))},licenses:function(b){return c._apiGetResponseHandler(a.one("storage-systems",b).one("settings/licenses").withHttpConfig({timeout:9e5}).get())},updateLicenses:function(b,d){return c._apiResponseHandler(a.all("storage-systems/"+b+"/settings/licenses").post(d))},status:function(b){return c._apiGetResponseHandler(a.one("monitoring/status/"+b).get())},statusByStorageSystem:function(b,d){return c._apiGetResponseHandler(a.one("monitoring/status",d).one(b).get())},hardwareAlerts:function(b){return c._apiGetResponseHandler(a.one("monitoring/status/hardware",b).get())},capacityAlerts:function(b){return c._apiGetResponseHandler(a.one("monitoring/status/capacity",b).get())},hardwareAlertsByStorageSystem:function(b,d){return c._apiGetResponseHandler(a.one("monitoring/status",d).one("hardware",b).get())},capacityAlertsByStorageSystem:function(b,d){return c._apiGetResponseHandler(a.one("monitoring/status",d).one("capacity",b).get())},filePools:function(d){return c._apiGetResponseHandler(a.one("file/storage-systems",d).one("file-pools").get().then(function(a){return _.forEach(a.filePools,function(a){b.transformFilePools(a,d)}),a}))},filePool:function(d,e){return c._apiGetResponseHandler(a.one("file/storage-systems",d).one("file-pools",e).get().then(function(a){return b.transformFilePools(a,d),a}))},cluster:function(d){return c._apiGetResponseHandler(a.one("file/storage-systems",d).one("cluster").get().then(function(a){return b.transformCluster(a),a}))},enterpriseVirtualServers:function(d){return c._apiGetResponseHandler(a.one("file/storage-systems",d).one("vfs").get().then(function(a){return a.evses=_.reject(a.evses,function(a){return"admin"===a.type}),_.forEach(a.evses,function(a){b.transformEVS(a)}),a}))},enterpriseVirtualServer:function(d,e){return c._apiGetResponseHandler(a.one("file/storage-systems",d).one("vfs",e).get().then(function(a){return b.transformEVS(a),a}))},allEnterpriseVirtualServers:function(){return c._apiGetResponseHandler(a.one("file/vfs").get().then(function(a){return a.evses=_.reject(a.evses,function(a){return"admin"===a.type}),_.forEach(a.evses,function(a){b.transformEVS(a)}),a}))},evsFileSystems:function(d,e){return c._apiGetResponseHandler(a.one("file/storage-systems",d).one("vfs",e).one("file-systems").get().then(function(a){return _.forEach(a.fileSystems,function(a){b.transformFileSystems(a,d)}),a}))},fileSystems:function(d){return c._apiGetResponseHandler(a.one("file/storage-systems",d).one("file-systems").get().then(function(a){return _.forEach(a.fileSystems,function(a){b.transformFileSystems(a,d)}),a}))},filePoolFileSystems:function(d,e){return c._apiGetResponseHandler(a.one("file/storage-systems",d).one("file-pools",e).one("file-systems").get().then(function(a){return _.forEach(a.fileSystems,function(a){b.transformFileSystems(a,d)}),a}))},deleteFileSystem:function(b,d){return c._apiResponseHandler(a.one("file/storage-systems",b).one("file-systems",d).remove())},createFileSystem:function(b,d){return c._apiResponseHandler(a.one("file/storage-systems",b).all("file-systems").post(d))},allShares:function(d){return c._apiGetResponseHandler(a.one("file/storage-systems",d).one("shares").get().then(function(a){return _.forEach(a.shares,function(a){b.transformShare(a)}),a}))},allExports:function(d){return c._apiGetResponseHandler(a.one("file/storage-systems",d).one("exports").get().then(function(a){return _.forEach(a.exports,function(a){b.transformExport(a)}),a}))},shares:function(d,e){return c._apiGetResponseHandler(a.one("file/storage-systems",d).one("file-systems",e).one("shares").get().then(function(a){return _.forEach(a.shares,function(a){b.transformShare(a)}),a}))},share:function(d,e,f,g){return c._apiGetResponseHandler(a.one("file/storage-systems",d).one("file-systems",e).one("shares",f).get().then(function(a){return b.transformShare(a,g),a}))},addShare:function(b,d){return c._apiResponseHandler(a.one("file/storage-systems",b).all("shares").post(d))},"export":function(d,e,f){return c._apiGetResponseHandler(a.one("file/storage-systems",d).one("file-systems",e).one("exports",f).get().then(function(a){return b.transformExport(a),a}))},exports:function(d,e){return c._apiGetResponseHandler(a.one("file/storage-systems",d).one("file-systems",e).one("exports").get().then(function(a){return _.forEach(a.exports,function(a){b.transformExport(a)}),a}))},addExport:function(b,d){return c._apiResponseHandler(a.one("file/storage-systems",b).all("exports").post(d))},deleteShare:function(b,d,e){return c._apiResponseHandler(a.one("file/storage-systems",b).one("file-systems",d).one("shares",e).remove())},patchShare:function(b,d,e,f){return c._apiResponseHandler(a.one("file/storage-systems",b).one("file-systems",d).one("shares",e).patch(f))},deleteExport:function(b,d,e){return c._apiResponseHandler(a.one("file/storage-systems",b).one("file-systems",d).one("exports",e).remove())},patchExport:function(b,d,e,f){return c._apiResponseHandler(a.one("file/storage-systems",b).one("file-systems",d).one("exports",e).patch(f))},fileSystem:function(d,e){return c._apiGetResponseHandler(a.one("file/storage-systems",d).one("file-systems",e).get().then(function(a){return b.transformFileSystems(a,d),a}))},patchFileSystem:function(b,d,e){return c._apiResponseHandler(a.one("file/storage-systems",b).one("file-systems",d).patch(e))},addEvs:function(b){return c._apiResponseHandler(a.one("file/storage-systems",b.storageSystemId).all("vfs").post(b))},deleteEvs:function(b,d){return c._apiResponseHandler(a.one("file/storage-systems",b).one("vfs",d).remove())},patchEvs:function(b,d,e){return c._apiResponseHandler(a.one("file/storage-systems",b).one("vfs",d).patch(e))},filePoolTemplate:function(b){return c._apiGetResponseHandler(a.one("file/storage-systems",b).one("templates/file-pool").get())},filePoolExpandTemplate:function(b,d){return c._apiGetResponseHandler(a.one("file/storage-systems",b).one("templates/file-pool",d).one("expand").get())},createFilePool:function(b,d){return c._apiResponseHandler(a.one("file/storage-systems",b).all("templates/file-pool").post(d))},expandFilePool:function(b,d,e){return c._apiResponseHandler(a.one("file/storage-systems",b).all("templates/file-pool/"+d).post(e))},deleteFilePool:function(b,d){return c._apiResponseHandler(a.one("file/storage-systems",b).one("file-pools",d).remove())},filePoolSummary:function(b){return c._apiGetResponseHandler(a.one("file/storage-systems",b).one("file-pool-summary").get().then(function(a){return a}))},filePoolsSummary:function(){return c._apiGetResponseHandler(a.one("file/storage-systems").one("file-pool-summary").get().then(function(a){return a}))},ethernetInterfaces:function(b){return c._apiGetResponseHandler(a.one("file/storage-systems",b).one("ethernet-interfaces").get().then(function(a){return a}))}};return d}]),angular.module("rainierApp").factory("paginationService",["$q","$log","Restangular","queryService","objectTransformService","apiResponseHandlerService","diskSizeService",function(a,b,c,d,e,f,g){function h(){this.STRING="string",this.INT="int",this.ARRAY="array",this.RANGE="range"}function i(a,b,d,e){return e?f._apiGetResponseHandler(c.one("storage-systems",e).one(a).get(d).then(function(a){var c=a.resources;return b&&_.forEach(c,function(a){_.isFunction(b)&&b(a)}),a})):f._apiGetResponseHandler(c.one(a).get(d).then(function(a){var c=a.resources;return b&&_.forEach(c,function(a){_.isFunction(b)&&b(a)}),a}))}function j(a,b){return _.isNull(a)||_.isNull(b)?void 0:"["+a+" TO "+b+"]"}function k(a){if(!_.isEmpty(a)){var b=a.join(" OR ");return"("+b+")"}}function l(){d.queryMap={},d.setSort(void 0)}function m(a,c,e,f,g,h){e&&l(),b.debug("token: ",a);var j=d.getQueryParameters(!0);void 0!==a&&(j.nextToken=a),i(c,null,j,f).then(function(a){h.process(a.resources),null!==a.nextToken&&m(a.nextToken,c,!1,f,g,h)})}function n(a,b,c,d,e,f,g){a.then(function(a){b=b.concat(a.resources),null!==a.nextToken?(f.nextToken=a.nextToken,n(i(d,e,f,g),b,c,d,e,f,g)):c.resolve(b)})}function o(b,c,e,f,g,h){h||(h=a.defer()),e&&l();var j=d.getQueryParameters(!0);return void 0!==b&&(j.nextToken=b),n(i(c,g,j,f),[],h,c,g,j,f),h.promise}var p=new h;return{PAGE_SIZE:100,clearQuery:l,QueryObject:function(a,b,c,d){this.key=a,this.type=b,this.value=c,this.arrayClearKey=d},SearchType:h,get:function(a,c,e,f,g){f&&l(),b.debug("token: ",a);var h=d.getQueryParameters(!0);return void 0!==a&&(h.nextToken=a),i(c,e,h,g)},getAll:m,getAllPromises:o,getQuery:function(a,b,c){var e=d.getQueryParameters(!0);return e.nextToken=null,i(a,b,e,c)},setSliderSearch:function(a,b,c,e){e&&(b=g.createDisplaySize(b,e).value,c=g.createDisplaySize(c,e).value);var f=j(b,c),h=d.getQueryObjectInstance(a,f);d.setQueryObject(h)},setFilterSearch:function(a){if(_.isEmpty(a.value)&&a.type!==p.ARRAY)d.removeQueryMapEntry(a.key);else{var b=d.getQuery(a.key);if(b&&a.value===b.queryText)return void d.removeQueryMapEntry(a.key);if(a.type===p.ARRAY){var c=[],e=[];_.isEmpty(a.value)||c.push(a.value),b&&b.queryText&&(e=b.queryText.replace("(","").replace(")","").split(" OR "),_.each(e,function(b){_.isEmpty(a.value)&&b===a.arrayClearKey||c.push(b)})),a.value=k(c)}var f=d.getQueryObjectInstance(a.key,a.value);d.setQueryObject(f)}},setTextSearch:function(a){var b=_.first(a).value;if(_.isEmpty(b))d.removeQueryMapEntry("textSearch");else{var c=d.getQueryObjectInstance("textSearch",b);c.queryStringFunction=function(){var b=[];return _.each(a,function(a){(a.type===p.STRING||parseInt(a.value)&&a.type===p.INT)&&b.push(a.key+":"+a.value)}),b.join(" OR ")},d.setQueryObject(c)}}}}]),angular.module("rainierApp").factory("scrollDataSourceBuilderService",["$filter","$timeout",function(a,b){var c=16,d=function(a,b){a.dataModel.hasOwnProperty("currentPageCount")&&(a.dataModel.currentPageCount+=b)},e=function(b,d,e,f,g){var h=b.dataModel.view,i=b.dataModel.search,j=b.dataModel.sort;if(h&&j&&d){var k=!0;_.forEach(d,function(a){a.selected||(k=!1)}),b.dataModel.allItemsSelected=k;var l=[];i&&(l=a(e)(d,i));var m=c;"list"===h&&(m=2*m),l=i?a("orderBy")(l,j.field,j.reverse):a("orderBy")(d,j.field,j.reverse),b.dataModel.itemCounts={filtered:l.length,total:d.length},b.dataModel.filteredList=l,f||(m-=1),_.isFunction(g)&&(l=g(l)),b.dataModel.hasOwnProperty("currentPageCount")&&(m=b.dataModel.currentPageCount),b.dataModel.displayList=_.first(l,m),b.dataModel.loadMore=function(){_.chain(l).rest(b.dataModel.displayList.length).first(c).forEach(function(a){b.dataModel.displayList.push(a)}),b.dataModel.shouldSelectAll&&b.dataModel.toggleSelectAll(),b.dataModel.hasOwnProperty("currentPageCount")&&(b.dataModel.currentPageCount+=c)}}};return{expandChildren:function(a,b){d(a,b)},setupDataLoader:function(a,c,d,f,g){var h=this;return h.resultItems=c,a.$watch("dataModel.view",function(){e(a,h.resultItems,d,f,g)},!0),a.$watch("dataModel.search",function(){e(a,h.resultItems,d,f,g)},!0),a.$watch("dataModel.sort",function(){e(a,h.resultItems,d,f,g)},!0),a.$watch("dataModel.deleteActivated",function(){e(a,h.resultItems,d,f,g)},!0),a.$watch("dataModel.hiddenUpdated",function(){e(a,h.resultItems,d,f,g)},!0),h.addResultItems=function(c){h.resultItems=h.resultItems.concat(c),b(function(){e(a,h.resultItems,d,f,g)})},a.selectedCount=0,a.dataModel.getSelectedItems=function(){return _.where(this.filteredList,"selected")},a.$watch(function(){return _.size(a.dataModel.getSelectedItems())},function(b){a.selectedCount=b}),a.dataModel.allSelected=function(){var b=_.size(this.filteredList);return b>0&&a.selectedCount===b},a.dataModel.onlyOneSelected=function(){return 1===a.selectedCount},a.dataModel.anySelected=function(){return a.selectedCount>0},a.dataModel.getSelectedCount=function(){return a.selectedCount},a.$watch(function(){return a.dataModel.allSelected()},function(b){a.dataModel.shouldSelectAll=b}),a.dataModel.toggleSelectAll=function(){var a=this.shouldSelectAll||!1;_.forEach(this.filteredList,function(b){b.disabledCheckBox||(b.selected=a)})},a.dataModel.hasSelectedItems=function(){return!_.isEmpty(this.getSelectedItems())},h}}}]),angular.module("rainierApp").factory("scrollDataSourceBuilderServiceNew",["$filter","$timeout",function(a,b){var c=16,d=function(a,b){a.dataModel.hasOwnProperty("currentPageCount")&&(a.dataModel.currentPageCount+=b)},e=function(a,b,d,e){var f=a.dataModel.view;if(f&&b){var g=!0;_.forEach(b,function(a){a.selected||(g=!1)}),a.dataModel.allItemsSelected=g;var h=c;"list"===f&&(h=2*h),a.dataModel.itemCounts={filtered:a.dataModel.displayList.length,total:a.dataModel.total},a.dataModel.filteredList=a.dataModel.displayList,e||(h-=1),a.dataModel.hasOwnProperty("currentPageCount")&&(h=a.dataModel.currentPageCount),a.dataModel.loadMore=function(){a.dataModel.getResources&&_.isFunction(a.dataModel.getResources)&&null!==a.dataModel.nextToken&&void 0!==a.dataModel.nextToken&&!a.dataModel.busy&&(a.dataModel.busy=!0,a.dataModel.getResources().then(function(b){_.chain(b.resources).forEach(function(b){a.dataModel.displayList.push(b)}),a.dataModel.shouldSelectAll&&a.dataModel.toggleSelectAll(),a.dataModel.hasOwnProperty("currentPageCount")&&(a.dataModel.currentPageCount+=c),a.dataModel.nextToken=b.nextToken,a.dataModel.itemCounts.filtered=a.dataModel.displayList.length,a.dataModel.busy=!1}))}}};return{expandChildren:function(a,b){d(a,b)},setupDataLoader:function(a,c,d,f){var g=this;return g.resultItems=c,a.$watch("dataModel.view",function(){e(a,g.resultItems,d,f)},!0),a.$watch("dataModel.deleteActivated",function(){e(a,g.resultItems,d,f)},!0),a.$watch("dataModel.hiddenUpdated",function(){e(a,g.resultItems,d,f)},!0),g.addResultItems=function(c){g.resultItems=g.resultItems.concat(c),b(function(){e(a,g.resultItems,d,f)})},a.selectedCount=0,a.dataModel.getSelectedItems=function(){return _.where(this.displayList,"selected")},a.$watch(function(){return _.size(a.dataModel.getSelectedItems())},function(b){a.selectedCount=b}),a.dataModel.allSelected=function(){var b=_.size(this.displayList);return b>0&&a.selectedCount===b},a.dataModel.onlyOneSelected=function(){return 1===a.selectedCount},a.dataModel.anySelected=function(){return a.selectedCount>0},a.dataModel.getSelectedCount=function(){return a.selectedCount},a.$watch(function(){return a.dataModel.allSelected()},function(b){a.dataModel.shouldSelectAll=b}),a.dataModel.toggleSelectAll=function(){var a=this.shouldSelectAll||!1;_.forEach(this.displayList,function(b){b.disabledCheckBox||(b.selected=a)})},a.dataModel.hasSelectedItems=function(){return!_.isEmpty(this.getSelectedItems())},g}}}]),angular.module("rainierApp").factory("ShareDataService",function(){return{push:function(a,b){this[a]=b},pop:function(a){var b=this[a];return b&&delete this[a],b}}}),angular.module("rainierApp").factory("storagePoolService",["rainerColorRange","tiersColorRange",function(a,b){function c(a,b,c){if(a&&a.diskSizesByTier&&b){_.forEach(a.diskSizesByTier,function(a){a.name===b&&(a.open=!1,a.expanded=!1,a.selectedSize=c),a.disabled=!1});var d=_.chain(a.diskSizesByTier).where(function(a){var b=a.selectedSize;return!_.isNull(b)&&!_.isUndefined(b)&&b.diskSize.size>0}).value();3===d.length&&_.chain(a.diskSizesByTier).difference(d).forEach(function(a){a.disabled=!0})}}function d(a){var c,d=[];for(c=0;c<a.length;++c)d.push({key:a[c],color:b[c]});return d}function e(a,b,d,e){var f=[],g={},h=null;if(e)for(var i=0;i<b.tiers.length;++i)if(b.tiers[i].tier===a.name){h=b.tiers[i];break}_.forEach(a.templateSubTiers,function(a){_.forEach(a.availableSizesInBytes,function(b){if(h&&(b=parseInt(b)+parseInt(h.capacity)),!g[b]){var c=_.cloneDeep(a);g[b]=!0,delete c.availableSizesInBytes,c.diskSize=d.getDisplaySize(b),f.push(c)}})}),f.push({diskSize:h?d.getDisplaySize(h.capacity):d.getDisplaySize(0)});var j=_.max(f,function(a){return a.diskSize.value}).diskSize;h&&(j=d.getDisplaySize(j.value-h.capacity));var k={name:a.name,disabled:!1,expanded:!1,currentCapacity:h?h.capacity:null,selectedSize:h?_.last(f):null,diskSizes:f,maxAvailableSize:j,onOptionSelected:function(d){c(b,a.name,d)},toggleExpanded:function(a,b){var c=angular.element(b.target);a.expanded=!a.expanded,a.expanded?c.parent().parent().addClass("expanded"):c.parent().parent().removeClass("expanded")}};return k;
}return{watchTemplateTypeWizard:function(a,b,c,d){var f=b[0],g=b[1];f&&"basic"===g&&(a.diskSizesByTier=_.map(f.tiers,function(b){return e(b,a,c,d)}))},dataVizModelForBasic:function(a,b,c,e){var f=[],g=_.chain(b).where(function(a){f.push(a.name);var b=a.selectedSize;return!_.isNull(b)&&!_.isUndefined(b)&&b.diskSize.size>0}).value(),h=_.reduce(_.pluck(g,"selectedSize"),function(a,b){return a+b.diskSize.value},0),i=_.map(g,function(a){return{key:a.name,used:{capacity:e.createDisplaySize(0,"GB")},free:{capacity:a.selectedSize.diskSize}}});return a&&(a.selectedTiers=g),{keys:c||f,keyAndColors:d(c||f),total:{label:"total",capacity:e.getDisplaySize(h)},items:i}},dataVizModelForAdvanced:function(a,b,c){if(a&&b){var e={},f={},g=0,h=[],i=[],j=[];_.forEach(_.union(b,a.inUseParityGroups),function(a){var b=a.diskSpec.type;if(a.selected){var c;a.inuse?c=parseInt(a.totalCapacityInBytes):(j.push(a),i.push(a.parityGroupId),c=parseInt(a.availableCapacityInBytes)),g+=c;var d=e[b];d?d+=c:d=c,e[b]=d}f[b]||(f[b]=!0,h.push(b))});var k=[];for(var l in e)k.push({label:l,key:l,used:{capacity:c.createDisplaySize(0,"GB")},free:{capacity:c.getDisplaySize(e[l])}});return a.selectedParityGroups=i,a.selectedParityGroupObjects=j,{keys:h,keyAndColors:d(h),total:{label:"total",capacity:c.getDisplaySize(g)},items:k}}},filterParityGroups:function(a){return _.filter(a,function(a){return"IN_USE"!==a.status})}}}]),angular.module("rainierApp").factory("subnetMaskService",function(){return{getSubnetMasks:function(){return["255.255.255.254","255.255.255.252","255.255.255.248","255.255.255.240","255.255.255.224","255.255.255.192","255.255.255.128","255.255.255.0","255.255.254.0","255.255.252.0","255.255.248.0","255.255.240.0","255.255.224.0","255.255.192.0","255.255.128.0","255.255.0.0","255.254.0.0","255.252.0.0","255.248.0.0","255.240.0.0","255.224.0.0","255.192.0.0","255.128.0.0","255.0.0.0","254.0.0.0","252.0.0.0","248.0.0.0","240.0.0.0","224.0.0.0","192.0.0.0","128.0.0.0"]}}}),angular.module("rainierApp").factory("synchronousTranslateService",["$filter",function(a){var b=a("translate");return{translate:function(a){return b(a)}}}]),angular.module("rainierApp").factory("viewModelService",["$timeout","diskSizeService","objectTransformService",function(a,b,c){function d(a){var b={},c=this;c.currentPage=a[0],c.isStepCompleted=function(a){return b[a]===!0},c.isStepActive=function(a){return c.currentPage===a},c.isFirstStep=function(){return _.first(a)===c.currentPage},c.isLastStep=function(){return _.last(a)===c.currentPage},c.goNext=function(){if(b[c.currentPage]=!0,!c.isLastStep()){var d=a[_.indexOf(a,c.currentPage)+1];c.currentPage=d}},c.goBack=function(){if(!c.isFirstStep()){var b=a[_.indexOf(a,c.currentPage)-1];c.currentPage=b}}}function e(c){var d=this,e=function(a){return"HDT"===a},f=function(a){return[a.label,"(",a.capacityInBytes.size," ",a.capacityInBytes.unit,"/",a.availableCapacityInBytes.size," ",a.availableCapacityInBytes.unit,")"].join("")},g=[],h={},i={},j=[],k=[];_.forEach(c,function(a){var b=a.type;"HTI"!==b&&(a.poolLabel=f(a),j.push(a),h[b]||(h[b]=!0,g.push(b)),_.forEach(a.tiers,function(a){var b=a.tier;i[b]||(i[b]=!0,k.push(b))}))}),d.poolTypes=g,d.poolType=g[0],d.tiers=k,d.volumes=[],d.volumeGroupBuilder=function(){var a={noOfVolumes:1,label:null,labelIsValid:!0,suffix:null,disableTier:!1,tier:k[0],size:{value:1,unit:"GB"},poolType:g[0],pool:null};return a.isSizeValid=function(){var b=a.noOfVolumes&&a.noOfVolumes>0&&a.size&&a.size.value&&a.size.value>0;return b},a.valid=function(){return a.isSizeValid()&&a.labelIsValid!==!1?a.pool||a.tier:!1},a.size.getDisplayText=function(){return[a.size.value,a.size.unit].join(" ")},a.shouldDisableTier=function(){return e(a.poolType)},a.tierDisplayName=function(){return a.shouldDisableTier()?a.pool?a.pool.tierNames:"":a.tier},a.remove=function(){_.remove(d.volumes,function(b){return b===a})},a.getPools=function(){return a.pools=d.getPoolsFoView(a),a.pools},a.getTotalSize=function(){return a.isSizeValid()?b.createDisplaySize(parseInt(a.noOfVolumes)*parseInt(a.size.value),a.size.unit):b.getDisplaySize(0)},a},d.add=function(){var b=d.volumeGroupBuilder();a(function(){d.volumes.splice(0,0,b)})},d.isValid=function(){if(0===d.volumes.length)return!1;var a=_.every(d.volumes,function(a){return a.valid()});return a},d.getPoolsFoView=function(a){var b=a.shouldDisableTier();return _.where(j,function(c){return c.type===a.poolType&&(b||_.some(c.tiers,function(b){return b.tier===a.tier}))})},d.getVolumeGroups=function(){return d.isValid()?d.volumes:[]},d.mapToPayloads=function(a){return _.map(a,function(a){var c=null,d=a.poolType;return a.pool&&(c=a.pool.storagePoolId,d=null),a.shouldDisableTier()||(d=a.tier),{poolType:d,numberOfVolumes:a.noOfVolumes,label:""===a.label?null:a.label,suffix:a.suffix,capacity:b.createDisplaySize(a.size.value,a.size.unit).value.toString(),poolId:c}})},d.isReady=!0,d.add()}function f(a,b){var c=this;c.servers=_.map(b,function(b){var c=angular.copy(b);return c.portsFilter={storagePortId:""},c.wwnFilter={name:""},c.selected=!1,c.selectablePorts=_.map(a,function(a){if(_.include(a.attributes,"TARGET_PORT")){var b=angular.copy(a);return b.selected=!1,b}}),c.selectablePorts=_.filter(c.selectablePorts,function(a){return a}),c.selectableWWNs=_.map(c.wwpns,function(a){return{name:a,selected:!1}}),c.selectablePorts.sort(function(a,b){var c=a.storagePortId,d=b.storagePortId,e=parseInt(c.substring(c.indexOf("L")+1,c.indexOf("-"))),f=parseInt(d.substring(d.indexOf("L")+1,d.indexOf("-"))),g=c.substring(c.indexOf("-")+1),h=d.substring(d.indexOf("-")+1);return e===f?g>h?1:h>g?-1:0:e>f?1:f>e?-1:0}),c}),c.getPorts=function(){return _.map(c.servers,function(a){var b=[],c=[];return _.forEach(a.selectablePorts,function(a){a.selected&&c.push(a.storagePortId)}),_.forEach(a.selectableWWNs,function(a){a.selected&&b.push(a.name)}),{serverId:a.serverId,serverWwns:b,portIds:c}})}}function g(){var a=null,b=null,c=this;c.getUpdatedModel=function(c,d){if(!c||!d)return null;var e=angular.copy(c),f=parseInt(e.subscribedCapacity),g=e.total.value;if(_.forEach(d,function(a){var b=a.getTotalSize();f+=b.value}),e.subscribedCapacityPercentage=Math.round(100*parseInt(f)/g),e.subscribedCapacity=f,a){if(a===e.storageSystemId&&f===b)return null}else a=e.storageSystemId;return b=f,e}}function h(){function a(a,b){for(var c=a+"";c.length<b;)c="0"+c;return c}var b=this,c=[];_.forEach(_.range(1,13),function(b){_.forEach(_.range(0,60,5),function(d){var e=a(b,2)+":"+a(d,2);c.push(e+" AM"),c.push(e+" PM")})});var d=_.range(1,32);b.type="hour",b.hourStartMinute=0,b.hourInterval=1,b.daysOfMonth=d,b.dayOfMonth=d[0],b.times=c,b.day={};var e=new Date;e.setHours(24),e.setMinutes(0),b.time=e,b.isValid=function(){var a=!0;if("hour"===b.type&&(a=b.hourStartMinute>=0&&b.hourStartMinute<=59&&b.hourInterval>=1),"week"===b.type){var c=[];for(var d in b.day)b.day[d]&&c.push(d);a=a&&c.length>0,b.selectedDays=c}return"month"===b.type&&(a=a&&_.some(b.daysOfMonth,function(a){return b.dayOfMonth===a})),a},b.toScheduleString=function(){if(!b.isValid())return null;var a=["Every",b.type];switch(b.type){case"week":a.push("on"),a.push(b.selectedDays.join(","));break;case"month":a.push("on"),a.push(b.dayOfMonth)}return a.push("at"),a.push(i(b.time)),a.join(" ")}}function i(a){var b=a.toString().split(":");return b[0].substring(b[0].length-2).concat(":").concat(b[1])}return{newWizardViewModel:function(a){return new d(a)},newCreateVolumeModel:function(a){return new e(a)},newServerPortMapperModel:function(a,b){return new f(a,b)},buildSummaryModel:function(a){var b=c.transformToStorageSummaryModel(a);b.noMoreInfo=!0;var d=b.arrayDataVisualizationModel.items[0];return d.index=1,b.arrayDataVisualizationModel.items=[d],b},buildLunResources:function(a){return _.map(a,function(a){var b=parseInt(a.lun);return _.isFinite(b)||(b=null),{volumeId:a.volumeId,lun:b}})},newSubscriptionUpdateModel:function(){return new g},newScheduleModel:function(){return new h}}}]),angular.module("rainierApp").factory("volumeService",function(){return{validateCombinedLabel:function(a,b,c){if(null===a&&null===b)return!0;var d,e=/^[a-zA-Z0-9_][a-zA-Z0-9-_]*$/;d=null===b?"":b+c-1;var f=a+d;return null===f||""===f?!0:f.length>32?!1:e.test(f)}}});